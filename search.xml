<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Djangoä¹‹ORMè°ƒä¼˜æ–¹æ³•]]></title>
    <url>%2F2020%2F01%2F06%2FDjango%E4%B9%8BORM%E8%B0%83%E4%BC%98%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[Webç³»ç»Ÿä¼˜åŒ–ï¼Œå¯ä»¥é‡‡ç”¨è‡ªåº•å‘ä¸Šçš„é¡ºåºï¼Œä»Žæ•°æ®åº“â€”â€”&gt;æ•°æ®å­˜å‚¨æŽ¥å£â€”â€”&gt;æ•°æ®å±•ç¤ºï¼ŒæŒ‰ç…§è¿™ä¸ªé¡ºåºè¿›è¡Œæ€§èƒ½æŽ’æŸ¥ã€‚ 1ã€æ•°æ®åº“ï¼ˆå­—æ®µç´¢å¼•/æ•°æ®æ¨¡åž‹ï¼‰ 2ã€å­˜å‚¨æŽ¥å£ï¼ˆORM/æŽ¥å£ç¼“å­˜ï¼‰ 3ã€æ•°æ®å±•ç¤ºï¼ˆæ•°æ®æ¸²æŸ“/ViewæŠ¥è¡¨ï¼‰ æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•ä»ŽORMå…¥æ‰‹ï¼Œè¿›è¡ŒSQLçš„ä¼˜åŒ–ï¼Œæé«˜æŸ¥è¯¢é€Ÿåº¦ ORMè½¬Raw-SQLæŽ’æŸ¥å·¥å…· 1ã€Mysql-Logæ—¥å¿— 2ã€Djangoå†…ç½®dbæ¨¡å— connectionå¯¹è±¡ 3ã€django-exensions 4ã€django-debug-toolbar Mysql-Logæ—¥å¿— æœ¬æ–‡ä»¥Macç”µè„‘ä¸ºä¾‹ï¼Œå®žæ—¶æŸ¥çœ‹mysqlæ•°æ®åº“æ—¥å¿—ï¼Œè§‚å¯ŸORMè¯­å¥è½¬SQLæƒ…å†µ 1ã€è¿›å…¥mysqlï¼Œä¿®æ”¹è®¾ç½® 2ã€æŸ¥è¯¢mysqlæ—¥å¿—æ–‡ä»¶ä½ç½® 3ã€ç»ˆç«¯å®žæ—¶ç›‘æŽ§æ—¥å¿—æ–‡ä»¶12# æ³¨æ„ä½¿ç”¨sudoè¶…çº§ç”¨æˆ·æƒé™sudo tail -f /usr/local/mysql/data/LQ.log 4ã€æŽ¥ä¸‹æ¥ï¼Œåœ¨Djangoä¸­åšçš„ORMæ“ä½œï¼Œå°±å¯ä»¥åœ¨ç»ˆç«¯ä¸­å®žæ—¶æŸ¥çœ‹è½¬æ¢åŽçš„åŽŸç”ŸSQLè¯­å¥Djangoå†…ç½®dbæ¨¡å— connectionå¯¹è±¡ ç¡®ä¿Django é…ç½®æ–‡ä»¶ DEBUGè®¾ç½®ä¸ºTrue 1ã€è¿›å…¥Django shellçŽ¯å¢ƒ12345678&gt;&gt;&gt; from django.db import connection&gt;&gt;&gt; connection.queries[]&gt;&gt;&gt; from users.models import User&gt;&gt;&gt; User.objects.all()&lt;QuerySet [&lt;User: 15517507781&gt;, &lt;User: python&gt;]&gt;&gt;&gt;&gt; connection.queries[&#123;'sql': 'SELECT @@SQL_AUTO_IS_NULL', 'time': '0.000'&#125;, &#123;'sql': 'SELECT `tb_users`.`id`, `tb_users`.`password`, `tb_users`.`last_login`, `tb_users`.`is_superuser`, `tb_users`.`username`, `tb_users`.`first_name`, `tb_users`.`last_name`, `tb_users`.`email`, `tb_users`.`is_staff`, `tb_users`.`is_active`, `tb_users`.`date_joined`, `tb_users`.`mobile`, `tb_users`.`email_active`, `tb_users`.`default_address_id` FROM `tb_users` LIMIT 21', 'time': '0.001'&#125;] connection.queriesåªæœ‰åœ¨è°ƒè¯•ä¸ºçœŸæ—¶ã€‚å®ƒæ˜¯ä¸€ä¸ªæŒ‰æŸ¥è¯¢æ‰§è¡Œé¡ºåºæŽ’åˆ—çš„å­—å…¸åˆ—è¡¨ã€‚æ¯ä¸ªè¯å…¸éƒ½æœ‰ä»¥ä¸‹å†…å®¹: 12``sql`` -- The raw SQL statement``time`` -- How long the statement took to execute, in seconds. connection.queriesæŸ¥è¯¢åŒ…æ‹¬æ‰€æœ‰SQLè¯­å¥â€”â€”æ’å…¥ã€æ›´æ–°ã€é€‰æ‹©ç­‰ã€‚æ¯æ¬¡åº”ç”¨ç¨‹åºè®¿é—®æ•°æ®åº“æ—¶ï¼ŒæŸ¥è¯¢éƒ½ä¼šè¢«è®°å½•ä¸‹æ¥ã€‚ 2ã€ä½¿ç”¨å¤šä¸ªæ•°æ®åº“ï¼Œæ‚¨å¯ä»¥åœ¨connectionså­—å…¸çš„æ¯ä¸ªæˆå‘˜ä¸Šä½¿ç”¨ç›¸åŒçš„æŽ¥å£: 12&gt;&gt;&gt; from django.db import connections&gt;&gt;&gt; connections['my_db_alias'].queries 3ã€æ¸…é™¤æŸ¥è¯¢åˆ—è¡¨å¦‚æžœéœ€è¦åœ¨å‡½æ•°çš„ä»»æ„ä½ç½®æ‰‹åŠ¨æ¸…é™¤æŸ¥è¯¢åˆ—è¡¨ï¼Œåªéœ€è°ƒç”¨reset_queries()ï¼Œå¦‚ä¸‹æ‰€ç¤º: 12from django.db import reset_queriesreset_queries() django-exensionsæ˜¾ç¤ºåŽŸå§‹SQL Django Extensionsæ˜¯Djangoæ¡†æž¶çš„è‡ªå®šä¹‰æ‰©å±•çš„é›†åˆï¼ŒåŽé¢æˆ‘ä¼šä¸“é—¨å†™ä¸€ç¯‡æ–‡ç« æ¥æè¿°å®ƒ 1ã€è¿›å…¥shelläº¤äº’çŽ¯å¢ƒ12# pip install django-extensions $ python manage.py shell_plus --print-sql 2ã€åœ¨å‘½ä»¤è¡Œè¾“å…¥æŸ¥è¯¢è¯­å¥ï¼Œä¼šè‡ªåŠ¨æ‰“å°SQLå†…å®¹ã€‚123456&gt;&gt;&gt; User.objects.all()SELECT `tb_users`.`id`, `tb_users`.`password`, `tb_users`.`last_login`, `tb_users`.`is_superuser`, `tb_users`.`username`, `tb_users`.`first_name`, `tb_users`.`last_name`, `tb_users`.`email`, `tb_users`.`is_staff`, `tb_users`.`is_active`, `tb_users`.`date_joined`, `tb_users`.`mobile`, `tb_users`.`email_active`, `tb_users`.`default_address_id` FROM `tb_users` LIMIT 21Execution time: 0.001154s [Database: default]&lt;QuerySet [&lt;User: python32&gt;, &lt;User: python&gt;]&gt; è°ƒè¯•é…ç½®é¢æ¿django-debug-toolbar django-debug-toolbarå¯ä»¥åœ¨webç«¯æŸ¥çœ‹SQLæŸ¥è¯¢çš„è¯¦ç»†ç»Ÿè®¡ç»“æžœ]]></content>
      <categories>
        <category>Django</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Pythonä¹‹æè¿°å™¨]]></title>
    <url>%2F2019%2F12%2F24%2FPython%E4%B9%8B%E6%8F%8F%E8%BF%B0%E5%99%A8%2F</url>
    <content type="text"><![CDATA[å¾ˆå¤šä½¿ç”¨Pythonçš„å¼€å‘äººå‘˜å¯èƒ½äº†è§£è¿‡ è¿­ä»£å™¨ã€ç”Ÿæˆå™¨ã€è£…é¥°å™¨ã€‚ä»Šå¤©ä¸»è¦ç»™å¤§å®¶åˆ†äº«Pythonçš„å¦å¤–ä¸€ç§è®¾è®¡æ–¹æ³•ï¼šæè¿°å™¨ã€‚ä»€ä¹ˆæ˜¯æè¿°å™¨ï¼Ÿæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹å®˜æ–¹æ–‡æ¡£ç»™å‡ºçš„æ‘˜è¦ 12Defines descriptors, summarizes the protocol, and shows how descriptors are called. Examines a custom descriptor and several built-in Python descriptors including functions, properties, static methods, and class methods. Shows how each works by giving a pure Python equivalent and a sample application.å­¦ä¹ æè¿°å™¨ä¸ä»…èƒ½æä¾›æŽ¥è§¦åˆ°æ›´å¤šå·¥å…·é›†çš„æ–¹æ³•ï¼Œè¿˜èƒ½æ›´æ·±åœ°ç†è§£ Python å·¥ä½œçš„åŽŸç†å¹¶æ›´åŠ ä½“ä¼šåˆ°å…¶è®¾è®¡çš„ä¼˜é›…æ€§ã€‚ æè¿°å™¨å®šä¹‰å’Œç®€ä»‹ä¸€ä¸ªæè¿°å™¨æ˜¯ä¸€ä¸ªåŒ…å«â€œç»‘å®šè¡Œä¸ºâ€çš„å¯¹è±¡ï¼Œå¯¹å…¶å±žæ€§çš„å­˜å–è¢«æè¿°å™¨åè®®ä¸­å®šä¹‰çš„æ–¹æ³•è¦†ç›–ã€‚è¿™äº›æ–¹æ³•æœ‰ï¼š__get__()ã€__set__()ã€__delete__()ã€‚å¦‚æžœæŸä¸ªç±»ä¸­å®šä¹‰äº†è¿™äº›æ–¹æ³•ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°±å¯ä»¥è¢«ç§°ä¸ºä¸€ä¸ªæè¿°å™¨ã€‚ å®žä¾‹å¯¹è±¡å±žæ€§è®¿é—®çš„é»˜è®¤è¡Œä¸ºæ˜¯ä»Žä¸€ä¸ªå¯¹è±¡çš„__dict__å­—å…¸ç±»åž‹çš„å±žæ€§ä¸­èŽ·å–ã€è®¾ç½®æˆ–åˆ é™¤ã€‚ ä¸‹é¢çš„åˆ—å­ å¯¹è±¡p.nameçš„æŸ¥æ‰¾é¡ºåºä¼šä»Ž p.__dict__[name]å¼€å§‹,ç„¶åŽæ˜¯Person.__dict__[name],æŽ¥ä¸‹æ¥ä¾æ¬¡æŸ¥æ‰¾Personçš„åŸºç±»ï¼Œä¸åŒ…æ‹¬å…ƒç±»ã€‚ 123456789class Person(object): def __init__(self): self.name = 'qiangzai'p = Person()print(p.__dict__) # &#123;'name': 'qiangzai'&#125;p.age = 18 # ç»™på®žä¾‹å¯¹è±¡æ·»åŠ ageå±žæ€§print(p.__dict__) # &#123;'name': 'qiangzai', 'age': 18&#125; å¦‚æžœæ‰¾åˆ°çš„å€¼æ˜¯ä¸€ä¸ªå®šä¹‰äº†æŸä¸ªæè¿°å™¨æ–¹æ³•çš„å¯¹è±¡ï¼Œåˆ™Pythonå¯èƒ½ä¼šé‡è½½é»˜è®¤è¡Œä¸ºå¹¶è½¬è€Œå‘èµ·è°ƒç”¨æè¿°å™¨æ–¹æ³•ã€‚ è¿™å…·ä½“å‘ç”Ÿåœ¨ä¼˜å…ˆçº§é“¾çš„é‚£ä¸ªçŽ¯èŠ‚åˆ™è¦æ ¹æ®æ‰€å®šä¹‰çš„æè¿°å™¨æ–¹æ³•åŠå…¶è°ƒç”¨çš„æ–¹å¼æ¥å†³å®šã€‚ éžæ•°æ®æè¿°å™¨ å®žä¾‹å¯¹è±¡ä¸­åªå®šä¹‰äº†__get__()çš„æè¿°å™¨ç§°ä¸ºéžæ•°æ®æè¿°å™¨(å®ƒä»¬é€šå¸¸ç”¨äºŽæ–¹æ³•ï¼Œä½†ä¹Ÿå¯ä»¥ç”¨äºŽå…¶ä»–ç”¨é€”)ã€‚ æ¡ˆä¾‹1 å®šä¹‰ä¸€ä¸ªéžæ•°æ®æè¿°å™¨æˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªç±» Descriptorå’ŒPerson,å…¶ä¸­Personçš„ç±»å±žæ€§nameæ˜¯Descriptorçš„å®žä¾‹å¯¹è±¡ã€‚æ³¨æ„ä¸€å®šæ˜¯ç±»å±žæ€§ï¼Œå¦‚æžœæ˜¯å®žä¾‹å±žæ€§å°±ä¼šå¤±æ•ˆã€‚ 12345678910111213141516171819202122232425class Descriptor(object): def __get__(self, instance, owner): # self æŒ‡Açš„å®žä¾‹å¯¹è±¡ owner/instanceæŒ‡çš„æ˜¯è°ƒç”¨æ–¹çš„ç±»åŠç±»çš„å®žä¾‹ print(self, instance, owner)class Person(object): # æ³¨æ„ä¸€å®šæ˜¯ç±»å±žæ€§,è€Œä¸æ˜¯å®žä¾‹å±žæ€§ name = Descriptor()p = Person()p.name # &lt;__main__.Descriptor object at 0x10c6c1940&gt; &lt;__main__.Person object at 0x10c782668&gt; &lt;class '__main__.Person'&gt;'''p.nameçš„è°ƒç”¨é¡ºåº1. på…ˆåŽ»è‡ªå·±çš„__dict__åŽ»å¯»æ‰¾name, æ²¡æœ‰æ‰¾åˆ°2. påˆåŽ»è‡ªå·±çš„ç±» Personçš„__dict__æ‰¾name, æ‰¾åˆ°äº†3. æ‰¾åˆ°ä»¥åŽè¿”å›žnameå¯¹åº”çš„valueæ˜¯ä¸€ä¸ªæè¿°å™¨,ä¼šè°ƒç”¨æè¿°å™¨çš„__get__æ–¹æ³•'''Person.name # &lt;__main__.Descriptor object at 0x10a3cd940&gt; None &lt;class '__main__.Person'&gt;'''Person.nameçš„è°ƒç”¨é¡ºåº1. PersonåŽ»è‡ªå·±çš„å±žæ€§Person.__dict__ä¸­æ‰¾åˆ°äº†name2. å‘çŽ°æ‰¾åˆ°çš„nameå¯¹åº”çš„valueæ˜¯ä¸€ä¸ªæè¿°å™¨,ä¼šè°ƒç”¨æè¿°å™¨çš„__get__æ–¹æ³•''' æ¡ˆä¾‹2 è®¿é—®æè¿°å™¨å¯¹è±¡çš„å±žæ€§123456789101112131415class Descriptor(object): def __init__(self): self.cls_name = 'Descriptor' def __get__(self, instance, owner): # å°†å®žä¾‹å¯¹è±¡selfæœ¬èº«è¿”å›ž return selfclass Person(object): name = Descriptor()p = Person()print(p.name.cls_name) # Descriptor æ¡ˆä¾‹3 éžæ•°æ®æè¿°å™¨çš„é—®é¢˜ å½“å®žä¾‹å±žæ€§è¦†ç›–åŒåçš„ç±»å±žæ€§æŒ‡å‘çš„éžæ•°æ®æè¿°å™¨æ—¶ 12345678910111213141516171819class Descriptor(object): def __init__(self): self.cls_name = 'Descriptor' def __get__(self, instance, owner): # å°†å®žä¾‹å¯¹è±¡selfæœ¬èº«è¿”å›ž return selfclass Person(object): name = Descriptor() def __init__(self): self.name = 'qiangzai'p = Person()print(p.name) # qiangzaiprint(p.name.cls_name) # AttributeError: 'str' object has no attribute 'cls_name' ç»“è®ºï¼šå½“ç±»å±žæ€§å’Œå®žä¾‹å±žæ€§åŒåæ—¶.å®žä¾‹å¯¹è±¡è®¿é—®å±žæ€§çš„ä¼˜å…ˆçº§é“¾ å®žä¾‹å¯¹è±¡.__dict__ &gt; ç±».__dict__ æ•°æ®æè¿°å™¨ å¦‚æžœä¸€ä¸ªå¯¹è±¡å®šä¹‰äº†__set__()æˆ–__delete__()ï¼Œé‚£ä¹ˆå®ƒå°±è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªæ•°æ®æè¿°å™¨ã€‚ æ¡ˆä¾‹4 ä¿®å¤æ¡ˆä¾‹3çš„é—®é¢˜ å’ŒðŸ‘†ä¸Šé¢æ¡ˆä¾‹3åŒæ ·çš„ä»£ç ï¼ŒåªåŠ äº†ä¸€ä¸ª__set__()æ–¹æ³• 12345678910111213141516171819202122class Descriptor(object): def __init__(self): self.cls_name = 'Descriptor' def __get__(self, instance, owner): # å°†å®žä¾‹å¯¹è±¡selfæœ¬èº«è¿”å›ž return self def __set__(self, instance, value): passclass Person(object): name = Descriptor() def __init__(self): self.name = 'qiangzai'p = Person()print(p.name) # &lt;__main__.Descriptor object at 0x104f03940&gt;print(p.name.cls_name) # Descriptor ç»“è®ºï¼šå®žä¾‹å¯¹è±¡è®¿é—®å±žæ€§æ—¶ï¼Œæ•°æ®æè¿°å™¨ä¼˜å…ˆäºŽå®žä¾‹å¯¹è±¡çš„__dict__å±žæ€§ æ¡ˆä¾‹4 æ•°æ®æè¿°å™¨__set__çš„ä½œç”¨12345678910111213141516171819class Descriptor(object): def __init__(self): self.cls_name = 'Descriptor' def __get__(self, instance, owner): # å°†å®žä¾‹å¯¹è±¡selfæœ¬èº«è¿”å›ž return self def __set__(self, instance, value): print('----set---æ–¹æ³•è¢«æ‰§è¡Œ') self.age = value print(value)class Person(object): name = Descriptor()p = Person()print(p.name) # &lt;__main__.Descriptor object at 0x104f03940&gt;p.name = 18 # ä¼šè°ƒç”¨__set__æ–¹æ³•,å¹¶å°†18ä¼ é€’ç»™å‚æ•°value æ‰§è¡Œç»“æžœ 123&lt;__main__.Descriptor object at 0x105469908&gt;----set---æ–¹æ³•è¢«æ‰§è¡Œ18 ç»“è®ºï¼š__set__()æ–¹æ³•ä¸€èˆ¬ç”¨æ¥ç»™æè¿°å™¨æ·»åŠ å±žæ€§ æè¿°å™¨çš„åº”ç”¨property() å‡½æ•° property(fget=None, fset=None, fdel=None, doc=None) å‚æ•°è¯´æ˜Ž fgetæ˜¯èŽ·å–å±žæ€§å€¼çš„æ–¹æ³• fsetæ˜¯è®¾ç½®å±žæ€§å€¼çš„æ–¹æ³• fdelæ˜¯åˆ é™¤å±žæ€§å€¼çš„æ–¹æ³• docæ˜¯å±žæ€§æè¿°æè¿°ä¿¡æ¯ï¼Œå¦‚æžœçœç•¥ä¼šæŠŠfgetæ–¹æ³•çš„doscingæ‹¿æ¥ç”¨ æ¡ˆä¾‹ä»£ç 1123456789101112class Person(object): def __init__(self): self.__name = 'qiangzai' @property def get_name(self): return self.__nameperson = Person()# é€šè¿‡@propertyå°†é€šè¿‡è°ƒç”¨å‡½æ•°æ‹¿åˆ°__nameå˜æˆäº†é€šè¿‡å±žæ€§å°±å¯ä»¥ç›´æŽ¥æ‹¿åˆ°print(person.get_name) # qiangzai ä¸Šé¢ðŸ‘†æ¡ˆä¾‹æ˜¯å¤§å®¶ç»å¸¸ä¼šç”¨åˆ°çš„@propertyåœºæ™¯ æ¡ˆä¾‹ä»£ç 21234567891011121314151617181920212223class Person(object): def __init__(self): self.__name = 'qiangzai' def get_name(self): return self.__name def set_name(self, value): self.__name = value def del_name(self): del self.__name # æ•´å’Œåž‹çš„propertyç”¨æ³• name = property(fget=get_name, fset=set_name, fdel=del_name)person = Person()print(person.name) # èŽ·å–å±žæ€§ qiangzaiperson.name = 'LQ' # è®¾ç½®å±žæ€§print(person.name) # å†æ¬¡èŽ·å–å±žæ€§ LQdel person.name # åˆ é™¤å±žæ€§print(person.name) # AttributeError: 'Person' object has no attribute '_Person__name' ä¸Šé¢ðŸ‘†è¿™ç§å†™æ³•ç­‰ä»·äºŽä¸‹é¢è¿™ç§è£…é¥°å™¨çš„å†™æ³•ðŸ‘‡ 1234567891011121314151617181920212223class Person(object): def __init__(self): self.__name = 'qiangzai' @property def name(self): return self.__name @name.setter def name(self, value): self.__name = value @name.deleter def name(self): del self.__nameperson = Person()print(person.name) # èŽ·å–å±žæ€§ qiangzaiperson.name = 'LQ' # è®¾ç½®å±žæ€§print(person.name) # å†æ¬¡èŽ·å–å±žæ€§ LQdel person.name # åˆ é™¤å±žæ€§print(person.name) # AttributeError: 'Person' object has no attribute '_Person__name' æ¡ˆä¾‹ä»£ç 3 æ‰‹åŠ¨å®žçŽ°property(å‡½æ•°)12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152class myproperty(object): '''è‡ªå®šä¹‰ä¸€ä¸ªproperty''' def __init__(self, gfunc=None, sfunc=None, dfunc=None): self.gfunc = gfunc self.sfunc = sfunc self.dfunc = dfunc def __get__(self, instance, owner): return self.gfunc(instance) def setter(self, sfunc): self.sfunc = sfunc return self def __set__(self, instance, value): self.sfunc(instance, value) def deleter(self, dfunc): self.dfunc = dfunc return self def __delete__(self, instance): self.dfunc(instance)class Zoo(object): '''åŠ¨ç‰©å›­''' def __init__(self): self.animal_list = ['å¤§è±¡', 'é•¿é¢ˆé¹¿'] def get_animal(self): '''èŽ·å–æ‰€æœ‰çš„åŠ¨ç‰©''' return self.animal_list def add_animal(self, value): '''æ·»åŠ åŠ¨ç‰©''' self.animal_list.append(value) def pop_animal(self): '''åˆ é™¤æœ€åŽä¸€ä¸ªåŠ¨ç‰©''' self.animal_list.pop() animal = myproperty(gfunc=get_animal, sfunc=add_animal, dfunc=pop_animal)zoo = Zoo()print(zoo.animal) # ['å¤§è±¡', 'é•¿é¢ˆé¹¿']zoo.animal = 'çŒªçŒª'print(zoo.animal) # ['å¤§è±¡', 'é•¿é¢ˆé¹¿', 'çŒªçŒª']del zoo.animalprint(zoo.animal) # ['å¤§è±¡', 'é•¿é¢ˆé¹¿'] cached_propertyä»‹ç»ç¬¬ä¸€æ¬¡è§åˆ°è¿™ä¸ªcached_propertyæ˜¯åœ¨Djangoçš„æºç å½“ä¸­ï¼ŒåŽæ¥åŽ»çœ‹äº†æºç å‘çŽ°ä¹Ÿæ˜¯é€šè¿‡æè¿°å™¨æ¥å®žçŽ°çš„ï¼Œè€Œä¸”æ˜¯åˆ©ç”¨äº†éžæ•°æ®æè¿°ç¬¦çš„ç‰¹æ€§ï¼š __dict__ä¼˜å…ˆçº§å¤§äºŽæè¿°å™¨ã€‚ ä½œç”¨ä¸»è¦æ˜¯ç”¨æ¥åšç¼“å­˜ç”¨çš„ã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨å‡½æ•°oræ–¹æ³•æ—¶ä¼šæ‰§è¡Œä»£ç ï¼Œå¯¹ä»£ç çš„ç»“æžœè¿›è¡Œç¼“å­˜ï¼Œä¸‹æ¬¡å†ä½¿ç”¨è¯¥å‡½æ•°oræ–¹æ³•æ—¶ç›´æŽ¥ä»Ž__dict__ä¸­å°†ç»“æžœå–å‡ºè¿”å›žã€‚ æ¡ˆä¾‹ä»£ç 123456789101112131415161718192021222324252627class cached_property(object): '''ç¼“å­˜''' def __init__(self, func): self.func = func self.func_name = func.__name__ def __get__(self, instance, owner): result = instance.__dict__[self.func_name] = self.func(instance) return resultclass Person(object): @cached_property # students = cached_property(students) def students(self): ''' è®¡ç®—è¿‡ç¨‹éžå¸¸å¤æ‚,åŒä¸€ä¸ªå¯¹è±¡ä¸è®ºè°ƒç”¨å‡ æ¬¡è¿”å›žçš„ç»“æžœéƒ½æ˜¯ä¸€æ ·çš„ ''' print('è®¡ç®—äº†1ä¸‡æ¬¡') return 'è®¡ç®—å‡ºæ¥çš„çš„1ä¸‡ä¸ªå­¦ç”Ÿä¿¡æ¯'p = Person()print(p.students)print(p.students)print(p.students) ç»“æžœðŸ‘‡ 1234è®¡ç®—äº†1ä¸‡æ¬¡è®¡ç®—å‡ºæ¥çš„çš„1ä¸‡ä¸ªå­¦ç”Ÿä¿¡æ¯è®¡ç®—å‡ºæ¥çš„çš„1ä¸‡ä¸ªå­¦ç”Ÿä¿¡æ¯è®¡ç®—å‡ºæ¥çš„çš„1ä¸‡ä¸ªå­¦ç”Ÿä¿¡æ¯ ç»“è®ºï¼šä½¿ç”¨äº†cached_propertyä»¥åŽï¼Œå‡½æ•°åªæ‰§è¡Œäº†1æ¬¡ï¼Œä¼˜åŒ–äº†è®¿é—®é€Ÿåº¦ã€‚]]></content>
      <categories>
        <category>Python-Advanced</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Pythoné­”æ³•æ–¹æ³•]]></title>
    <url>%2F2019%2F12%2F12%2FPython-%E9%AD%94%E6%B3%95%E6%96%B9%E6%B3%95%E7%AF%87%2F</url>
    <content type="text"><![CDATA[é­”æ³•æ–¹æ³•æ˜¯Pythonå†…ç½®æ–¹æ³•ï¼Œä¸éœ€è¦ä¸»åŠ¨è°ƒç”¨ã€‚å‡ ä¹Žæ¯ä¸ªé­”æ³•æ–¹æ³•éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„å†…ç½®å‡½æ•°æˆ–è€…è¿ç®—ç¬¦ï¼Œå½“æˆ‘ä»¬å¯¹è¿™ä¸ªå¯¹è±¡ä½¿ç”¨è¿™äº›å‡½æ•°æˆ–è€…è¿ç®—ç¬¦æ—¶å°±ä¼šè°ƒç”¨ç±»ä¸­å¯¹åº”çš„é­”æ³•æ–¹æ³•ã€‚ æˆ‘ä»¬åœ¨è°ƒç”¨Pythonç±»ä¸­çš„æŸä¸ªæ–¹æ³•æ—¶ï¼Œé€šå¸¸ä¼šçœ‹åˆ°æŸäº›ç‰¹æ®Šçš„æ–¹æ³•ï¼Œä»–ä»¬æ€»æ˜¯è¢«åŒä¸‹åˆ’çº¿æ‰€åŒ…å›´ï¼Œæ ¼å¼ï¼š__æ–¹æ³•å__ã€‚å¦‚æžœä½ çš„å¯¹è±¡å®žçŽ°ï¼ˆé‡è½½ï¼‰äº†è¿™äº›æ–¹æ³•ä¸­çš„æŸä¸€ä¸ªï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°±ä¼šåœ¨ç‰¹æ®Šçš„æƒ…å†µä¸‹è¢« Python æ‰€è°ƒç”¨ï¼Œä½ å¯ä»¥å®šä¹‰è‡ªå·±æƒ³è¦çš„è¡Œä¸ºï¼Œè€Œè¿™ä¸€åˆ‡éƒ½æ˜¯è‡ªåŠ¨å‘ç”Ÿçš„ã€‚ æ¯”è¾ƒè¿ç®—ç¬¦&amp;é­”æ³•æ–¹æ³•å¯¹åº”å…³ç³» __eq__å¯¹åº”çš„æ¯”è¾ƒè¿ç®—ç¬¦== __ne__ å¯¹åº”çš„æ¯”è¾ƒè¿ç®—ç¬¦!= __lt__å¯¹åº”çš„æ¯”è¾ƒè¿ç®—ç¬¦&lt; __le__å¯¹åº”çš„æ¯”è¾ƒè¿ç®—ç¬¦&lt;= __gt__å¯¹åº”çš„æ¯”è¾ƒè¿ç®—ç¬¦&gt; __ge__å¯¹åº”çš„æ¯”è¾ƒè¿ç®—ç¬¦&gt;= æ¡ˆä¾‹ä¸¾ä¸ªä¾‹å­ï¼ŒPythonä¸­æœ‰ä¸ªæ¯”è¾ƒæ“ä½œç¬¦ ==ç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªå˜é‡çš„å¤§å°ï¼Œè€Œè¿™ä¸ªæ“ä½œç¬¦æ˜¯é€šè¿‡æ–¹æ³•__eq__æ¥å®žçŽ° çš„ï¼Œæ‰€ä»¥åªè¦æˆ‘ä»¬é€šè¿‡æ”¹å˜è¿™ä¸ªæ–¹æ³•çš„å†…éƒ¨ä»£ç ï¼Œå°±å¯ä»¥æ”¹å˜é‡æ–°å®šä¹‰è¿™ä¸ªæ“ä½œç¬¦çš„è¡Œä¸ºã€‚ 12345678910111213class String(str): '''å®šä¹‰ä¸€ä¸ªStringç±»ç»§æ‰¿strå¯¹è±¡''' def __eq__(self, other): '''é‡å†™__eq__æ–¹æ³•''' return len(self) == len(other)s1 = String('abc')s2 = String('123')print(s1) # 'abc'print(s2) # '123'print(s1 == s2) # True ä¸Šé¢ä»£ç Stringç±»ç»§æ‰¿strå¯¹è±¡ï¼Œå®žä¾‹åŒ–äº†2ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Œç„¶åŽå¯¹æ¯”ä¸¤ä¸ªå­—ç¬¦ä¸²å¯¹è±¡é•¿åº¦æ˜¯å¦ç›¸ç­‰ã€‚é‡å†™__eq__æ–¹æ³•ä»¥åŽï¼Œ==æ¯”è¾ƒæ“ä½œç¬¦çš„ä½œç”¨å°±ä¸å†æ˜¯æ¯”è¾ƒä¸¤è¾¹çš„å­—ç¬¦ä¸²å†…å®¹æ˜¯å¦ä¸€æ ·ï¼Œå˜æˆäº†æ¯”è¾ƒé•¿åº¦ã€‚ ç®—æœ¯è¿ç®—ç¬¦&amp;é­”æ³•æ–¹æ³•å¯¹åº”å…³ç³» __add__å¯¹åº”çš„ç®—æœ¯è¿ç®—ç¬¦+ __sub__å¯¹åº”çš„ç®—æœ¯è¿ç®—ç¬¦- __mul__å¯¹åº”çš„ç®—æœ¯è¿ç®—ç¬¦* __truediv__å¯¹åº”çš„ç®—æœ¯è¿ç®—ç¬¦/ __floordiv__å¯¹åº”çš„ç®—æœ¯è¿ç®—ç¬¦// __mod__å¯¹åº”çš„ç®—æœ¯è¿ç®—ç¬¦% æ¡ˆä¾‹1234567891011class Person(object): def __init__(self, age): self.age = age def __add__(self, other): return self.age + other.agep1 = Person(18)p2 = Person(20)print(p1 + p2) # 38 å®šä¹‰Personç±»ï¼Œå¹¶å®žä¾‹åŒ–ä¸¤ä¸ªå¯¹è±¡ï¼Œæ±‚ä¸¤ä¸ªäººçš„å¹´é¾„ä¹‹å’Œã€‚ èµ‹å€¼å¢žåŠ è¿ç®—ç¬¦å¯¹åº”å…³ç³» __iadd__å¯¹åº”çš„ç®—æœ¯è¿ç®—ç¬¦+= __isub__å¯¹åº”çš„ç®—æœ¯è¿ç®—ç¬¦-= __imul__å¯¹åº”çš„ç®—æœ¯è¿ç®—ç¬¦*= __itruediv__å¯¹åº”çš„ç®—æœ¯è¿ç®—ç¬¦/= __ifloordiv__å¯¹åº”çš„ç®—æœ¯è¿ç®—ç¬¦//= __imod__å¯¹åº”çš„ç®—æœ¯è¿ç®—ç¬¦%= ç±»åž‹è½¬æ¢æ“ä½œç¬¦ __int__å®žçŽ°åˆ°intçš„ç±»åž‹è½¬æ¢ int() __float__å®žçŽ°åˆ°floatçš„ç±»åž‹è½¬æ¢ float() __complex__å®žçŽ°åˆ°complexçš„ç±»åž‹è½¬æ¢complex() __oct__å®žçŽ°åˆ°8è¿›åˆ¶çš„ç±»åž‹è½¬æ¢ oct() __hex__å®žçŽ°åˆ°16è¿›åˆ¶çš„ç±»åž‹è½¬æ¢ hex() ä»¥ä¸Šæ˜¯å…³äºŽæ“ä½œç¬¦è¿ç®—ç¬¦çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¾ˆå°‘ä¼šæ”¹å˜è¿™äº›é­”æ³•æ–¹æ³•é™¤éžä½ çœŸçš„éœ€è¦æ”¹å˜ä»–ä»¬. å±žæ€§ç›¸å…³çš„é­”æ³•æ–¹æ³• __getattr__(self, name)å®šä¹‰å½“ç”¨æˆ·è§†å›¾èŽ·å–ä¸€ä¸ªä¸å­˜åœ¨çš„å±žæ€§æ—¶çš„è¡Œä¸º __getattribute__(self, name) å®šä¹‰å½“å¯¹è±¡çš„å±žæ€§è¢«è®¿é—®æ—¶çš„è¡Œä¸º __setattr__(self, name)å®šä¹‰å½“ä¸€ä¸ªå±žæ€§è¢«è®¾ç½®æ—¶çš„è¡Œä¸º __delattr__(self, name)å®šä¹‰å½“ä¸€ä¸ªå±žæ€§è¢«åˆ é™¤æ—¶çš„è¡Œä¸º æ‰©å±•äº†è§£ å®¹å™¨ç›¸å…³çš„é­”æ³•æ–¹æ³• __len__(self)å®šä¹‰å½“è¢«len()è°ƒç”¨æ—¶çš„è¡Œä¸ºï¼Œè¿”å›žå®¹å™¨ä¸­çš„å…ƒç´ ä¸ªæ•° __getitem__(self, key) å®šä¹‰èŽ·å–å®¹å™¨ä¸­æŒ‡å®šå…ƒç´ çš„å§“åï¼Œç›¸å½“äºŽself[key] __setitme__(self, key, value)å®šä¹‰è®¾ç½®å®¹å™¨ä¸­çš„å…ƒç´ ï¼Œå’Œå­—å…¸æ“ä½œç±»åž‹ __delitem__(slef, key)å®šä¹‰åˆ é™¤å®¹å™¨ä¸­çš„æŒ‡å®šå…ƒç´  ç›¸å½“äºŽdel self[key] __iter__(self)å®šä¹‰è¿­ä»£å®¹å™¨ä¸­çš„å…ƒç´ çš„è¡Œä¸º __contains__(self,item)å®šä¹‰å½“ä½¿ç”¨æµ‹è¯•è¿ç®—ç¬¦ inæˆ–è€…not inæ—¶çš„è¡Œä¸º ä¸Šä¸‹æ–‡ç®¡ç†å™¨ __enter__ __exit__]]></content>
      <categories>
        <category>Python-Advanced</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Pythonæ¨¡å—ä¹‹collections]]></title>
    <url>%2F2019%2F09%2F22%2FPython%E6%A8%A1%E5%9D%97%E4%B9%8Bcollections%2F</url>
    <content type="text"><![CDATA[collectionsæ¨¡å—Python3ä¸­,åœ¨å†…ç½®æ•°æ®ç±»åž‹:å­—å…¸(dict),åˆ—è¡¨(list),é›†åˆ(set),å…ƒç»„(tuple),çš„åŸºç¡€ä¸Š,collectionsæ¨¡å—è¿˜æä¾›äº†å‡ ä¸ªé¢å¤–å°è£…çš„æ•°æ®ç±»åž‹: Counter,deque,defaultdict,namedtuple,OrderDictç­‰ namedtuple ç”Ÿæˆèƒ½å¤Ÿä½¿ç”¨åå­—æ¥è®¿é—®å…ƒç´ çš„å…ƒç»„(tuple) ä»Žåå­—å¯ä»¥ç†è§£,å¸¦åå­—çš„å…ƒç»„,å³æˆ‘ä»¬å¯ä»¥é€šè¿‡nameæ¥å–å€¼ å®˜æ–¹æ–‡æ¡£è§£é‡Š: è¿”å›žä¸€ä¸ªå…·æœ‰å‘½åå­—æ®µçš„å…ƒç»„çš„æ–°å­ç±» 1234567891011121314151617In [1]: # ä»Žcollectionsæ¨¡å—ä¸­å¯¼å…¥namedtuple In [2]: from collections import namedtuple In [3]: # åˆ›å»ºæ–°çš„å…ƒç»„å­ç±» In [4]: Point = namedtuple('Point', ['name', 'age']) In [5]: p = Point('zs', 18) In [6]: # é€šè¿‡nameå–å€¼ In [7]: p.name Out[7]: 'zs'In [8]: p.age Out[8]: 18 deque åŒå‘é˜Ÿåˆ—,å¯ä»¥å¿«é€Ÿçš„ä»Žå¦å¤–ä¸€ä¾§è¿½åŠ å’ŒæŽ¨å‡ºå¯¹è±¡ ä½¿ç”¨listå­˜å‚¨æ•°æ®æ—¶,æŒ‰ç´¢å¼•è®¿é—®å…ƒç´ å¾ˆå¿«,ä½†æ˜¯æ’å…¥å’Œåˆ é™¤å…ƒç´ å°±å¾ˆæ…¢äº†,å› ä¸ºåˆ—è¡¨æ˜¯çº¿æ€§å­˜å‚¨,æ•°é‡å¤§çš„æ—¶å€™,æ’å…¥å’Œåˆ é™¤çš„æ•ˆçŽ‡å¾ˆä½Ž. dequeå°±æ˜¯ä¸ºäº†é«˜æ•ˆå®žçŽ°æ’å…¥å’Œåˆ é™¤æ“ä½œçš„åŒå‘åˆ—è¡¨,é€‚åˆç”¨äºŽé˜Ÿåˆ—å’Œæ ˆ. 123456789101112131415161718In [1]: # ä»Žcollectionsæ¨¡å—ä¸­å¯¼å…¥deque In [2]: from collections import deque In [3]: # åˆ›å»ºåŒå‘é˜Ÿåˆ— In [4]: q = deque(['a', 'b', 'c']) In [5]: # ä»Žæœ€åŽæ’å…¥ In [6]: q.append('d') In [7]: # ä»Žå¤´æ’å…¥ In [8]: q.appendleft('0') In [9]: q Out[9]: deque(['0', 'a', 'b', 'c', 'd']) Counter Counterç±»çš„ç›®çš„æ˜¯ç”¨æ¥ç»Ÿè®¡å®¹å™¨ä¸­å€¼å‡ºçŽ°çš„æ¬¡æ•°; å®ƒæ˜¯ä¸€ä¸ªæ— åºçš„å®¹å™¨ç±»åž‹,ä»¥å­—å…¸çš„é”®å€¼å¯¹å½¢å¼å­˜å‚¨; å…¶ä¸­å…ƒç´ ä½œä¸ºkey,å…¶è®¡æ•°ä½œä¸ºvalue; 123456In [1]: from collections import Counter In [2]: data = Counter('fsadjkfskdjlakjfdkl') In [3]: data Out[3]: Counter(&#123;'f': 3, 's': 2, 'a': 2, 'd': 3, 'j': 3, 'k': 4, 'l': 2&#125;) OrderedDict æœ‰åºå­—å…¸,é¡¾åæ€ä¹‰,PythonåŽŸæœ¬çš„å­—å…¸æ˜¯æ— åºçš„,åœ¨å¯¹å­—å…¸è¿›è¡Œè¿­ä»£æ—¶,keyçš„é¡ºåºæ˜¯æ— æ³•æŽ§åˆ¶çš„,è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥åˆ©ç”¨OrderedDictæ¥å®žçŽ°æˆ‘ä»¬çš„ç›®æ ‡ 12345678910# ä»Žcollectionsæ¨¡å—ä¸­ç›—å›¾OrderedDict&gt;&gt;&gt; from collections import OrderedDict# åˆ›å»ºä¸€ä¸ªæ— åºå­—å…¸&gt;&gt;&gt; d = dict([('a',1),('b',2),('c',3)])&gt;&gt;&gt; d # dictçš„keyæ˜¯æ— åºçš„&#123;'a':1,'c':3,'b':2&#125;# åˆ›å»ºä¸€ä¸ªæœ‰åºå­—å…¸&gt;&gt;&gt; od = OrderedDict([('a',1),('b',2),('c',3)])&gt;&gt;&gt; od # OrderedDictçš„keyæ˜¯æœ‰åºçš„OrderedDict([('a',1),('b',2),('c',3)]) OrderedDictçš„keyä¼šæŒ‰ç…§æ’å…¥çš„é¡ºåºæŽ’åº,ä¸æ˜¯keyæœ¬èº«æŽ’åº 1234567891011121314151617181920In [1]: from collections import OrderedDict In [2]: od = OrderedDict() In [3]: od Out[3]: OrderedDict()In [4]: # æ’å…¥é”®å€¼å¯¹ In [5]: od['z'] = 1 In [6]: od['y'] = 2 In [7]: od['x'] = 3 In [8]: od.keys() # æŒ‰ç…§æ’å…¥çš„keyçš„é¡ºåºè¿”å›ž Out[8]: odict_keys(['z', 'y', 'x'])In [9]: od Out[9]: OrderedDict([('z', 1), ('y', 2), ('x', 3)]) defaultdict å¸¦æœ‰é»˜è®¤å€¼çš„å­—å…¸ å½“æˆ‘ä»¬ä½¿ç”¨å­—å…¸,é€šè¿‡keyæ¥èŽ·å–æ•°æ®æ—¶,å¦‚æžœkeyä¸å­˜åœ¨,ä¼šæŠ›å‡ºKeyErrorå¼‚å¸¸,å¦‚æžœå¸Œæœ›Keyä¸å­˜åœ¨æ—¶,è¿”å›žä¸€ä¸ªé»˜è®¤è¿½,å°±å¯ä»¥ä½¿ç”¨defaultdict 123456789101112131415161718192021222324In [1]: # ä»Žcollections æ¨¡å—å¯¼å…¥defaultdict In [2]: from collections import defaultdict In [3]: # åˆ›å»ºå¸¦é»˜è®¤å€¼çš„å­—å…¸ In [4]: dd = defaultdict(lambda: None) # ä¸å­˜åœ¨è¿”å›žNone In [5]: # ä¸ºåˆ›å»ºçš„å­—å…¸æ·»åŠ é”®å€¼å¯¹ In [6]: dd['name'] = 'qiangzai' In [7]: # keyä¸å­˜åœ¨è‡ªåŠ¨æ·»åŠ è¿”å›žé»˜è®¤å€¼ In [8]: dd['name'] Out[8]: 'qiangzai'In [9]: dd['age'] In [10]: dd Out[10]: defaultdict(&lt;function __main__.&lt;lambda&gt;()&gt;, &#123;'name': 'qiangzai', 'age': None&#125;)In [11]: dict(dd) Out[11]: &#123;'name': 'qiangzai', 'age': None&#125;]]></content>
      <categories>
        <category>Python-Modules</category>
      </categories>
      <tags>
        <tag>collections</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æœåŠ¡å™¨éƒ¨ç½²Jupyter Notebook]]></title>
    <url>%2F2019%2F09%2F12%2FNotebook%2F</url>
    <content type="text"><![CDATA[çŽ°åœ¨ITé«˜é€Ÿå‘å±•,éšç€ç¡¬ä»¶èµ„æºçš„æå‡,å¾ˆå¤šç¼–ç¨‹çŽ¯å¢ƒéƒ½ç§»äº¤åˆ°çº¿ä¸Š,åƒé˜¿é‡Œçš„å¤©æ± .è…¾è®¯å‡ºçš„å¼€å‘è€…å¹³å°éƒ½æŽ¨å‡ºäº†å„ç§è¯­è¨€çš„åœ¨çº¿ç¼–ç¨‹çŽ¯å¢ƒ.è§£å†³äº†ä¼ ç»Ÿå¼€å‘åˆ°å¤„æ­å»ºçŽ¯å¢ƒçš„å¼Šç«¯,å®žçŽ°è”ç½‘å¼çš„å³æ—¶ç¼–ç¨‹. Jupyter Notebookï¼ˆæ­¤å‰è¢«ç§°ä¸º IPython notebookï¼‰æ˜¯ä¸€ä¸ªäº¤äº’å¼ç¬”è®°æœ¬ï¼Œæ”¯æŒè¿è¡Œ 40 å¤šç§ç¼–ç¨‹è¯­è¨€ã€‚å®ƒçš„æ ¸å¿ƒåœ¨äºŽå±•ç¤ºä¸Žå¿«é€Ÿè¿­ä»£ã€‚ æœ¬æ–‡:ä¸»è¦è®°å½•ä¸€ä¸‹åœ¨è…¾è®¯äº‘UbuntuæœåŠ¡å™¨ä¸Šå¦‚ä½•æ­å»ºJupy Notebookå®žçŽ°åœ¨çº¿ç¼–ç¨‹ å®‰è£…è¿™é‡Œé€šè¿‡çš„æ˜¯ pip æ¥è¿›è¡Œå®‰è£…,å½“ç„¶å¦‚æžœæœåŠ¡å™¨ä¸Šå®‰è£…æœ‰ Anacondaä¹Ÿæ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ 1pip3 install jupyter éƒ¨ç½²å®‰è£…å®Œæˆä¹‹åŽ,ç®€å•å‡ æ­¥å³å¯å®ŒæˆJupyter Notebookçš„éƒ¨ç½² 1.åˆ›å»ºä¸€ä¸ªç›®å½•æ–‡ä»¶å¤¹,æˆ‘è¿™é‡Œåˆ›å»ºçš„è·¯åŠ²: /home/ubuntu/project,åˆ›å»ºçš„ç›®çš„æ˜¯ä¿å­˜æˆ‘ä»¬ä½¿ç”¨jupyter notebookåˆ›å»ºçš„æ–‡ä»¶.PS:ä½¿ç”¨è¿‡Jupyter notebookçš„äººåº”è¯¥éƒ½æ¸…æ¥š. 2.ç”Ÿæˆ Jupyter Notebookçš„é…æ–‡ä»¶ 1jupyter-notebook --generate-config ç”Ÿæˆçš„è·¯å¾„ /home/ubuntu/.jupyter/jupyter_notebook_config.py 3.ç”Ÿæˆå¯†ç , å¯†ç ä¸»è¦æ˜¯åœ¨ä½ è®¿é—®Jupyterçš„æ—¶å€™ä¼šç”¨åˆ° 123'''ç»ˆç«¯è¾“å…¥ipython,å›žè½¦ä»¥åŽè¾“å…¥ä¸‹é¢ä»£ç ï¼š'''from notebook.auth import passwdpasswd() ä¹‹åŽä¸¤æ¬¡è¾“å…¥å¯†ç åˆ™ä¼šè‡ªåŠ¨ç”Ÿæˆä»¥sha1:å¼€å¤´çš„å¯†ç hashå€¼ï¼Œå¤åˆ¶å‡ºæ¥åŽé¢å¡«å†™ï¼› 4.ä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚vim /home/ubuntu/.jupyter/jupyter_notebook_config.pyï¼Œæ‰“å¼€åŽåœ¨æ–‡ä»¶å¤´æ’å…¥ï¼š 123456c.NotebookApp.ip='*'c.NotebookApp.password = u'sha1:......' # å¡«å†™ä¸Šé¢ç¬¬ä¸‰æ¡ç”Ÿæˆçš„sha1å¼€å¤´çš„å­—ç¬¦ä¸²å¯†ç c.NotebookApp.notebook_dir = u'/home/ubuntu/project'c.NotebookApp.open_browser = Falsec.NotebookApp.port = 8888 # è®¿é—®ç«¯å£c.NotebookApp.allow_root = True æ’å…¥ä»¥åŽ,ä¿å­˜é€€å‡º è¿è¡Œç›´æŽ¥å¯åŠ¨ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤å¯åŠ¨ Jupyter Notebookï¼š 1jupyter notebook æ­¤æ—¶ï¼Œè®¿é—® http://&lt;æ‚¨çš„IP åœ°å€&gt;:8888 å³å¯è¿›å…¥ Jupyter é¦–é¡µã€‚ åŽå°è¿è¡Œç›´æŽ¥ä»¥ jupyter notebook å‘½ä»¤å¯åŠ¨ Jupyter çš„æ–¹å¼åœ¨è¿žæŽ¥æ–­å¼€æ—¶å°†ä¼šä¸­æ–­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è®© Jupyter æœåŠ¡åœ¨åŽå°å¸¸é©»ã€‚ å…ˆæŒ‰ä¸‹ Ctrl + C å¹¶è¾“å…¥ y åœæ­¢ Jupyter æœåŠ¡ï¼Œç„¶åŽæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š 1nohup jupyter notebook &gt; /root/ubuntu/jupyter.log 2&gt;&amp;1 &amp; è¯¥å‘½ä»¤å°†ä½¿å¾— Jupyter åœ¨åŽå°è¿è¡Œï¼Œå¹¶å°†æ—¥å¿—å†™åœ¨ /root/ubuntu/jupyter.log æ–‡ä»¶ä¸­ã€‚ å‚è€ƒé“¾æŽ¥ https://cloud.tencent.com/developer/article/1147487 https://suixinblog.cn/2019/02/jupyter-notebook.html]]></content>
      <categories>
        <category>Tools</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[æœ¬åœ°æ­å»ºGitLabæœåŠ¡]]></title>
    <url>%2F2019%2F08%2F13%2F%E6%9C%AC%E5%9C%B0%E6%90%AD%E5%BB%BAGitLab%E6%9C%8D%E5%8A%A1%2F</url>
    <content type="text"><![CDATA[ä»‹ç»GitLabæ˜¯ç”±GItLab Inc.å¼€å‘,ä½¿ç”¨MITè®¸å¯è¯çš„åŸºäºŽç½‘ç»œçš„Gitä»“åº“ç®¡ç†å·¥å…·,ä¸”å…·æœ‰wikiå’Œissueè·Ÿè¸ªåŠŸèƒ½,å’ŒGithubæœ‰äº›ç±»ä¼¼,åŒºåˆ«åœ¨äºŽGitLabä¸ªäººæ³¨å†Œç”¨æˆ·ä¹Ÿå¯ä»¥å…è´¹åˆ›å»ºç§æœ‰ä»“åº“.GItlabå¤§éƒ¨åˆ†ä½¿ç”¨çš„æ—¶å€™éœ€è¦å•ç‹¬åŽ»éƒ¨ç½²åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Š,è€Œä¸”å¯¹é…ç½®ä¹Ÿæœ‰ä¸€å®šè¦æ±‚. æ­å»ºè¿‡ç¨‹çŽ¯å¢ƒè¯´æ˜Ž ç³»ç»Ÿä½¿ç”¨çš„Ubuntu18.04 é…ç½®4G 1.é¦–å…ˆå®‰è£…ä¸€äº›ä¾èµ–æœåŠ¡1sudo apt-get install curl openssh-server ca-certificates postfix 2.å®‰è£…ç¤¾åŒºç‰ˆ-ä¸“ä¸šç‰ˆæ”¶è´¹12sudo curl -sS https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bashsudo apt-get install gitlab-ce 3.ä¿®æ”¹ip1æ‰“å¼€/etc/gitlab/gitlab.rb,å°†external_url = 'git.example.com'ä¿®æ”¹ä¸ºè‡ªå·±çš„åŸŸååœ°å€æˆ–è€…IPåœ°å€ 4.æ‰§è¡Œé‡æ–°åŠ è½½é…ç½®1sudo gitlab-ctl reconfigure å¯åŠ¨å®ŒæˆåŽæµè§ˆå™¨è®¿é—®é…ç½®å¥½çš„åœ°å€ï¼Œåº”è¯¥å‡ºçŽ°é‡ç½®ç®¡ç†å‘˜å¯†ç çš„ç•Œé¢,è¾“å…¥å¯†ç å°±å¯ä»¥äº†. å¸¸ç”¨å‘½ä»¤ å¯åŠ¨æœåŠ¡ sudo gitlab-ctl start sudo gitlab-ctl reconfigure å¤§åŠŸå‘Šæˆ]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>gitlab</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DRF-Generic-Views&æºç åˆ†æž]]></title>
    <url>%2F2019%2F07%2F20%2Fdjango-rest-framework-api-guide-generic-views%2F</url>
    <content type="text"><![CDATA[Djangoâ€™s generic viewsâ€¦ were developed as a shortcut for common usage patternsâ€¦ They take certain common idioms and patterns found in view development and abstract them so that you can quickly write common views of data without having to repeat yourself. â€” Django Documentation è¿™æ˜¯ä¸€æ®µæ¥è‡ªDjangoå®˜æ–¹æ–‡æ¡£çš„ä¸€å¥è¯,å¤§æ¦‚æ„æ€å°±æ˜¯ generic viewsæˆä¸ºä¸€ç§é€šç”¨çš„ä½¿ç”¨æ¨¡å¼,ä¸»è¦æ˜¯å¯¹å¼€å‘ä¸­ç±»è§†å›¾çš„é€šç”¨ç”¨æ³•å’Œæ¨¡å¼è¿›è¡ŒæŠ½ç¦»,è¿™æ ·å°±å¯ä»¥å¿«é€Ÿçš„ç¼–å†™ç±»è§†å›¾,è€Œä¸å¿…é‡å¤å†™é‡å¤ä»£ç . ä»‹ç» ä½¿ç”¨ç±»è§†å›¾æœ‰ä¸€ä¸ªéžå¸¸å…³é”®çš„å¥½å¤„æ˜¯,ç±»è§†å›¾å¯ä»¥é€šè¿‡ç»§æ‰¿ç»„åˆé‡å¤ç¼–å†™çš„å„ä¸ªéƒ¨åˆ†,RESTæ¡†æž¶æä¾›ä¸€äº›é¢„å…ˆæž„å»ºçš„è§†å›¾(mixinç±»,GenericAPIView)æ¥å®žçŽ°,è¿™äº›è§†å›¾æä¾›äº†å¸¸è§çš„æ¨¡å¼. REST Frameworkæä¾›çš„generic viewså¯ä»¥å¿«é€Ÿæž„å»ºä¸Žæ•°æ®åº“æ¨¡åž‹ç´§å¯†æ˜ å°„çš„APIè§†å›¾. å¦‚æžœDRFè‡ªå¸¦çš„å¸¸ç”¨generic viewsä¸é€‚åˆä½ çš„API,å¯ä»¥ä½¿ç”¨å¸¸è§„çš„APIViewç±»,æˆ–è€…é‡å†™generic viewä½¿ç”¨çš„minxiç±»å’ŒåŸºç±»,ç»„æˆé€‚åˆå½“å‰APIçš„ç±»è§†å›¾. æ¡ˆä¾‹ é€šå¸¸åœ¨ä½¿ç”¨generic views,ä½ éœ€è¦è‡ªå®šä¹‰ç±»è§†å›¾åŽ»ç»§æ‰¿,å¹¶è®¾ç½®å‡ ä¸ªç±»å±žæ€§ 123456789from django.contrib.auth.models import Userfrom myapp.serializers import UserSerializerfrom rest_framework import genericsfrom rest_framework.permissions import IsAdminUserclass UserList(generics.ListCreateAPIView): queryset = User.objects.all() serializer_class = UserSerializer permission_classes = [IsAdminUser] å¯¹äºŽå®žé™…çš„ä¸€äº›éœ€æ±‚,ä½ å¯èƒ½è¿˜éœ€è¦é‡å†™generic viewsè§†å›¾ç±»å½“ä¸­çš„å„ç§æ–¹æ³• 1234567891011class UserList(generics.ListCreateAPIView): queryset = User.objects.all() serializer_class = UserSerializer permission_classes = [IsAdminUser] def list(self, request): # é‡å†™çˆ¶ç±»çš„listæ–¹æ³• # Note the use of `get_queryset()` instead of `self.queryset` # æ³¨æ„: ä½¿ç”¨`get_queryset()åŽ»æ›¿ä»£self.queryset` queryset = self.get_queryset() serializer = UserSerializer(queryset, many=True) return Response(serializer.data) å¯¹äºŽæ¯”è¾ƒç®€å•çš„æƒ…å†µ,è¿˜å¯ä»¥ä½¿ç”¨as_view()æ–¹æ³•ä¼ é€’ä»»ä½•ç±»å±žæ€§,è¿™æ ·è¿žç±»è§†å›¾éƒ½ä¸ç”¨å†™äº† 1url(r'^/users/', ListCreateAPIView.as_view(queryset=User.objects.all(), serializer_class=UserSerializer), name='user-list') GenericAPIViewGenericAPIViewç»§æ‰¿è‡ªAPIViewç±»,åœ¨è¯¥ç±»çš„åŸºç¡€ä¸Šè¿›è¡Œäº†æ‰©å±•,ä¸ºå…·ä½“çš„é€šç”¨æ€§è§†å›¾æ·»åŠ äº†å¸¸ç”¨çš„å±žæ€§å’Œæ–¹æ³•,å†…ç½®çš„æ¯ä¸ªé€šç”¨åž‹è§†å›¾éƒ½æ˜¯é€šè¿‡ç»„åˆGenericAPIViewå’Œä¸€ä¸ªæˆ–å¤šä¸ªmixinç±»æ¥æž„å»ºçš„. Note:é€šç”¨åž‹è§†å›¾æŒ‡DRFé€šè¿‡5ä¸ªminxiç±»å’ŒGenericAPIViewç»„åˆäº§ç”Ÿçš„9ä¸ªé€šç”¨åž‹ç±»è§†å›¾,ä¸‹é¢ä¼šè¯¦ç»†è®²è§£ å±žæ€§-AttributesåŸºæœ¬ç±»å±žæ€§-Basic settings queryset ä¸»è¦è¿”å›žè¯¥è§†å›¾æ‰€ä½¿ç”¨çš„æ¨¡åž‹ç±»çš„æŸ¥è¯¢é›†,é€šå¸¸å¿…é¡»è®¾ç½®è¯¥å±žæ€§æˆ–é‡å†™get_queryset()æ–¹æ³•; å¦‚æžœä½ é‡å†™äº†ç±»è§†å›¾çš„æ–¹æ³•,åœ¨é‡å†™çš„æ–¹æ³•ä¸­,åº”è¯¥ä½¿ç”¨get_queryset(),è€Œä¸æ˜¯ç›´æŽ¥ä½¿ç”¨self.queryset,è¿™ä¸ªæ˜¯ä¸€ä¸ªå‘ç‚¹!!!å› ä¸ºDjangoçš„ORMæ˜¯æƒ°æ€§æŸ¥è¯¢,RESTå†…éƒ¨ä¼šå¯¹querysetè¿›è¡Œç¼“å­˜ç”¨äºŽåŽç»­çš„ä½¿ç”¨.æˆ‘ä»¬å†å…·ä½“ä½¿ç”¨çš„æ—¶å€™åº”è¯¥è°ƒç”¨get_queryset(),ç¡®ä¿å¯¹æ¯ä¸ªè¯·æ±‚é‡æ–°è¯„ä¼°queryset,ä»¥ä¿è¯ä»Žæ•°æ®åº“ä¸­æŸ¥è¯¢çš„éƒ½æ˜¯æœ€æ–°æ•°æ®. serializer_class è¯¥å±žæ€§ä¸»è¦æ˜¯è®¾ç½®ç”¨äºŽååºåˆ—åŒ–(æ ¡éªŒ|è¾“å…¥)ä»¥åŠåºåˆ—åŒ–(è¾“å‡º)çš„åºåˆ—åŒ–å™¨,é€šå¸¸å¿…é¡»è®¾ç½®è¯¥å±žæ€§,æˆ–è€…é‡å†™get_serializer_class()æ–¹æ³• lookup_field ç”¨äºŽæŸ¥è¯¢å•ä¸ªæ¨¡åž‹å®žä¾‹å¯¹è±¡çš„æ¨¡åž‹è¿‡æ»¤å­—æ®µ,é»˜è®¤æ˜¯pk åœ¨ä½¿ç”¨è¶…é“¾æŽ¥hyperlinked APIæ—¶,å¦‚æžœéœ€è¦ä½¿ç”¨è‡ªå®šä¹‰å€¼ï¼Œéœ€è¦ç¡®ä¿APIè§†å›¾å’Œåºåˆ—åŒ–å™¨ç±»éƒ½è®¾ç½®äº†æŸ¥æ‰¾å­—æ®µã€‚ lookup_url_kwarg ç”¨äºŽå¯¹è±¡æŸ¥æ‰¾çš„URLå…³é”®å­—å‚æ•°ã€‚URL confä¸­åº”è¯¥åŒ…å«ä¸Žæ­¤å€¼å¯¹åº”çš„å…³é”®å­—å‚æ•°ã€‚å¦‚æžœå–æ¶ˆè®¾ç½®ï¼Œåˆ™é»˜è®¤ä½¿ç”¨ä¸Žlookup_fieldç›¸åŒçš„å€¼ã€‚ lookup_fieldå’Œlookup_url_kwargè¿™ä¸¤ä¸ªå‚æ•°ä¸»è¦ä½œç”¨å°±æ˜¯èŽ·å–å•ä¸ªæ¨¡åž‹å¯¹è±¡,å¯¹åº”çš„æ–¹æ³•å°±æ˜¯ GenericAPIViewä¸­çš„get_object()æ–¹æ³• 12345678910111213141516171819def get_object(self): """ æ ¹æ® url confä¸­çš„å…³é”®å­—å‚æ•°,ä»Žquerysetå½“ä¸­æŸ¥æ‰¾å•ç»™å®žä¾‹å¯¹è±¡ """ # è¿‡æ»¤ queryset = self.filter_queryset(self.get_queryset()) # urlå½“ä¸­çš„å‚æ•°åç§° å¦‚æžœself.lookup_url_kwargæ²¡æœ‰é…ç½®å°±ä½¿ç”¨self.lookup_field lookup_url_kwarg = self.lookup_url_kwarg or self.lookup_field # ç»„æˆæŸ¥è¯¢å­—å…¸ key: self.lookup_field value: åœ¨self.kwargsä¸­é€šè¿‡lookup_url_kwargæ‹¿åˆ°å¯¹åº” çš„å€¼ ä¾‹: &#123;'pk': 1&#125; filter_kwargs = &#123;self.lookup_field: self.kwargs[lookup_url_kwarg]&#125; # æ ¹æ®è¿‡æ»¤æ¡ä»¶æ‹¿åˆ°å¯¹åº”çš„å¯¹è±¡,å¦‚æžœä¸å­˜åœ¨è¿”å›ž404 obj = get_object_or_404(queryset, **filter_kwargs) # æ£€æŸ¥å¯¹è¯¥å¯¹è±¡æ˜¯å¦æƒé™è®¿é—® self.check_object_permissions(self.request, obj) return obj åˆ†é¡µå™¨-Paginationå½“ç±»è§†å›¾ä¸­ä½¿ç”¨äº† ListModelMixinæ—¶,ä½¿ç”¨ä»¥ä¸‹å±žæ€§æŽ§åˆ¶åˆ†é¡µ pagination_class è¯¥ç±»è§†å›¾åˆ†é¡µæ‰€ä½¿ç”¨çš„åˆ†é¡µå™¨ç±» å¯ä»¥è¦†ç›–/é‡å†™è¯¥å±žæ€§,ä¹Ÿå¯ä»¥åœ¨å…¨å±€settingsé…ç½®è‡ªå®šä¹‰çš„åˆ†é¡µå™¨ç±» è®¾ç½®pagination_class=Noneå°†ç¦ç”¨æ­¤è§†å›¾ä¸­çš„åˆ†é¡µ è¿‡æ»¤å™¨-Filtering filter_backends ç”¨äºŽç­›é€‰querysetçš„è¿‡æ»¤å™¨åˆ—è¡¨ã€‚é»˜è®¤å€¼ä¸ŽDEFAULT_FILTER_BACKENDSè®¾ç½®ç›¸åŒçš„å€¼ã€‚ æ–¹æ³•-MethodsåŸºç¡€æ–¹æ³•-Base methods get_queryset(self) è¿”å›žåº”ç”¨äºŽListAPIViewåˆ—è¡¨è§†å›¾çš„queryset,å¹¶å°†å…¶ç”¨ä½œå…¶ä»–è¯¦ç»†è§†å›¾(RetrieveModelMixin/UpdateModelMixin/DestroyModelMixin)æŸ¥æ‰¾çš„åŸºç¡€ åº”è¯¥å§‹ç»ˆä½¿ç”¨æ­¤æ–¹æ³•ï¼Œè€Œä¸æ˜¯è®¿é—®self.queryset,å…·ä½“åŽŸå› è§ä¸Šæ–‡ å¯ä»¥é‡å†™è¯¥æ–¹æ³•ä»¥æä¾›åŠ¨æ€è¡Œä¸ºï¼Œä¾‹å¦‚è¿”å›žç‰¹å®šäºŽå‘å‡ºè¯·æ±‚çš„ç”¨æˆ·çš„querysetã€‚ 123def get_queryset(self): user = self.request.user return user.accounts.all() get_objects(self) è¿”å›žåº”ç”¨äºŽè¯¦ç»†è§†å›¾çš„å¯¹è±¡å®žä¾‹.é»˜è®¤ä½¿ç”¨lookup_fieldå‚æ•°è¿‡æ»¤querysetã€‚ Note: è¯¦ç»†è§†å›¾æŒ‡çš„å…¶å®žå°±æ˜¯RetrieveModelMixin/UpdateModelMixin/DestroyModelMixin å¯ä»¥é‡å†™ä»¥æä¾›æ›´å¤æ‚çš„è¡Œä¸ºï¼Œä¾‹å¦‚åŸºäºŽå¤šä¸ªURL kwargçš„å¯¹è±¡æŸ¥æ‰¾ã€‚ 123456789def get_object(self): queryset = self.get_queryset() filter = &#123;&#125; for field in self.multiple_lookup_fields: filter[field] = self.kwargs[field] obj = get_object_or_404(queryset, **filter) self.check_object_permissions(self.request, obj) return obj æ³¨æ„ï¼Œå¦‚æžœæ‚¨çš„APIä¸åŒ…å«ä»»ä½•å¯¹è±¡çº§æƒé™ï¼Œæ‚¨å¯ä»¥é€‰æ‹©æŽ’é™¤self.check_object_permissionsï¼Œå¹¶ç®€å•åœ°ä»Žget_object_or_404æŸ¥æ‰¾ä¸­è¿”å›žå¯¹è±¡ã€‚ filter_queryset(self, queryset) ä½¿ç”¨è¿‡æ»¤å™¨å¯¹querysetè¿›è¡Œè¿‡æ»¤,è¿”å›žæ–°çš„querysetå¯¹è±¡ 123456789101112def filter_queryset(self, queryset): filter_backends = [CategoryFilter] if 'geo_route' in self.request.query_params: filter_backends = [GeoRouteFilter, CategoryFilter] elif 'geo_point' in self.request.query_params: filter_backends = [GeoPointFilter, CategoryFilter] for backend in list(filter_backends): queryset = backend().filter_queryset(self.request, queryset, view=self) return queryset get_serializer_class(self) è¿”å›žåº”ç”¨äºŽåºåˆ—åŒ–ç¨‹åºçš„ç±»ã€‚é»˜è®¤è¿”å›žç±»è§†å›¾serializer_classå±žæ€§ã€‚ å¯ä»¥é‡å†™ä»¥æä¾›åŠ¨æ€è¡Œä¸ºï¼Œä¾‹å¦‚ä¸ºè¯»å†™æ“ä½œä½¿ç”¨ä¸åŒçš„åºåˆ—åŒ–å™¨ï¼Œæˆ–ä¸ºä¸åŒç±»åž‹çš„ç”¨æˆ·æä¾›ä¸åŒçš„åºåˆ—åŒ–å™¨ã€‚ 1234def get_serializer_class(self): if self.request.user.is_staff: return FullAccountSerializer return BasicAccountSerializer Save and deletion hooks-ä¿å­˜å’Œåˆ é™¤çš„é’©å­mixinç±»æä¾›äº†ä»¥ä¸‹æ–¹æ³•ï¼Œå¹¶æä¾›äº†å¯¹è±¡ä¿å­˜æˆ–åˆ é™¤è¡Œä¸ºçš„ç®€å•é‡å†™ã€‚ perform_create(self, serializer)â€”â€”åœ¨ä¿å­˜æ–°å¯¹è±¡å®žä¾‹æ—¶ç”±CreateModelMixinè°ƒç”¨ã€‚ perform_update(self, serializer)â€”â€”åœ¨æ›´æ–°çŽ°æœ‰å¯¹è±¡å®žä¾‹æ—¶ç”±UpdateModelMixinè°ƒç”¨ perform_destroy(self, instance)â€”â€”åœ¨åˆ é™¤å¯¹è±¡å®žä¾‹æ—¶ç”±DestroyModelMixinè°ƒç”¨ã€‚ è¿™äº›æŒ‚é’©å¯¹äºŽè®¾ç½®è¯·æ±‚ä¸­éšå«çš„å±žæ€§(ä½†ä¸æ˜¯è¯·æ±‚æ•°æ®çš„ä¸€éƒ¨åˆ†)ç‰¹åˆ«æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥æ ¹æ®è¯·æ±‚ç”¨æˆ·æˆ–URLå…³é”®å­—å‚æ•°åœ¨å¯¹è±¡ä¸Šè®¾ç½®å±žæ€§ã€‚ 12def perform_create(self, serializer): serializer.save(user=self.request.user) è¿™äº›è¦†ç›–ç‚¹å¯¹äºŽæ·»åŠ ä¿å­˜å¯¹è±¡ä¹‹å‰æˆ–ä¹‹åŽå‘ç”Ÿçš„è¡Œä¸ºä¹Ÿç‰¹åˆ«æœ‰ç”¨ï¼Œæ¯”å¦‚å‘é€ç”µå­é‚®ä»¶ç¡®è®¤æˆ–è®°å½•æ›´æ–°ã€‚ 123def perform_update(self, serializer): instance = serializer.save() send_email_confirmation(user=self.request.user, modified=instance) æ‚¨è¿˜å¯ä»¥ä½¿ç”¨è¿™äº›é’©å­é€šè¿‡å¼•å‘ValidationError()æ¥æä¾›é¢å¤–çš„éªŒè¯ã€‚å¦‚æžœéœ€è¦åœ¨æ•°æ®åº“ä¿å­˜æ—¶åº”ç”¨ä¸€äº›éªŒè¯é€»è¾‘ï¼Œè¿™å°†éžå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚: 12345def perform_create(self, serializer): queryset = SignupRequest.objects.filter(user=self.request.user) if queryset.exists(): raise ValidationError('You have already signed up') serializer.save(user=self.request.user) å…¶ä»–æ–¹æ³•-Other methodsé€šå¸¸ä¸éœ€è¦è¦†ç›–ä»¥ä¸‹æ–¹æ³•ï¼Œä½†å¦‚æžœä½¿ç”¨GenericAPIViewç¼–å†™è‡ªå®šä¹‰è§†å›¾ï¼Œåˆ™å¯èƒ½éœ€è¦è°ƒç”¨è¿™äº›æ–¹æ³•ã€‚ get_serializer_context(self) è¿”å›žä¸€ä¸ªå­—å…¸ï¼Œå…¶ä¸­åŒ…å«åº”è¯¥æä¾›ç»™åºåˆ—åŒ–ç¨‹åºçš„ä»»ä½•é¢å¤–ä¸Šä¸‹æ–‡ã€‚é»˜è®¤åŒ…æ‹¬â€œrequestâ€ã€â€œviewâ€å’Œâ€œformatâ€é”®ã€‚ get_serializer(self, instance=None, data=None, many=False, partial=False) è¿”å›žä¸€ä¸ªåºåˆ—åŒ–å™¨å¯¹è±¡ 123456789101112131415161718 def get_serializer(self, *args, **kwargs): """ è¿”å›žåº”è¯¥ç”¨äºŽéªŒè¯å’Œçš„åºåˆ—åŒ–å™¨å®žä¾‹ååºåˆ—åŒ–è¾“å…¥å’Œåºåˆ—åŒ–è¾“å‡ºã€‚ """ serializer_class = self.get_serializer_class() kwargs['context'] = self.get_serializer_context() # ä¼ é€’ç»™åºåˆ—åŒ–å™¨ return serializer_class(*args, **kwargs) def get_serializer_context(self): """ æä¾›ç»™åºåˆ—åŒ–å™¨ç±»çš„é¢å¤–ä¸Šä¸‹æ–‡ã€‚ """ return &#123; 'request': self.request, 'format': self.format_kwarg, 'view': self &#125; get_paginated_response(self, data) è¿”å›žåˆ†é¡µæ ¼å¼çš„å“åº”å¯¹è±¡ paginate_queryset(self, queryset) å¦‚æžœéœ€è¦åˆ†é¡µquerysetï¼Œåˆ™è¿”å›žä¸€ä¸ªpageå¯¹è±¡ï¼Œå¦‚æžœæ²¡æœ‰ä¸ºæ­¤è§†å›¾é…ç½®åˆ†é¡µï¼Œåˆ™è¿”å›žNoneã€‚ filter_queryset(self, queryset) ç»™å®šä¸€ä¸ªquerysetï¼Œä½¿ç”¨è¿‡æ»¤å™¨è¿‡æ»¤,è¿”å›žä¸€ä¸ªæ–°çš„querysetã€‚ Mixins mixinç±»æä¾›äº†ç”¨äºŽæä¾›åŸºæœ¬è§†å›¾è¡Œä¸ºçš„æ“ä½œ(Create|List|Update|Retrieve|Destory)ã€‚æ³¨æ„ï¼Œmixinç±»æä¾›äº†æ“ä½œæ–¹æ³•ï¼Œè€Œä¸æ˜¯ç›´æŽ¥å®šä¹‰å¤„ç†ç¨‹åºæ–¹æ³•. mixinç±»å¯ä»¥ä»Žrest_framework.mixinå¯¼å…¥ã€‚ ListModelMixin æä¾›ä¸€ä¸ª .list(request, *args, **kwargs) æ–¹æ³•ï¼Œå®žçŽ°äº†åˆ—å‡ºä¸€ä¸ªæŸ¥è¯¢é›†; å¦‚æžœå®šä¹‰äº†åˆ†é¡µå™¨ç±»ï¼Œå¯¹querysetè¿›è¡Œåˆ†é¡µ,å°†åˆ†é¡µåŽçš„çš„å¯¹è±¡åˆ—è¡¨ è¿›è¡Œåºåˆ—åŒ–è¿”å›ž; å¦‚æžœæ²¡æœ‰å®šä¹‰,åˆ™ç›´æŽ¥å¯¹querysetè¿›è¡Œåºåˆ—åŒ–è¿”å›ž; 1234567891011121314class ListModelMixin(object): """ ä¸€ä¸ªquerysetåˆ—è¡¨minxinç±» """ def list(self, request, *args, **kwargs): queryset = self.filter_queryset(self.get_queryset()) # å¯¹querysetè¿›è¡Œè¿‡æ»¤ page = self.paginate_queryset(queryset) # å¯¹querysetè¿›è¡Œåˆ†é¡µ if page is not None: # å¦‚æžœè®¾ç½®äº†åˆ†é¡µå™¨ç±» serializer = self.get_serializer(page, many=True) # å¯¹åˆ†é¡µåŽçš„æ•°æ®åºåˆ—åŒ– return self.get_paginated_response(serializer.data) # å“åº” # æ²¡æœ‰è®¾ç½®åˆ†é¡µå™¨,ç›´æŽ¥åºåˆ—åŒ–æ•°æ®è¿”å›ž serializer = self.get_serializer(queryset, many=True) return Response(serializer.data) CreateModelMixin æä¾›.create(requestï¼Œ *argsï¼Œ **kwargs)æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å®žçŽ°åˆ›å»ºå’Œä¿å­˜æ–°æ¨¡åž‹å®žä¾‹; å¦‚æžœåˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå°†è¿”å›žä¸€ä¸ª201åˆ›å»ºçš„å“åº”ï¼Œå¹¶å°†å¯¹è±¡çš„åºåˆ—åŒ–è¡¨ç¤ºä½œä¸ºå“åº”çš„ä¸»ä½“ã€‚å¦‚æžœè¡¨ç¤ºåŒ…å«ä¸€ä¸ªåä¸ºurlçš„é”®ï¼Œåˆ™å°†ç”¨è¯¥å€¼å¡«å……å“åº”çš„ä½ç½®å¤´ã€‚ å¦‚æžœä¸ºåˆ›å»ºå¯¹è±¡æä¾›çš„è¯·æ±‚æ•°æ®æ— æ•ˆï¼Œå°†è¿”å›ž400é”™è¯¯è¯·æ±‚å“åº”ï¼Œå¹¶å°†é”™è¯¯ç»†èŠ‚ä½œä¸ºå“åº”çš„ä¸»ä½“ã€‚ 1234567891011121314151617181920class CreateModelMixin(object): """ åˆ›å»ºä¸€ä¸ªæ¨¡åž‹å¯¹è±¡ """ def create(self, request, *args, **kwargs): serializer = self.get_serializer(data=request.data) # èŽ·å–åºåˆ—åŒ–å™¨å¯¹è±¡ serializer.is_valid(raise_exception=True) # åºåˆ—åŒ–æ ¡éªŒ self.perform_create(serializer) # è°ƒç”¨saveæ–¹æ³•åˆ›å»ºæ¨¡åž‹å¯¹è±¡ headers = self.get_success_headers(serializer.data) # èŽ·å–å“åº”å¤´éƒ¨ä¿¡æ¯ return Response(serializer.data, status=status.HTTP_201_CREATED, headers=headers) def perform_create(self, serializer): serializer.save() # æ ¹æ®åˆ›å»ºåºåˆ—åŒ–å™¨å¯¹è±¡æ—¶ä¼ å…¥çš„å‚æ•°,è°ƒç”¨Update/Createæ–¹æ³• def get_success_headers(self, data): '''åˆ¤æ–­åºåˆ—åŒ–çš„æ•°æ®ä¸­æ˜¯å¦æœ‰ä¸€ä¸ªkeyå«åš`url`çš„æ•°æ®,ç”¨è¯¥å€¼å¡«å……å“åº”çš„ä½ç½®å¤´''' try: return &#123;'Location': str(data[api_settings.URL_FIELD_NAME])&#125; except (TypeError, KeyError): return &#123;&#125; RetrieveModelMixin æä¾›.retrieve(requestï¼Œ *argsï¼Œ **kwargs)æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å®žçŽ°åœ¨å“åº”ä¸­è¿”å›žçŽ°æœ‰æ¨¡åž‹å®žä¾‹ã€‚ å¦‚æžœèƒ½å¤Ÿæ£€ç´¢åˆ°å¯¹è±¡ï¼Œåˆ™è¿”å›žä¸€ä¸ª200 OKå“åº”ï¼Œå¹¶å°†å¯¹è±¡çš„åºåˆ—åŒ–ç»“æžœä½œä¸ºå“åº”çš„ä¸»ä½“ã€‚å¦åˆ™å®ƒå°†è¿”å›ž404 Not Foundã€‚ 12345678910class RetrieveModelMixin(object): """ è¿”å›žä¸€ä¸ªæ¨¡åž‹å¯¹è±¡å®žä¾‹ """ def retrieve(self, request, *args, **kwargs): # èŽ·å–æ¨¡åž‹å®žä¾‹å¯¹è±¡,æ ¹æ®URLå½“ä¸­çš„å‚æ•° instance = self.get_object() # èŽ·å–åºåˆ—åŒ–å™¨å¯¹è±¡ serializer = self.get_serializer(instance) return Response(serializer.data) # è¿”å›žæ¨¡åž‹å¯¹è±¡çš„åºåˆ—åŒ–å™¨ç»“æžœ UpdateModelMixin æä¾›.update(requestï¼Œ *argsï¼Œ **kwargs)æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å®žçŽ°æ›´æ–°å’Œä¿å­˜å½“å‰æ¨¡åž‹å®žä¾‹ã€‚ è¿˜æä¾›.partial_update(requestï¼Œ *argsï¼Œ **kwargs)æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç±»ä¼¼äºŽupdateæ–¹æ³•ï¼Œåªæ˜¯æ›´æ–°çš„æ‰€æœ‰å­—æ®µéƒ½æ˜¯å¯é€‰çš„ã€‚è¿™å…è®¸æ”¯æŒHTTP PATCHè¯·æ±‚ã€‚ å¦‚æžœå¯¹è±¡è¢«æ›´æ–°ï¼Œå®ƒå°†è¿”å›žä¸€ä¸ª200 OKå“åº”ï¼Œå¹¶å°†å¯¹è±¡çš„åºåˆ—åŒ–è¡¨ç¤ºä½œä¸ºå“åº”çš„ä¸»ä½“ã€‚ å¦‚æžœä¸ºæ›´æ–°å¯¹è±¡æä¾›çš„è¯·æ±‚æ•°æ®æ— æ•ˆï¼Œå°†è¿”å›ž400ä¸ªé”™è¯¯è¯·æ±‚å“åº”ï¼Œå¹¶å°†é”™è¯¯ç»†èŠ‚ä½œä¸ºå“åº”çš„ä¸»ä½“ã€‚ 12345678910111213141516171819202122232425class UpdateModelMixin(object): """ æ›´æ–°ä¸€ä¸ªå®žä¾‹å¯¹è±¡ """ def update(self, request, *args, **kwargs): partial = kwargs.pop('partial', False) instance = self.get_object() # èŽ·å–è¦æ›´æ–°çš„å®žä¾‹å¯¹è±¡ serializer = self.get_serializer(instance, data=request.data, partial=partial) # èŽ·å–åºåˆ—åŒ–å™¨å¯¹è±¡ serializer.is_valid(raise_exception=True) # è¿›è¡Œå‚æ•°æ ¡éªŒ,å¦‚æžœå¤±è´¥æŠ›å‡º400å¼‚å¸¸ self.perform_update(serializer) # è°ƒç”¨æ›´æ–°æ–¹æ³• if getattr(instance, '_prefetched_objects_cache', None): # å¦‚æžœ'prefetch_related'å·²åº”ç”¨äºŽquerysetï¼Œæˆ‘ä»¬éœ€è¦è¿™æ ·åš # å¼ºåˆ¶ä½¿å®žä¾‹ä¸Šçš„é¢„å–ç¼“å­˜æ— æ•ˆ instance._prefetched_objects_cache = &#123;&#125; return Response(serializer.data) def perform_update(self, serializer): serializer.save() # åºåˆ—åŒ–å™¨å¯¹è±¡è°ƒç”¨ä¿å­˜æ–¹æ³•save(),ç„¶åŽè°ƒç”¨åºåˆ—åŒ–å™¨å¯¹è±¡updateæ–¹æ³• def partial_update(self, request, *args, **kwargs): kwargs['partial'] = True # æ›´æ–°ä¸€éƒ¨åˆ†å­—æ®µ return self.update(request, *args, **kwargs) DestoryModelMixinæä¾›.destroy(requestï¼Œ *argsï¼Œ **kwargs)æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å®žçŽ°åˆ é™¤çŽ°æœ‰æ¨¡åž‹å®žä¾‹ã€‚ å¦‚æžœä¸€ä¸ªå¯¹è±¡è¢«åˆ é™¤ï¼Œå®ƒå°†è¿”å›žä¸€ä¸ª204 No Content responseï¼Œå¦åˆ™å®ƒå°†è¿”å›žä¸€ä¸ª404 Not Foundã€‚ ConcreteViewClasses-é€šç”¨ç±»è§†å›¾ä¸‹é¢çš„ç±»æ˜¯å…·ä½“çš„é€šç”¨è§†å›¾,é€šå¸¸æˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨è¿™äº›ç±»è§†å›¾ï¼Œé™¤éžæ‚¨éœ€è¦é«˜åº¦å®šåˆ¶çš„è¡Œä¸ºã€‚è§†å›¾ç±»å¯ä»¥ä»Žrest_frame.genericså¯¼å…¥ã€‚ CreaAPIView ç”¨äºŽåˆ›å»ºä¸€ä¸ªå®žä¾‹å¯¹è±¡ æä¾›ä¸€ä¸ªpostæ–¹æ³•å¤„ç†ç¨‹åº 123456789class CreateAPIView(mixins.CreateModelMixin, GenericAPIView): """ ç”¨äºŽåˆ›å»ºæ¨¡åž‹å®žä¾‹çš„å…·ä½“è§†å›¾ã€‚ """ def post(self, request, *args, **kwargs): # è°ƒç”¨CreateModelMixinä¸­çš„createæ–¹æ³• return self.create(request, *args, **kwargs) ListAPIView ç”¨äºŽæä¾›æ¨¡åž‹å®žä¾‹åˆ—è¡¨ æä¾›ä¸€ä¸ªgetæ–¹æ³•å¤„ç†ç¨‹åº 123456789class ListAPIView(mixins.ListModelMixin, GenericAPIView): """ åˆ—å‡ºquerysetçš„å…·ä½“è§†å›¾ã€‚ """ def get(self, request, *args, **kwargs): # # ListModelMixinçš„getæ–¹æ³• return self.list(request, *args, **kwargs) RetrieveAPIView ç”¨äºŽæä¾›å•ä¸ªæ¨¡åž‹å®žä¾‹å¯¹è±¡ æä¾›ä¸€ä¸ªgetæ–¹æ³•å¤„ç†ç¨‹åº 123456789class RetrieveAPIView(mixins.RetrieveModelMixin, GenericAPIView): """ èŽ·å–å•ä¸ªæ¨¡åž‹å®žä¾‹çš„å…·ä½“è§†å›¾ã€‚ """ def get(self, request, *args, **kwargs): # RetrieveModelMixinçš„getæ–¹æ³• return self.retrieve(request, *args, **kwargs) DestroyAPIView ç”¨äºŽåˆ é™¤å•ä¸ªæ¨¡åž‹å®žä¾‹å¯¹è±¡ æä¾›ä¸€ä¸ªdeleteæ–¹æ³•å¤„ç†ç¨‹åº 123456789class DestroyAPIView(mixins.DestroyModelMixin, GenericAPIView): """ åˆ é™¤å•ä¸ªæ¨¡åž‹å®žä¾‹çš„å…·ä½“è§†å›¾ """ def delete(self, request, *args, **kwargs): # è°ƒç”¨DestroyModelMixinä¸­çš„destroyæ–¹æ³• return self.destroy(request, *args, **kwargs) UpdateAPIView ç”¨äºŽæ›´æ–°å•ä¸ªæ¨¡åž‹å®žä¾‹å¯¹è±¡ æä¾›putå’Œpatchæ–¹æ³•å¤„ç†ç¨‹åº 12345678910111213class UpdateAPIView(mixins.UpdateModelMixin, GenericAPIView): """ æ›´æ–°å•ä¸ªæ¨¡åž‹å®žä¾‹çš„å…·ä½“è§†å›¾ """ def put(self, request, *args, **kwargs): # è°ƒç”¨UpdateModelMixinä¸­çš„updateæ–¹æ³• return self.update(request, *args, **kwargs) def patch(self, request, *args, **kwargs): # è°ƒç”¨UpdateModelMixinä¸­çš„partial_updateæ–¹æ³• return self.partial_update(request, *args, **kwargs) ListCreateAPIView ç”¨äºŽåˆ›å»ºå•ä¸ªæ¨¡åž‹å¯¹è±¡å’ŒèŽ·å–æ¨¡åž‹å¯¹è±¡é›†åˆ æä¾›getå’Œpostæ–¹æ³•å¤„ç†ç¨‹åº 123456789101112class ListCreateAPIView(mixins.ListModelMixin, mixins.CreateModelMixin, GenericAPIView): """ åˆ—å‡ºquerysetæˆ–åˆ›å»ºæ¨¡åž‹å®žä¾‹çš„å…·ä½“è§†å›¾ã€‚ """ def get(self, request, *args, **kwargs): return self.list(request, *args, **kwargs) def post(self, request, *args, **kwargs): return self.create(request, *args, **kwargs) RetrieveUpdateAPIView ç”¨äºŽè¯»å–å’Œæ›´æ–°å•ä¸ªæ¨¡åž‹å¯¹è±¡ æä¾›getå’Œputå’Œpatchæ–¹æ³•å¤„ç†ç¨‹åº 123456789101112131415class RetrieveUpdateAPIView(mixins.RetrieveModelMixin, mixins.UpdateModelMixin, GenericAPIView): """ ç”¨äºŽèŽ·å–ã€æ›´æ–°å•ä¸ªæ¨¡åž‹å®žä¾‹çš„å…·ä½“è§†å›¾ã€‚ """ def get(self, request, *args, **kwargs): return self.retrieve(request, *args, **kwargs) def put(self, request, *args, **kwargs): return self.update(request, *args, **kwargs) def patch(self, request, *args, **kwargs): return self.partial_update(request, *args, **kwargs) RetrieveDestroyAPIView ç”¨äºŽè¯»å–å’Œåˆ é™¤å•ä¸ªæ¨¡åž‹å¯¹è±¡ æä¾›getå’Œdeleteæ–¹æ³•å¤„ç†ç¨‹åº 123456789101112class RetrieveDestroyAPIView(mixins.RetrieveModelMixin, mixins.DestroyModelMixin, GenericAPIView): """ ç”¨äºŽèŽ·å–æˆ–åˆ é™¤å•ä¸ªæ¨¡åž‹å®žä¾‹çš„å…·ä½“è§†å›¾ã€‚ """ def get(self, request, *args, **kwargs): return self.retrieve(request, *args, **kwargs) def delete(self, request, *args, **kwargs): return self.destroy(request, *args, **kwargs) RetrieveUpdateDestroyAPIView ç”¨äºŽè¯»å–/æ›´æ–°/åˆ é™¤å•ä¸ªæ¨¡åž‹å¯¹è±¡ æä¾›getå’Œputå’Œpatchå’Œdeleteæ–¹æ³•å¤„ç†ç¨‹åº 12345678910111213141516171819class RetrieveUpdateDestroyAPIView(mixins.RetrieveModelMixin, mixins.UpdateModelMixin, mixins.DestroyModelMixin, GenericAPIView): """ ç”¨äºŽèŽ·å–ã€æ›´æ–°æˆ–åˆ é™¤æ¨¡åž‹å®žä¾‹çš„å…·ä½“è§†å›¾ã€‚ """ def get(self, request, *args, **kwargs): return self.retrieve(request, *args, **kwargs) def put(self, request, *args, **kwargs): return self.update(request, *args, **kwargs) def patch(self, request, *args, **kwargs): return self.partial_update(request, *args, **kwargs) def delete(self, request, *args, **kwargs): return self.destroy(request, *args, **kwargs) è‡ªå®šä¹‰é€šç”¨è§†å›¾é€šå¸¸ä½ ä¼šæƒ³ä½¿ç”¨çŽ°æœ‰çš„é€šç”¨è§†å›¾ï¼Œç„¶åŽç¨å¾®å®šåˆ¶ä¸€ä¸‹è¡Œä¸ºã€‚å¦‚æžœæ‚¨å‘çŽ°è‡ªå·±åœ¨å¤šä¸ªåœ°æ–¹é‡å¤ä½¿ç”¨äº†ä¸€äº›è‡ªå®šä¹‰è¡Œä¸ºï¼Œåˆ™å¯èƒ½éœ€è¦å°†è¡Œä¸ºé‡æž„ä¸ºæ™®é€šç±»ï¼Œç„¶åŽæ ¹æ®éœ€è¦å°†å…¶åº”ç”¨äºŽä»»ä½•è§†å›¾æˆ–è§†å›¾é›†ã€‚ åˆ›å»ºé€šç”¨mixinsç±»ä¾‹å¦‚ï¼Œå¦‚æžœéœ€è¦æ ¹æ®URL confä¸­çš„å¤šä¸ªå­—æ®µæŸ¥æ‰¾å¯¹è±¡ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªmixinç±»ï¼Œå¦‚ä¸‹æ‰€ç¤º: 123456789101112131415class MultipleFieldLookupMixin(object): """ å°†æ­¤mixinåº”ç”¨äºŽä»»ä½•è§†å›¾æˆ–è§†å›¾é›†ï¼Œä»¥èŽ·å¾—å¤šä¸ªå­—æ®µç­›é€‰ åŸºäºŽ' lookup_fields 'å±žæ€§ï¼Œè€Œä¸æ˜¯é»˜è®¤çš„å•å­—æ®µè¿‡æ»¤ã€‚ """ def get_object(self): queryset = self.get_queryset() # èŽ·å–æŸ¥è¯¢é›† queryset = self.filter_queryset(queryset) # å¯¹æŸ¥è¯¢é›†è¿›è¡Œè¿‡æ»¤ filter = &#123;&#125; for field in self.lookup_fields: if self.kwargs[field]: # å¿½ç•¥ä¸å­˜åœ¨çš„è¿‡æ»¤å­—æ®µ filter[field] = self.kwargs[field] obj = get_object_or_404(queryset, **filter) # Lookup the object self.check_object_permissions(self.request, obj) return obj ç„¶åŽï¼Œæ‚¨å¯ä»¥åœ¨ä»»ä½•éœ€è¦åº”ç”¨è‡ªå®šä¹‰è¡Œä¸ºçš„æ—¶å€™å°†æ­¤mixinåº”ç”¨åˆ°è§†å›¾æˆ–è§†å›¾é›†ã€‚ 1234class RetrieveUserView(MultipleFieldLookupMixin, generics.RetrieveAPIView): queryset = User.objects.all() serializer_class = UserSerializer lookup_fields = ['account', 'username'] Note:å¦‚æžœæ‚¨æœ‰éœ€è¦ä½¿ç”¨çš„è‡ªå®šä¹‰è¡Œä¸ºï¼Œé‚£ä¹ˆä½¿ç”¨è‡ªå®šä¹‰mixinæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ åˆ›å»ºé€šç”¨ç±»è§†å›¾-custom base classeså¦‚æžœæ‚¨æ­£åœ¨è·¨å¤šä¸ªè§†å›¾ä½¿ç”¨mixinï¼Œæ‚¨å¯ä»¥æ›´è¿›ä¸€æ­¥ï¼Œåˆ›å»ºæ‚¨è‡ªå·±çš„ä¸€ç»„åŸºæœ¬è§†å›¾ï¼Œè¿™äº›è§†å›¾å¯ä»¥åœ¨æ•´ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨ã€‚ä¾‹å¦‚: 1234567class BaseRetrieveView(MultipleFieldLookupMixin, generics.RetrieveAPIView): passclass BaseRetrieveUpdateDestroyView(MultipleFieldLookupMixin, generics.RetrieveUpdateDestroyAPIView): pass Note:å¦‚æžœæ‚¨çš„è‡ªå®šä¹‰è¡Œä¸ºå§‹ç»ˆéœ€è¦åœ¨æ•´ä¸ªé¡¹ç›®çš„å¤§é‡è§†å›¾ä¸­é‡å¤ï¼Œé‚£ä¹ˆä½¿ç”¨è‡ªå®šä¹‰åŸºç±»æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚ ä»¥ä¸Šå†…å®¹æ¥è‡ª:Django-Rest-Frameworkå®˜æ–¹æŒ‡å—ç¿»è¯‘åŠ ä¸Šè‡ªå·±çš„ä¸€äº›ç†è§£]]></content>
      <categories>
        <category>Django-Rest-Framework</category>
      </categories>
      <tags>
        <tag>GenericViews</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DRF-Request-Response]]></title>
    <url>%2F2019%2F07%2F17%2FDRF-Request-Response%2F</url>
    <content type="text"><![CDATA[If you&#39;re doing REST-based web service stuff ... you should ignore request.POST. â€‹ â€” Malcom Tredinnick, Django developers group è¿™æ˜¯æ¥è‡ªDjangoå¼€å‘å›¢é˜Ÿæˆå‘˜çš„ä¸€å¥è¯,ç¿»è¯‘è¿‡æ¥å¤§æ¦‚æ„æ€å°±æ˜¯å¦‚æžœä½ æ­£åœ¨ä½¿ç”¨ Restæ¥å¼€å‘Webåº”ç”¨,ä½ åº”è¯¥å¿½ç•¥ä½¿ç”¨ request.POST. RequestRESTæ¡†æž¶çš„è¯·æ±‚ç±»æ‰©å±•äº† Djangoæ ‡å‡†çš„ HttpRequest,å¢žåŠ äº†å¯¹ RESTæ¡†æž¶çš„è¯·æ±‚è§£æžå’Œè¯·æ±‚èº«ä»½éªŒè¯æ”¯æŒ. Rquest parsing REST frameworkçš„è¯·æ±‚å¯¹è±¡æä¾›äº†çµæ´»çš„è¯·æ±‚è§£æž,èƒ½å¤Ÿå¤„ç† JSONæ•°æ®æˆ–è€…å…¶ä»–åª’ä½“ç±»åž‹çš„è¯·æ±‚,å’Œå¤„ç†è¡¨å•æ•°æ®ä¸€æ · DRF requestå¯¹è±¡äº§ç”Ÿçš„æºç  12345678910111213141516171819202122232425262728293031class APIView(View): pass def initialize_request(self, request, *args, **kwargs): """ request:åŽŸç”ŸDjangoçš„requestå‚æ•° è¿”å›žåˆå§‹è¯·æ±‚å¯¹è±¡ """ parser_context = self.get_parser_context(request) ''' æ ¹æ®Requestç±»å®žä¾‹åŒ–DRFè¯·æ±‚å¯¹è±¡ å‚æ•°ä»‹ç»: - request(HttpRequest). The original request instance. - parsers_classes(list/tuple). The parsers to use for parsing the request content. - authentication_classes(list/tuple). The authentications used to try authenticating the request's user. ''' return Request( request, # django åŽŸå§‹è¯·æ±‚(HttpRequest) parsers=self.get_parsers(), # è§£æžå™¨ç±» authenticators=self.get_authenticators(), # ç”¨æˆ·è®¤è¯æ–¹å¼åˆ—è¡¨/å…ƒç»„ negotiator=self.get_content_negotiator(), # å†…å®¹åå•†å¯¹è±¡åˆ—è¡¨/å…ƒç»„ parser_context=parser_context # ä»Ždjango çš„requestä¸­è§£æžçš„å†…å®¹ ) def dispatch(self, request, *args, **kwargs): """ APIViewçš„è¯·æ±‚è°ƒåº¦æ–¹æ³•åœ¨è°ƒç”¨å¤„ç†æ–¹æ³•ä¹‹å‰ä¼šè°ƒç”¨initialize_requestæ–¹æ³• ç”Ÿæˆrequestå¯¹è±¡ä½œä¸ºå‚æ•° """ request = self.initialize_request(request, *args, **kwargs) pass Requestç±» æºç  123456789101112131415161718192021222324252627282930313233# rest_framework/reqeust.py 143 lineclass Request(object): ...... @property def query_params(self): """ More semantically correct name for request.GET. """ return self._request.GET @property def data(self): if not _hasattr(self, '_full_data'): self._load_data_and_files() return self._full_data def _load_data_and_files(self): """ Parses the request content into `self.data`. """ if not _hasattr(self, '_data'): self._data, self._files = self._parse() if self._files: self._full_data = self._data.copy() self._full_data.update(self._files) else: self._full_data = self._data # if a form media type, copy data &amp; files refs to the underlying # http request so that closable objects are handled appropriately. if is_form_media_type(self.content_type): self._request._post = self.POST self._request._files = self.FILES ä»Žæºç ä¸­å¯ä»¥çœ‹å‡º,Requestç±»çš„å¯¹è±¡æœ‰ä¸¤ä¸ªæ–¹æ³•è¢« @propertyè£…é¥°å™¨è½¬æ¢ä¸ºå±žæ€§ .data åŒ…å«è§£æžä¹‹åŽçš„è¯·æ±‚ä½“æ•°æ®,å·²ç»è§£æžä¸ºå­—å…¸,ç›¸å½“äºŽ DjangoåŽŸç”Ÿçš„requestçš„ body/POST/FILESå±žæ€§ å®ƒæ”¯æŒè§£æžPOSTä¹‹å¤–çš„å…¶ä»–HTTPæ–¹æ³•çš„å†…å®¹,æ¯”å¦‚èŽ·å–PUT/PATCHçš„è¯·æ±‚å†…å®¹; .query_params query_paramsæ˜¯request.GETçš„æ›´æ­£ç¡®çš„åŒä¹‰è¯ ä¸»è¦å°±æ˜¯èŽ·å–è¯·æ±‚URLä¸­çš„æŸ¥è¯¢å­—ç¬¦ä¸²,ç›¸å½“äºŽåŽŸç”ŸDjangoçš„request.GETå±žæ€§ å®˜æ–¹ç»™å‡ºçš„è§£é‡Š 1234For clarity inside your code, we recommend using request.query_params instead of the Django's standard request.GET. Doing so will help keep your codebase more correct and obvious - any HTTP method type may include query parameters, not just GET requests.'''ä¸ºäº†ä½¿ä»£ç æ›´æ¸…æ™°ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨requestã€‚query_paramsè€Œä¸æ˜¯Djangoçš„æ ‡å‡†request.GETã€‚è¿™æ ·åšå°†æœ‰åŠ©äºŽä¿æŒä»£ç åº“æ›´åŠ æ­£ç¡®å’Œæ˜Žæ˜¾â€”â€”ä»»ä½•HTTPæ–¹æ³•ç±»åž‹éƒ½å¯èƒ½åŒ…å«æŸ¥è¯¢å‚æ•°ï¼Œè€Œä¸ä»…ä»…æ˜¯GETè¯·æ±‚ã€‚''' _parse è¯¥æ–¹æ³•ä¸»è¦æ˜¯ request.dataè°ƒç”¨äº† self._load_data_and_files(),ç„¶åŽ self._load_data_and_files()å†…éƒ¨åˆè°ƒç”¨äº† self._parse() è¯¥è§£æžæ–¹æ³•è¿”å›žä¸€ä¸ªäºŒå…ƒç»„(æ•°æ®, æ–‡ä»¶),å¦‚æžœè§£æžå¤±è´¥ä¼šå¼•å‘ä¸¤ç§å¼‚å¸¸: UnsupportedMediaTypeå’Œ ParseError å¦‚æžœå®¢æˆ·ç«¯å‘é€æ ¼å¼é”™è¯¯çš„å†…å®¹è®¿é—®è¯·æ±‚,ä¼šå¼•å‘ ParseError, RESTæ¡†æž¶ä¼šæ•èŽ·è¯¥å¼‚å¸¸å¹¶è¿”å›ž 400çŠ¶æ€ç å“åº” å¦‚æžœå®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚å…·æœ‰æ— æ³•è§£æžçš„ CONTENT_TYPEå†…å®¹ç±»åž‹,åˆ™ä¼šæ•èŽ· 415ä¸æ”¯æŒåª’ä½“ç±»åž‹çš„å“åº”. Content negotiationé€šè¿‡è¯·æ±‚æºå¸¦çš„ä¸€äº›å±žæ€§,å¯ä»¥ç¡®å®š content negotiationå†…å®¹åå•†çš„ç»“æžœ,å¯ä»¥ä¸ºä¸åŒçš„åª’ä½“ç±»åž‹é€‰æ‹©ä¸åŒçš„åºåˆ—åŒ–æ–¹æ¡ˆ. .accepted_renderer content negotiationä½¿ç”¨çš„æ¸²æŸ“å®žä¾‹ .accepted_media_type content negotiationå†…å®¹åå•†æŽ¥æ”¶çš„åª’ä½“ç±»åž‹content_type AuthenticastionRESTæ¡†æž¶æä¾›éžå¸¸çµæ´»çš„è¯·æ±‚èº«ä»½éªŒè¯ ä¸ºAPIçš„ä¸åŒéƒ¨åˆ†ä½¿ç”¨ä¸åŒçš„èº«ä»½éªŒè¯ç­–ç•¥ æ”¯æŒä½¿ç”¨å¤šä¸ªèº«ä»½éªŒè¯ç­–ç•¥ æä¾›ä¸Žä¼ å…¥è¯·æ±‚ç›¸å…³çš„ç”¨æˆ·userå’Œä»¤ç‰Œtokenä¿¡æ¯ .user request.useré€šå¸¸è¿”å›ž django.contrib.auth.modelsçš„å®žä¾‹,å¦‚æžœè¯·æ±‚æœªç»èº«ä»½éªŒè¯,åˆ™è¿”å›ž django.contrib.auth.models.AnonymousUseråŒ¿åç”¨æˆ·. æºç åˆ†æž 1234567891011class Request(object): @property def user(self): """ è¿”å›žä¸Žå½“å‰è¯·æ±‚å…³è”çš„ç”¨æˆ·(å·²é€šè¿‡èº«ä»½éªŒè¯) é€šè¿‡å‘è¯·æ±‚æä¾›çš„èº«ä»½éªŒè¯ç±»ã€‚ """ if not hasattr(self, '_user'): with wrap_attributeerrors(): self._authenticate() return self._user .authenticatorsè¯¥å±žæ€§æ˜¯å®žä¾‹åŒ–DRFè¯·æ±‚å¯¹è±¡æ—¶ä¼ å…¥çš„,ä¸»è¦é€šè¿‡ self.get_authenticators()æ¥èŽ·å–çš„è®¤è¯å¯¹è±¡åˆ—è¡¨ 12345678910111213def initialize_request(self, request, *args, **kwargs): """ Returns the initial request object. """ parser_context = self.get_parser_context(request) return Request( request, parsers=self.get_parsers(), authenticators=self.get_authenticators(), # åˆ›å»ºrequestå¯¹è±¡ä¼ å…¥å¯¹è±¡è®¤è¯ç±»åˆ—è¡¨ negotiator=self.get_content_negotiator(), parser_context=parser_context ) 12345678910111213141516class Request(object): """ DRF requestç±»æºç  """ def __init__(self, request, parsers=None, authenticators=None, negotiator=None, parser_context=None): assert isinstance(request, HttpRequest), ( 'The `request` argument must be an instance of ' '`django.http.HttpRequest`, not `&#123;&#125;.&#123;&#125;`.' .format(request.__class__.__module__, request.__class__.__name__) ) self._request = request self.parsers = parsers or () self.authenticators = authenticators or () # requestå¯¹è±¡åˆå§‹åŒ–ç»™authenticatorsèµ‹å€¼ response ä»‹ç»:Responseå¯¹è±¡ä¼šæ ¹æ®å®¢æˆ·ç«¯è¯·æ±‚å¤´çš„ Accept,è‡ªåŠ¨è½¬æ¢ä¸ºå¯¹åº”çš„æ ¼å¼,å¹¶è¿›è¡Œè¿”å›ž è¯·æ±‚å¤´1: application/json æœåŠ¡å™¨ä¼šå°†å“åº”æ•°æ®è½¬ä¸ºjsonæ•°æ®è¿›è¡Œè¿”å›ž(æ²¡æŒ‡å®šæ—¶,é»˜è®¤è¿”å›žJSON) è¯·æ±‚å¤´2:text/html æœåŠ¡å™¨ä¼šå°†å“åº”æ•°æ®è½¬æ¢ä¸ºHTMLæ ¼å¼è¿”å›ž åˆ›å»ºå“åº”å¯¹è±¡æ ¼å¼: Response(data, status=None, template_name=None, headers=None, content_type=None) DRFä¸Žå¸¸è§„çš„ HttpResponseå¯¹è±¡ä¸åŒ,ä¸éœ€è¦ä½¿ç”¨rendered contentåŽ»å®žä¾‹åŒ–å“åº”å¯¹è±¡,è€Œæ˜¯ä¼ å…¥åŽŸç”Ÿçš„Pythonæ ¼å¼æ•°æ®.å½“ç„¶ Responseä¸èƒ½åŽ»å¤„ç†å¤æ‚çš„æ•°æ®ç±»åž‹,æ¯”å¦‚Djangoæ¨¡åž‹çš„å®žä¾‹å¯¹è±¡instance,å› æ­¤éœ€è¦å†åˆ›å»ºå“åº”å¯¹è±¡ä¹‹å‰å°†æ•°æ®åºåˆ—åŒ–ä¸ºåŸºæœ¬çš„Pythonæ•°æ®ç±»åž‹(å­—å…¸\åˆ—è¡¨).å½“ç„¶ä½ å¯ä»¥ä½¿ç”¨REST frameworkçš„åºåˆ—åŒ–å™¨ç±»æ¥æ‰§è¡Œæ­¤æ•°æ®åºåˆ—åŒ–ï¼Œæˆ–è€…ä½¿ç”¨æ‚¨è‡ªå·±çš„è‡ªå®šä¹‰åºåˆ—åŒ–ã€‚ å‚æ•°ä»‹ç»: data:å“åº”çš„åºåˆ—åŒ–æ•°æ® status:å“åº”çš„çŠ¶æ€ç ,é»˜è®¤æ˜¯200 template_name:é€‰æ‹©HTMLRendereræ—¶è¦ä½¿ç”¨çš„æ¨¡æ¿åç§°ã€‚ headers:å“åº”å¤´,å­—å…¸æ ¼å¼ content_type:å“åº”å†…å®¹æ ¼å¼ç±»åž‹,é€šå¸¸è¿™ä¸ªä¸ç”¨å†™,ç”±æ¸²æŸ“å™¨renderæ ¹æ® content negotiationå†…å®¹åå•†è‡ªåŠ¨è®¾ç½®,ä½†åœ¨æŸäº›æƒ…å†µä½ å¯èƒ½éœ€è¦æ‰‹åŠ¨åŽ»è¿›è¡Œè®¾ç½®.]]></content>
      <categories>
        <category>Django-Rest-Framework</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[DRF-APIView&æºç åˆ†æž]]></title>
    <url>%2F2019%2F07%2F14%2FDRF-APIView-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[DjangoRestFrameworkä¸ºäº†æ–¹ä¾¿è¿›è¡Œè§†å›¾ç¼–å†™,RESTæ¡†æž¶æä¾›äº†ä¸€ä¸ªAPIViewç±»ï¼Œå®ƒç»§æ‰¿äº†Djangoçš„Viewç±»ã€‚æŽ¥ä¸‹æ¥å…·ä½“ä»‹ç»ä¸€ä¸‹APIViewéƒ½åšäº†å“ªäº›è¿›ä¸€æ­¥å°è£… APIView VS ViewAPIViewç±»ä¸ŽDjangoåŽŸå§‹çš„Viewçš„ä¸åŒä¹‹å¤„åœ¨äºŽ: ä¼ é€’ç»™ç±»è§†å›¾å¤„ç†æ–¹æ³•çš„requestå‚æ•°æ˜¯ RESTæ¡†æž¶çš„è¯·æ±‚å®žä¾‹,è€Œä¸æ˜¯ Djangoçš„ HttpRequestå®žä¾‹; å¤„ç†ç±»è§†å›¾å“åº”ä½¿ç”¨çš„æ˜¯RESTæ¡†æž¶çš„å“åº”Response,è€Œä¸æ˜¯ Djangoçš„ HttpResponse,ç±»è§†å›¾é…ç½®å†…å®¹åå•†content_negotiation_classå¹¶åœ¨å“åº”ä¸Šè®¾ç½®å¯¹åº”çš„æ¸²æŸ“å™¨renderer_classes; ä»»ä½•APIExceptionå¼‚å¸¸éƒ½å°†è¢«æ•èŽ·å¹¶è°ƒè§£ä¸ºé€‚å½“çš„å“åº”ã€‚ ä¼ å…¥çš„è¯·æ±‚å°†ç»è¿‡èº«ä»½è®¤è¯ï¼Œå¹¶åœ¨å°†è¯·æ±‚å‘é€åˆ°å¤„ç†ç¨‹åºæ–¹æ³•ä¹‹å‰è¿è¡Œé€‚å½“çš„æƒé™å’Œåˆ†æµæ£€æŸ¥ã€‚ ä½¿ç”¨APIVIewç±»ä¸Žä½¿ç”¨å¸¸è§„è§†å›¾ç±»VIewéžå¸¸ç›¸ä¼¼,é€šè¿‡ä¼ å…¥çš„è¯·æ±‚è¢«åˆ†æ´¾åˆ°é€‚å½“çš„å¤„ç†ç¨‹åºæ–¹æ³•,å¸¸ç”¨çš„æœ‰:get/post/delete/put. æ¡ˆä¾‹:For example1234567891011121314151617181920212223from rest_framework.views import APIViewfrom rest_framework.response import Responsefrom rest_framework import authentication, permissionsfrom django.contrib.auth.models import Userclass ListUsers(APIView): """ View to list all users in the system. * Requires token authentication. * Only admin users are able to access this view. """ # é…ç½®Tokenè®¤è¯,é»˜è®¤çš„å…¨å±€é…æ˜¯SessionAuthentication/BasicAuthentication authentication_classes = (authentication.TokenAuthentication,) # æƒé™åªæœ‰ç®¡ç†å‘˜ç”¨æˆ·æ‰èƒ½ç™»é™†,è¿˜æœ‰å…¶ä»–(AllowAny/IsAuthenticated/IsAuthenticastedOrReadOnlyç­‰ç­‰) permission_classes = (permissions.IsAdminUser,) def get(self, request, format=None): """ Return a list of all users. """ usernames = [user.username for user in User.objects.all()] return Response(usernames) ç±»å±žæ€§ç›¸å…³é…ç½®123456789101112131415161718# å¯¼å…¥DRFé»˜è®¤çš„é…ç½® æºç ä½ç½®`/lib/python3.7/site-packages/rest_framework/views.py` 102 linefrom rest_framework.settings import api_settingsclass APIView(View): '''ç±»è§†å›¾ç›¸å…³çš„ä¸€äº›é…ç½®,å¯ä»¥ä»Žå…¨å±€å½“ä¸­èŽ·å–ä¹Ÿå¯ä»¥é€šè¿‡é‡å†™ç±»å±žæ€§æ¥å®žçŽ°''' renderer_classes = api_settings.DEFAULT_RENDERER_CLASSES # æ¸²æŸ“å™¨ç±» parser_classes = api_settings.DEFAULT_PARSER_CLASSES # è§£æžå™¨ç±» authentication_classes = api_settings.DEFAULT_AUTHENTICATION_CLASSES # è®¤è¯å™¨ç±» throttle_classes = api_settings.DEFAULT_THROTTLE_CLASSES # åˆ†æµå™¨ç±» permission_classes = api_settings.DEFAULT_PERMISSION_CLASSES # æƒé™å™¨ç±» content_negotiation_class = api_settings.DEFAULT_CONTENT_NEGOTIATION_CLASS # å†…å®¹åå•† metadata_class = api_settings.DEFAULT_METADATA_CLASS # å“åº”æ ¼å¼ç±» versioning_class = api_settings.DEFAULT_VERSIONING_CLASS # APIç‰ˆæœ¬æŽ§åˆ¶ç±» # Allow dependency injection of other settings to make testing easier. settings = api_settings # é…ç½®æ–‡ä»¶ schema = DefaultSchema() # APIæµ‹è¯•ä¸»é¢˜ ä»¥ä¸‹å±žæ€§æŽ§åˆ¶APIè§†å›¾çš„å¯æ’å…¥æ–¹é¢ã€‚ã€‚ renderer_classes parser_classes authenticastion_classes throttle_classes permission_classes content_negotiation_class å†…ç½®æ–¹æ³•RESTæ¡†æž¶ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•å®žä¾‹åŒ–å„ç§å¯æ’å…¥çš„APIæ–¹æ³•ã€‚é€šå¸¸ä¸éœ€è¦è¦†ç›–è¿™äº›æ–¹æ³•ã€‚ get_renderers(self) get_parsers(self) get_authenticators(self) get_throttles(self) get_permissions(self) get_content_negotiator(self) get_exception_handler(self) 123456789101112131415161718192021222324252627282930313233343536373839404142434445# API policy instantiation methods# APIç­–ç•¥å®žä¾‹åŒ–æ–¹æ³•def get_renderers(self): """ å®žä¾‹åŒ–å¹¶è¿”å›žæ­¤è§†å›¾å¯ä»¥ä½¿ç”¨çš„æ¸²æŸ“å™¨åˆ—è¡¨ã€‚ """ return [renderer() for renderer in self.renderer_classes]def get_parsers(self): """ å®žä¾‹åŒ–å¹¶è¿”å›žæ­¤è§†å›¾å¯ä»¥ä½¿ç”¨çš„è§£æžå™¨åˆ—è¡¨ã€‚ """ return [parser() for parser in self.parser_classes]def get_authenticators(self): """ å®žä¾‹åŒ–å¹¶è¿”å›žæ­¤è§†å›¾å¯ä»¥ä½¿ç”¨çš„è®¤è¯å™¨åˆ—è¡¨ã€‚ """ return [auth() for auth in self.authentication_classes]def get_permissions(self): """ å®žä¾‹åŒ–å¹¶è¿”å›žæ­¤è§†å›¾æ‰€éœ€çš„æƒé™åˆ—è¡¨ã€‚ """ return [permission() for permission in self.permission_classes]def get_throttles(self): """ å®žä¾‹åŒ–å¹¶è¿”å›žæ­¤è§†å›¾ä½¿ç”¨çš„åˆ†æµå™¨åˆ—è¡¨ã€‚ """ return [throttle() for throttle in self.throttle_classes]def get_content_negotiator(self): """ å®žä¾‹åŒ–å¹¶è¿”å›žè¦ä½¿ç”¨çš„å†…å®¹åå•†ç±»ã€‚ """ if not getattr(self, '_negotiator', None): self._negotiator = self.content_negotiation_class() return self._negotiatordef get_exception_handler(self): """ è¿”å›žæ­¤è§†å›¾ä½¿ç”¨çš„å¼‚å¸¸å¤„ç†ç¨‹åºã€‚ """ return self.settings.EXCEPTION_HANDLER APIç­–ç•¥å®žçŽ°æ–¹æ³• åœ¨è¯·æ±‚åˆ†æ´¾åˆ°å¤„ç†ç¨‹åºæ–¹æ³•ä¹‹å‰ï¼Œå°†è°ƒç”¨ä»¥ä¸‹æ–¹æ³•ã€‚ check_permissions(self, reqeust) check_throttles(self, request) perform_content_negotiation(self, request,force=False) 12345678910111213141516171819202122232425262728293031323334353637383940414243444546# API policy implementation methodsdef perform_content_negotiation(self, request, force=False): """ ç¡®å®šè¦ä½¿ç”¨å“ªç§å‘ˆçŽ°å™¨å’Œåª’ä½“ç±»åž‹æ¥å‘ˆçŽ°å“åº”ã€‚ """ renderers = self.get_renderers() conneg = self.get_content_negotiator() try: return conneg.select_renderer(request, renderers, self.format_kwarg) except Exception: if force: return (renderers[0], renderers[0].media_type) raise def check_permissions(self, request): """ æ£€æŸ¥è¯¥è¯·æ±‚æ˜¯å¦åº”è¯¥è¢«å…è®¸ã€‚ å¦‚æžœè¯·æ±‚ä¸è¢«å…è®¸ï¼Œåˆ™æŠ›å‡ºé€‚å½“çš„å¼‚å¸¸ã€‚ """ for permission in self.get_permissions(): if not permission.has_permission(request, self): self.permission_denied( request, message=getattr(permission, 'message', None) )def check_object_permissions(self, request, obj): """ æ£€æŸ¥æ˜¯å¦åº”è¯¥å…è®¸ç»™å®šå¯¹è±¡çš„è¯·æ±‚ã€‚ å¦‚æžœè¯·æ±‚ä¸è¢«å…è®¸ï¼Œåˆ™æŠ›å‡ºé€‚å½“çš„å¼‚å¸¸ã€‚ """ for permission in self.get_permissions(): if not permission.has_object_permission(request, self, obj): self.permission_denied( request, message=getattr(permission, 'message', None) )def check_throttles(self, request): """ æ£€æŸ¥è¯·æ±‚æ˜¯å¦åº”è¯¥è¢«åˆ†æµã€‚ å¦‚æžœè¯·æ±‚è¢«åˆ†æµï¼Œåˆ™å¼•å‘é€‚å½“çš„å¼‚å¸¸ã€‚ """ for throttle in self.get_throttles(): if not throttle.allow_request(request, self): self.throttled(request, throttle.wait()) è°ƒåº¦æ–¹æ³•è§†å›¾çš„dispatch()æ–¹æ³•ç›´æŽ¥è°ƒç”¨ä»¥ä¸‹æ–¹æ³•,è¿™äº›å‡½æ•°æ‰§è¡Œåœ¨è°ƒç”¨ get(),post(),put(),patch(),delete()ç­‰å¤„ç†ç¨‹åºæ–¹æ³•ä¹‹å‰æˆ–ä¹‹åŽéœ€è¦æ‰§è¡Œçš„ä»»ä½•æ“ä½œ .initial(self,request, *args, **kwargs) åœ¨æ‰§è¡Œè°ƒç”¨å¤„ç†ç¨‹åºæ–¹æ³•ä¹‹å‰éœ€è¦æ‰§è¡Œçš„æ“ä½œã€‚æ­¤æ–¹æ³•ç”¨äºŽæ‰§è¡Œæƒé™å’ŒèŠ‚æµï¼Œä»¥åŠå†…å®¹åå•†ã€‚ .handle_exception(self, exc) è§†å›¾ç±»å½“ä¸­çš„ç¨‹åºå¤„ç†æ–¹æ³•æŠ›å‡ºçš„ä»»ä½•å¼‚å¸¸éƒ½å°†ä¼ é€’ç»™è¯¥æ–¹æ³•,è¯¥æ–¹æ³•è¦ä¹ˆè¿”å›žå“åº”å®žä¾‹,è¦ä¹ˆé‡æ–°å¼•å‘å¼‚å¸¸ é»˜è®¤å®žçŽ°å¤„ç† rest_framework.exceptionçš„ä»»ä½•å­ç±», APIExceptionä»¥åŠDjangoçš„ Http404å’Œ PermissionDeniedå¼‚å¸¸å¹¶è¿”å›žä¸€ä¸ªé€‚å½“çš„é”™è¯¯å“åº”. å¦‚æžœéœ€è¦è‡ªå®šä¹‰APIè¿”å›žçš„é”™è¯¯å“åº”,å¯ä»¥é‡å†™è¯¥æ–¹æ³• .initialize_request(self, request, *args, **kwargs) ä¿è¯ä¼ é€’ç»™ç±»è§†å›¾å¤„ç†ç¨‹åºæ–¹æ³•çš„è¯·æ±‚å¯¹è±¡æ˜¯DRFè¯·æ±‚çš„å®žä¾‹ï¼Œè€Œä¸æ˜¯é€šå¸¸çš„Django HttpRequestã€‚ .finalize_response(self, request, response, *args, **kwargs) ç¡®ä¿ä»Žå¤„ç†ç¨‹åºæ–¹æ³•è¿”å›žçš„ä»»ä½•å“åº”å¯¹è±¡éƒ½å°†å‘ˆçŽ°ä¸ºæ­£ç¡®çš„å†…å®¹ç±»åž‹(ç”±å†…å®¹åå•†å†³å®š)ã€‚ ç±»æ–¹æ³•å¤„ç†è¯·æ±‚è¿‡ç¨‹åˆ†æž as_view() è°ƒç”¨çˆ¶ç±»VIewçš„as_view()æ–¹æ³•,è¿”å›žçˆ¶ç±»Viewæ–¹æ³•å†…éƒ¨çš„é—­åŒ…å‡½æ•°view 1234567891011@classmethod def as_view(cls, **initkwargs): ....... # è°ƒç”¨çˆ¶ç±»çš„as_view()æ–¹æ³•,è¿”å›žçˆ¶ç±»çš„å†…éƒ¨å‡½æ•°çš„å¼•ç”¨ view = super(APIView, cls).as_view(**initkwargs) view.cls = cls view.initkwargs = initkwargs # Note: session based authentication is explicitly CSRF validated, # all other authentication is CSRF exempt. return csrf_exempt(view) viewæ–¹æ³•çš„æºç  æœ€åŽè°ƒç”¨äº† selfçš„dispatchæ–¹æ³•,è¿™é‡Œéœ€è¦åˆ†æžä¸€ä¸‹dispatchæ–¹æ³•ä»Žå“ªé‡Œæ¥? 123456789def view(request, *args, **kwargs): self = cls(**initkwargs) # ç±»è§†å›¾å®žä¾‹åŒ–ä¸ºå¯¹è±¡ if hasattr(self, 'get') and not hasattr(self, 'head'): self.head = self.get self.request = request self.args = args self.kwargs = kwargs # è°ƒç”¨å½“å‰ç±»è§†å›¾å¯¹è±¡çš„dispatchæ–¹æ³• return self.dispatch(request, *args, **kwargs) éœ€è¦æ³¨æ„çš„æ˜¯Python3ç»§æ‰¿çš„é¡ºåºæ˜¯å¹¿åº¦ä¼˜å…ˆ,è°ƒç”¨å±žæ€§oræ–¹æ³•æ—¶,å…ˆä»Žè‡ªå·±æ‰¾,å†ä»Žå·¦åˆ°å³çš„çˆ¶ç±»æŸ¥æ‰¾,æ²¡æœ‰å†åŽ»çˆ¶ç±»çš„çˆ¶ç±»â€¦. APIViewå’Œ Viewä¸­éƒ½æœ‰ dispatchæ–¹æ³•,ä½†æ˜¯APIViewæŸ¥æ‰¾é¡ºåºè¿‘,æ‰€ä»¥ä¼šå…ˆè°ƒç”¨APIViewçš„dispatchæ–¹æ³• APIView--&gt;dispatch()è¯·æ±‚è°ƒåº¦è¿‡ç¨‹ 1234567891011121314151617181920212223242526272829303132333435363738394041# Viewç±»è§†å›¾å®šä¹‰çš„HTTPè¯·æ±‚æ–¹æ³•åˆ—è¡¨ django/views/generic/base.py 34 linehttp_method_names = ['get', 'post', 'put', 'patch', 'delete', 'head', 'options', 'trace']class APIView(View): ...... # APIViewç±»è§†å›¾çš„dispatchæ–¹æ³• restframework/views.py 470 line def dispatch(self, request, *args, **kwargs): """ # LQå’ŒDjangoåŽŸç”Ÿçš„dispatch()æ–¹æ³•ç±»ä¼¼,ä½†æ˜¯é¢å¤–å¤šäº†ä¸€äº›å†…å®¹ å¼‚å¸¸æ•èŽ·\è¯·æ±‚å¯¹è±¡çš„è¿›ä¸€æ­¥å°è£…å’Œåˆå§‹åŒ–\é¢å¤–çš„æ£€æŸ¥ """ self.args = args self.kwargs = kwargs # æ ¹æ®åŽŸç”ŸDjangoå°è£…çš„requestå¯¹è±¡äº§ç”Ÿæ–°çš„è¯·æ±‚å¯¹è±¡(DRFçš„request) request = self.initialize_request(request, *args, **kwargs) self.request = request self.headers = self.default_response_headers # deprecate? try: ''' # LQ:åœ¨è¿è¡Œå¤„ç†è¯·æ±‚çš„æ–¹æ³•ä¹‹å‰,éœ€è¦è¿›è¡Œä¸€äº›æ£€æŸ¥: å†…å®¹åå•†/ç‰ˆæœ¬æŽ§åˆ¶/è®¤è¯/æƒé™/é™æµ/ç­‰ç­‰ ''' self.initial(request, *args, **kwargs) # é€šè¿‡è¯·æ±‚å¯¹è±¡çš„HTTPè¯·æ±‚æ–¹æ³•,èŽ·å–ç±»è§†å›¾ä¸­å¯¹åº”çš„å¤„ç†æ–¹æ³• if request.method.lower() in self.http_method_names: handler = getattr(self, request.method.lower(), self.http_method_not_allowed) else: handler = self.http_method_not_allowed # è°ƒç”¨å¤„ç†æ–¹æ³•,èŽ·å–å“åº” response = handler(request, *args, **kwargs) except Exception as exc: # å¼‚å¸¸å¤„ç†,å…·ä½“å¯ä»¥å‚è€ƒæˆ‘å†™çš„å¼‚å¸¸å¤„ç†æ–‡ç«  response = self.handle_exception(exc) # å¯¹å“åº”å¯¹è±¡è¿›ä¸€æ­¥æ£€æŸ¥,å°è£… self.response = self.finalize_response(request, response, *args, **kwargs) # è¿”å›žå“åº” return self.response DRFå‡½æ•°è§†å›¾RESTæ¡†æž¶è¿˜å…è®¸æ‚¨ä½¿ç”¨åŸºäºŽå¸¸è§„å‡½æ•°çš„è§†å›¾ã€‚å®ƒæä¾›äº†ä¸€ç»„ç®€å•çš„è£…é¥°å™¨ï¼Œè¿™äº›è£…é¥°å™¨åŒ…è£…åŸºäºŽå‡½æ•°çš„è§†å›¾ï¼Œä»¥ç¡®ä¿å®ƒä»¬æŽ¥æ”¶åˆ°è¯·æ±‚çš„å®žä¾‹(è€Œä¸æ˜¯é€šå¸¸çš„Django HttpRequest)ï¼Œå¹¶å…è®¸å®ƒä»¬è¿”å›žå“åº”(è€Œä¸æ˜¯Django HttpResponse)ï¼Œå¹¶å…è®¸æ‚¨é…ç½®å¦‚ä½•å¤„ç†è¯·æ±‚ã€‚ @api_view()Signature: @api_view(http_method_names=[&#39;GET&#39;]) è¯¥åŠŸèƒ½çš„æ ¸å¿ƒæ˜¯api_viewè£…é¥°å™¨ï¼Œå®ƒæŽ¥å—è§†å›¾åº”è¯¥å“åº”çš„HTTPæ–¹æ³•åˆ—è¡¨ã€‚ä¾‹å¦‚ï¼Œè¿™æ˜¯ä½ å¦‚ä½•å†™ä¸€ä¸ªéžå¸¸ç®€å•çš„è§†å›¾ï¼Œåªæ˜¯æ‰‹åŠ¨è¿”å›žä¸€äº›æ•°æ®: 12345from rest_framework.decorators import api_view@api_view()def hello_world(request): return Response(&#123;"message": "Hello, world!"&#125;) æ­¤è§†å›¾å°†ä½¿ç”¨è®¾ç½®ä¸­æŒ‡å®šçš„é»˜è®¤å‘ˆçŽ°å™¨ã€è§£æžå™¨ã€èº«ä»½éªŒè¯ç±»ç­‰ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒåªæŽ¥å—GETæ–¹æ³•ã€‚å…¶ä»–æ–¹æ³•å°†å“åº”â€œ405æ–¹æ³•ä¸å…è®¸â€ã€‚è¦æ›´æ”¹æ­¤è¡Œä¸ºï¼Œè¯·æŒ‡å®šè§†å›¾å…è®¸å“ªäº›æ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤º: 12345@api_view(['GET', 'POST'])def hello_world(request): if request.method == 'POST': return Response(&#123;"message": "Got some data!", "data": request.data&#125;) return Response(&#123;"message": "Hello, world!"&#125;) APIè£…é¥°å™¨ä¸ºäº†è¦†ç›–é»˜è®¤è®¾ç½®ï¼ŒRESTæ¡†æž¶æä¾›äº†ä¸€ç»„é¢å¤–çš„è£…é¥°å™¨ï¼Œå¯ä»¥å°†å®ƒä»¬æ·»åŠ åˆ°è§†å›¾ä¸­ã€‚è¿™äº›å¿…é¡»åœ¨@api_viewè£…é¥°å™¨ä¹‹åŽã€‚ä¾‹å¦‚ï¼Œè¦åˆ›å»ºä½¿ç”¨èŠ‚æµçš„è§†å›¾ï¼Œä»¥ç¡®ä¿ç‰¹å®šç”¨æˆ·æ¯å¤©åªèƒ½è°ƒç”¨å®ƒä¸€æ¬¡ï¼Œå¯ä»¥ä½¿ç”¨@throttle_classesè£…é¥°å™¨ï¼Œä¼ é€’èŠ‚æµç±»çš„åˆ—è¡¨: 12345678910111213from rest_framework.decorators import api_view, throttle_classesfrom rest_framework.throttling import UserRateThrottleclass OncePerDayUserThrottle(UserRateThrottle): ''' è‡ªå®šä¹‰é™æµå™¨ç±» ''' rate = '1/day'@api_view(['GET'])@throttle_classes([OncePerDayUserThrottle])def view(request): return Response(&#123;"message": "Hello for today! See you tomorrow!"&#125;) è¿™äº›è£…é¥°å™¨å¯¹åº”äºŽä¸Šé¢çš„APIViewå­ç±»ä¸Šè®¾ç½®çš„å±žæ€§ @renderer_classes(...) @parser_classes(...) @authentication_classes(...) @throttle_classes(...) @permission_classes(...) è¿™äº›è£…é¥°å™¨éƒ½æŽ¥å—ä¸€ä¸ªå‚æ•°ï¼Œè¯¥å‚æ•°å¿…é¡»æ˜¯ç±»çš„åˆ—è¡¨æˆ–å…ƒç»„ã€‚ å‚è€ƒæ–‡æ¡£]]></content>
      <categories>
        <category>Django-Rest-Framework</category>
      </categories>
      <tags>
        <tag>APIView</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åè®®ä¹‹WSGI]]></title>
    <url>%2F2019%2F07%2F10%2F%E5%8D%8F%E8%AE%AE%E4%B9%8BWSGI%2F</url>
    <content type="text"><![CDATA[ç®€ä»‹Python Webå¼€å‘ä¸­,åŽå°æœåŠ¡ç«¯ç¨‹åºå¯ä»¥åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†,1.æ˜¯æœåŠ¡å™¨ç¨‹åº 2.æ˜¯åº”ç”¨ç¨‹åº.æœåŠ¡å™¨é€šå¸¸æ˜¯TCPæœåŠ¡å™¨,è´Ÿè´£å¤„ç†æ¥è‡ªå®¢æˆ·ç«¯(ä¸€èˆ¬éƒ½æ˜¯æµè§ˆå™¨/APP)è¯·æ±‚çš„æ•´ç†/åˆ†å‘/å“åº”.2.åŽè€…è´Ÿè´£å…·ä½“çš„é€»è¾‘å¤„ç†.è¿™æ—¶å€™ä¸ºäº†æ–¹ä¾¿åº”ç”¨ç¨‹åºçš„å¼€å‘,æˆ‘ä»¬æŠŠå¸¸ç”¨çš„åŠŸèƒ½å°è£…èµ·æ¥,æˆä¸ºå„ç§Webå¼€å‘æ¡†æž¶,Django/Flask/Tornado.ä¸åŒçš„æ¡†æž¶æœ‰ä¸åŒçš„å¼€å‘æ–¹å¼,ä½†æ˜¯å¼€å‘å‡ºæ¥çš„åº”ç”¨ç¨‹åºéƒ½éœ€è¦å’ŒæœåŠ¡å™¨ç¨‹åºé…åˆ,æ‰èƒ½ç®—æ˜¯å®Œæ•´çš„åŽå°æœåŠ¡. å¦‚æžœæœåŠ¡å™¨ç¨‹åºå’Œåº”ç”¨ç¨‹åºä¹‹é—´æ²¡æœ‰æ ‡å‡†çš„åè®®,æˆ‘ä»¬åœ¨å¼€å‘ä¸€å¥—åº”ç”¨ç¨‹åºçš„æ—¶å€™æ˜¯ä¸æ˜¯è¦é’ˆå¯¹æŸä¸ªå…·ä½“çš„æœåŠ¡å™¨ç¨‹åºæ¥å†™,è€Œä¸èƒ½éšä¾¿æ¥å†™.è¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦è§„å®šå‡ºä¸€å¥—ç‰¹å®šåè®®,å°†åº”ç”¨ç¨‹åºå’ŒæœåŠ¡å™¨ç¨‹åºè§£è€¦å‡ºæ¥.è€Œ WSGIå°±æ˜¯è¿™ä¸ªä½œç”¨.Python Webå¼€å‘ä¸­,è¿™å¥—æ ‡å‡†åè®®å°±æ˜¯ The Web Server Gateway Interface,å³ WSGI,è¿™å¥—æ ‡å‡†åœ¨å®˜æ–¹çš„ PEP 333ä¸­æè¿°. WSGIå…·ä½“æ˜¯ä»€ä¹ˆ?WSGIæ˜¯æœåŠ¡å™¨ç¨‹åºä¸Žåº”ç”¨ç¨‹åºçš„ä¸€ä¸ªçº¦å®š,å®ƒè§„å®šäº†åŒæ–¹å„è‡ªéœ€è¦å®žçŽ°ä»€ä¹ˆæŽ¥å£,æä¾›äº†ä»€ä¹ˆåŠŸèƒ½,ä»¥ä¾¿äºŒè€…èƒ½å¤Ÿé…åˆä½¿ç”¨.WSGI ä¸èƒ½è§„å®šçš„å¤ªå¤æ‚ï¼Œå¦åˆ™å¯¹å·²æœ‰çš„æœåŠ¡å™¨æ¥è¯´ï¼Œå®žçŽ°èµ·æ¥ä¼šå›°éš¾ï¼Œä¸åˆ©äºŽWSGIçš„æ™®åŠã€‚åŒæ—¶WSGIä¹Ÿä¸èƒ½è§„å®šçš„å¤ªå¤šï¼Œä¾‹å¦‚cookieå¤„ç†å°±æ²¡æœ‰åœ¨WSGIä¸­è§„å®šï¼Œè¿™æ˜¯ä¸ºäº†ç»™æ¡†æž¶æœ€å¤§çš„çµæ´»æ€§ã€‚è¦çŸ¥é“WSGIæœ€ç»ˆçš„ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿æœåŠ¡å™¨ä¸Žåº”ç”¨ç¨‹åºé…åˆä½¿ç”¨ï¼Œè€Œä¸æ˜¯æˆä¸ºä¸€ä¸ªWebæ¡†æž¶çš„æ ‡å‡†ã€‚ WSGI-åº”ç”¨ç¨‹åºWSGIè§„å®š: 1.åº”ç”¨ç¨‹åºéœ€è¦æ˜¯ä¸€ä¸ªå¯è°ƒç”¨çš„å¯¹è±¡ æˆ‘ä»¬çœ‹ä¸‹å®˜æ–¹æ–‡æ¡£ç»™å‡ºçš„å®šä¹‰ 12345678910111213141516171819202122232425262728293031323334353637383940HELLO_WORLD = b"Hello world!\n"# callable functiondef simple_app(environ, start_response): """Simplest possible application object""" status = '200 OK' response_headers = [('Content-type', 'text/plain')] start_response(status, response_headers) return [HELLO_WORLD]# callable classclass AppClass: """Produce the same output, but using a class (Note: 'AppClass' is the "application" here, so calling it returns an instance of 'AppClass', which is then the iterable return value of the "application callable" as required by the spec. If we wanted to use *instances* of 'AppClass' as application objects instead, we would have to implement a '__call__' method, which would be invoked to execute the application, and we would need to create an instance for use by the server or gateway. """ def __init__(self, environ, start_response): self.environ = environ self.start = start_response def __iter__(self): status = '200 OK' response_headers = [('Content-type', 'text/plain')] self.start(status, response_headers) yield HELLO_WORLD# callable objectclass ApplicationObj(object): def __call__(self, environ, start_response): return [HELL_WORLD] ç¿»è¯‘è¿‡æ¥å°±æ˜¯: åº”ç”¨ç¨‹åºå¯ä»¥æ˜¯å‡½æ•° å¯ä»¥æ˜¯ä¸€ä¸ª instanceå®žä¾‹,å®žä¾‹çš„ç±»éœ€è¦å®žçŽ° __call__æ–¹æ³• å¯ä»¥æ˜¯ä¸€ä¸ª Classç±»,å†…éƒ¨å®žçŽ°äº† __iter__æ–¹æ³•. åŒæ—¶, WSGIè§„å®š 2.å¯è°ƒç”¨å¯¹è±¡éœ€è¦æŽ¥æ”¶ä¸¤ä¸ªå‚æ•° environå’Œ start_response 3.å¯è°ƒç”¨å¯¹è±¡è¦è¿”å›žä¸€ä¸ªå€¼,è¿™ä¸ªå€¼æ˜¯å¯è¿­ä»£çš„ è¿™æ—¶å€™äº†è§£Python Webå¼€å‘çš„å¯èƒ½å°±ä¼šè®²äº†,å¹³æ—¶æˆ‘ä»¬å†™çš„åº”ç”¨ç¨‹åºå¹¶ä¸æ˜¯è¿™ä¸ªæ ·å­çš„,åº”è¯¥æ˜¯ä¸‹é¢è¿™ç§ 123class Index(View): def get(self): return 'Hello world' è¿™æ˜¯å› ä¸ºæ¡†æž¶å·²ç»å¸®æˆ‘ä»¬æŠŠWSGIè§„å®šçš„ä¸€äº›ä¸œè¥¿å°è£…èµ·æ¥,æˆ‘ä»¬å¹³æ—¶ç”¨æ¡†æž¶æ—¶çœ‹ä¸åˆ°,åªéœ€è¦ç›´æŽ¥å®žçŽ°æˆ‘ä»¬çš„é€»è¾‘ï¼Œå†è¿”å›žä¸€ä¸ªå€¼å°±å¥½äº†ã€‚å…¶å®ƒçš„ä¸œè¥¿æ¡†æž¶å¸®æˆ‘ä»¬åšå¥½äº†ã€‚è¿™ä¹Ÿæ˜¯æ¡†æž¶çš„ä»·å€¼æ‰€åœ¨ï¼ŒæŠŠå¸¸ç”¨çš„ä¸œè¥¿å°è£…èµ·æ¥ï¼Œè®©ä½¿ç”¨è€…åªéœ€è¦å…³æ³¨æœ€é‡è¦çš„ä¸œè¥¿ã€‚ æ¯”å¦‚ Djangoæ¡†æž¶çš„ WSGI Application å°±é‡‡ç”¨çš„ callable objectçš„å½¢å¼ 123456789101112131415161718192021222324# lib/python3.7/site-packages/django/core/handlers/wsgi.py 146 lineclass WSGIHandler(base.BaseHandler): request_class = WSGIRequest def __init__(self, *args, **kwargs): super(WSGIHandler, self).__init__(*args, **kwargs) self.load_middleware() def __call__(self, environ, start_response): set_script_prefix(get_script_name(environ)) signals.request_started.send(sender=self.__class__, environ=environ) request = self.request_class(environ) response = self.get_response(request) response._handler_class = self.__class__ status = '%d %s' % (response.status_code, response.reason_phrase) response_headers = [(str(k), str(v)) for k, v in response.items()] for c in response.cookies.values(): response_headers.append((str('Set-Cookie'), str(c.output(header='')))) start_response(force_str(status), response_headers) if getattr(response, 'file_to_stream', None) is not None and environ.get('wsgi.file_wrapper'): response = environ['wsgi.file_wrapper'](response.file_to_stream) return response WSGI-æœåŠ¡å™¨ç¨‹åºæœåŠ¡å™¨ç¨‹åºä¼šåœ¨æ¯æ¬¡å®¢æˆ·ç«¯çš„è¯·æ±‚ä¼ æ¥æ—¶,è°ƒç”¨æˆ‘ä»¬å†™å¥½çš„åº”ç”¨ç¨‹åº,å¹¶å°†å¤„ç†å¥½çš„ç»“æžœ(response)è¿”å›žå®¢æˆ·ç«¯. 4.æœåŠ¡å™¨ç¨‹åºéœ€è¦è°ƒç”¨åº”ç”¨ç¨‹åº Application æœåŠ¡å™¨ç¨‹åºå¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­ 1234567891011121314151617181920# å…·ä½“è§PEP333è§„èŒƒdef run_with_cgi(application): environ = &#123;&#125; def write(data): pass def start_response(status, response_headers, exc_info=None): pass # è°ƒç”¨åº”ç”¨ç¨‹åº result = application(environ, start_response) try: for data in result: if data: # don't send headers until body appears write(data) if not headers_sent: write('') # send headers now if body was empty finally: if hasattr(result, 'close'): result.close() è¿™é‡Œå¯ä»¥çœ‹å‡ºæœåŠ¡å™¨ç¨‹åºæ˜¯å¦‚ä½•ä¸Žåº”ç”¨ç¨‹åºé…åˆå®Œæˆç”¨æˆ·è¯·æ±‚çš„ã€‚ WSGIè§„å®šäº†åº”ç”¨ç¨‹åºéœ€è¦ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œè¿”å›žä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ã€‚åœ¨æœåŠ¡å™¨ ç¨‹åºä¸­ï¼Œé’ˆå¯¹è¿™å‡ ä¸ªè§„å®šï¼Œåšäº†ä»¥ä¸‹å‡ ä»¶äº‹ï¼š æŠŠåº”ç”¨ç¨‹åºéœ€è¦çš„ä¸¤ä¸ªå‚æ•°è®¾ç½®å¥½ è°ƒç”¨åº”ç”¨ç¨‹åº è¿­ä»£è®¿é—®åº”ç”¨ç¨‹åºçš„è¿”å›žç»“æžœï¼Œå¹¶å°†å…¶ä¼ å›žå®¢æˆ·ç«¯ WSGI-Middlewareæœ‰äº›åŠŸèƒ½å¯èƒ½ä»‹äºŽæœåŠ¡å™¨ç¨‹åºå’Œåº”ç”¨ç¨‹åºä¹‹é—´,ä¾‹å¦‚ï¼ŒæœåŠ¡å™¨æ‹¿åˆ°äº†å®¢æˆ·ç«¯è¯·æ±‚çš„URL, ä¸åŒçš„URLéœ€è¦äº¤ç”±ä¸åŒçš„å‡½æ•°å¤„ç†ï¼Œè¿™ä¸ªåŠŸèƒ½å«åš URL Routingï¼Œè¿™ä¸ªåŠŸèƒ½å°±å¯ä»¥æ”¾åœ¨äºŒè€…ä¸­é—´å®žçŽ°ï¼Œè¿™ä¸ªä¸­é—´å±‚å°±æ˜¯ middlewareã€‚ æœ‰ç‚¹ç±»ä¼¼äºŽè¯­æ³•ç³– è£…é¥°å™¨, 123456789101112131415# URL Routing middlewaredef urlrouting(url_app_mapping): def midware_app(environ, start_response): url = environ['PATH_INFO'] app = url_app_mapping[url] result = app(environ, start_response) return result return midware_app'''ä¸­é—´ä»¶ä½œç”¨è¯´æ˜Ž:æœåŠ¡å™¨æ‹¿åˆ°äº†å®¢æˆ·ç«¯è¯·æ±‚çš„URL, ä¸åŒçš„URLéœ€è¦äº¤ç”±ä¸åŒçš„å‡½æ•°å¤„ç†ï¼Œè¿™ä¸ªåŠŸèƒ½å«åš URL Routingï¼Œè¿™ä¸ªåŠŸèƒ½å°±å¯ä»¥æ”¾åœ¨äºŒè€…ä¸­é—´å®žçŽ°ï¼Œè¿™ä¸ªä¸­é—´å±‚å°±æ˜¯ middlewareã€‚''' WSGI-è¯¦è§£åº”ç”¨ç¨‹åº åº”ç”¨ç¨‹åºæ˜¯å¯è°ƒç”¨å¯¹è±¡(å‡½æ•°/ç±»/ç±»çš„å®žä¾‹) application(environ, start_response) å¯è°ƒç”¨å¯¹è±¡æœ‰ä¸¤ä¸ªä½ç½®å‚æ•°(æ³¨æ„æ˜¯ä½ç½®å‚æ•°ä¸æ˜¯å…³é”®å­—å‚æ•°) 2ä¸ªå‚æ•°åç§°ä¸æ˜¯å›ºå®šçš„,å¯ä»¥éšä¾¿èµ·,ä¸è¿‡ä¸ºäº†è¡¨è¾¾æ¸…æ¥šæ‰€ä»¥ä¸€èˆ¬éƒ½å« environå’Œ start_response ç¬¬ä¸€ä¸ªå‚æ•° environæ˜¯Dictå­—å…¸å¯¹è±¡,å‚æ•°åŒ…å«WSGIéœ€è¦çš„ä¸€äº›å˜é‡ ç¬¬äºŒä¸ªå‚æ•° start_responseå‚æ•°æ˜¯ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡,ä¹Ÿæœ‰ä¸¤ä¸ªä½ç½®å‚æ•°å’Œä¸€ä¸ªå¯é€‰å‚æ•°. start_response(status, response_headers, exc_info=None) statusæ˜¯çŠ¶æ€ç :æ¯”å¦‚201,404â€¦.. response_headerså‚æ•°æ˜¯ä¸€ä¸ªlistç±»åž‹,å†…å®¹[header_name,header_value], exc_infoä¸»è¦å¼‚å¸¸å¤„ç†çš„æ—¶å€™ä½¿ç”¨,é»˜è®¤æ˜¯None start_responseå¿…é¡»è¿”å›žä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡: write(body_data) åº”ç”¨ç¨‹åºå¿…é¡»è¿”å›žä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ åº”ç”¨ç¨‹åºå¿…é¡»åœ¨ç¬¬ä¸€æ¬¡è¿”å›žå¯è¿­ä»£æ•°æ®ä¹‹å‰è°ƒç”¨ start_response æ–¹æ³•ã€‚è¿™æ˜¯å› ä¸ºå¯è¿­ä»£æ•°æ®æ˜¯ è¿”å›žæ•°æ®çš„ body éƒ¨åˆ†ï¼Œåœ¨å®ƒè¿”å›žä¹‹å‰ï¼Œéœ€è¦ä½¿ç”¨ start_response è¿”å›ž response_headers å“åº”å¤´æ•°æ®,é€šè¿‡å“åº”å¤´(response_headers)+å“åº”ä½“(body)æ‹¼æŽ¥è¿”å›žç»™å®¢æˆ·ç«¯ã€‚ æœåŠ¡å™¨ç¨‹åº æœåŠ¡å™¨å¿…é¡»å°†å¯è¿­ä»£å¯¹è±¡çš„å†…å®¹ä¼ é€’ç»™å®¢æˆ·ç«¯ï¼Œå¯è¿­ä»£å¯¹è±¡ä¼šäº§ç”Ÿbytestringsï¼Œå¿…é¡»å®Œå…¨å®Œæˆæ¯ä¸ªbytestringåŽæ‰èƒ½è¯·æ±‚ä¸‹ä¸€ä¸ªã€‚ å‡è®¾result ä¸ºåº”ç”¨ç¨‹åºçš„è¿”å›žçš„å¯è¿­ä»£å¯¹è±¡ã€‚å¦‚æžœlen(result) è°ƒç”¨æˆåŠŸï¼Œé‚£ä¹ˆresultå¿…é¡»æ˜¯å¯ç´¯ç§¯çš„ã€‚å¦‚æžœresultæœ‰closeæ–¹æ³•ï¼Œé‚£ä¹ˆæ¯æ¬¡å®Œæˆå¯¹è¯·æ±‚çš„å¤„ç†æ—¶ï¼Œå¿…é¡»è°ƒç”¨å®ƒï¼Œæ— è®ºè¿™æ¬¡è¯·æ±‚æ­£å¸¸å®Œæˆï¼Œè¿˜æ˜¯é‡åˆ°äº†é”™è¯¯ã€‚ æœåŠ¡å™¨ç¨‹åºç¦æ­¢ä½¿ç”¨å¯è¿­ä»£å¯¹è±¡çš„å…¶å®ƒå±žæ€§ï¼Œé™¤éžè¿™ä¸ªå¯è¿­ä»£å¯¹è±¡æ˜¯ä¸€ä¸ªç‰¹æ®Šç±»çš„å®žä¾‹ï¼Œè¿™ä¸ªç±»ä¼šè¢« wsgi.file_wrapperå®šä¹‰ã€‚ 123456789101112131415161718192021222324252627282930313233343536# server programmeddef run(application): environ = &#123;&#125; # set environ def write(data): pass def start_response(status, response_headers, exc_info=None): return write try: result = application(environ, start_response) finally: if hasattr(result, 'close'): result.close() if hasattr(result, '__len__'): # result must be accumulated pass for data in result: write(data)HELLO_WORLD = b"Hello world!\n" # callable functiondef application(environ, start_response): status = '200 OK' response_headers = [('Content-type', 'text/plain')] start_response(status, response_headers) return [HELLO_WORLD] environå˜é‡environ å˜é‡éœ€è¦åŒ…å« CGI çŽ¯å¢ƒå˜é‡ï¼Œå®ƒä»¬åœ¨The Common Gateway Interface Specification ä¸­å®šä¹‰ï¼Œä¸‹é¢åˆ—å‡ºçš„å˜é‡å¿…é¡»åŒ…å«åœ¨ encironå˜é‡ä¸­ï¼š REQUEST_METHODHTTP è¯·æ±‚æ–¹æ³•ï¼Œä¾‹å¦‚ â€œGETâ€, â€œPOSTâ€ SCRIPT_NAMEURL è·¯å¾„çš„èµ·å§‹éƒ¨åˆ†å¯¹åº”çš„åº”ç”¨ç¨‹åºå¯¹è±¡ï¼Œå¦‚æžœåº”ç”¨ç¨‹åºå¯¹è±¡å¯¹åº”æœåŠ¡å™¨çš„æ ¹ï¼Œé‚£ä¹ˆè¿™ä¸ªå€¼å¯ä»¥ä¸ºç©ºå­—ç¬¦ä¸² PATH_INFOURL è·¯å¾„é™¤äº†èµ·å§‹éƒ¨åˆ†åŽçš„å‰©ä½™éƒ¨åˆ†ï¼Œç”¨äºŽæ‰¾åˆ°ç›¸åº”çš„åº”ç”¨ç¨‹åºå¯¹è±¡ï¼Œå¦‚æžœè¯·æ±‚çš„è·¯å¾„å°±æ˜¯æ ¹è·¯å¾„ï¼Œè¿™ä¸ªå€¼ä¸ºç©ºå­—ç¬¦ä¸² QUERY_STRINGURLè·¯å¾„ä¸­ ? åŽé¢çš„éƒ¨åˆ† CONTENT_TYPEHTTP è¯·æ±‚ä¸­çš„ Content-Type éƒ¨åˆ† CONTENT_LENGTHHTTP è¯·æ±‚ä¸­çš„Content-Lengh éƒ¨åˆ† SERVER_NAME, SERVER_PORTä¸Ž SCRIPT_NAMEï¼ŒPATH_INFO å…±åŒæž„æˆå®Œæ•´çš„ URLï¼Œå®ƒä»¬æ°¸è¿œä¸ä¼šä¸ºç©ºã€‚ä½†æ˜¯ï¼Œå¦‚æžœ HTTP_HOST å­˜åœ¨çš„è¯ï¼Œå½“æž„å»º URL æ—¶ï¼Œ HTTP_HOSTä¼˜å…ˆäºŽSERVER_NAMEã€‚ SERVER_PROTOCOLå®¢æˆ·ç«¯ä½¿ç”¨çš„åè®®ï¼Œä¾‹å¦‚ â€œHTTP/1.0â€, â€œHTTP/1.1â€, å®ƒå†³å®šäº†å¦‚ä½•å¤„ç† HTTP è¯·æ±‚çš„å¤´éƒ¨ã€‚è¿™ä¸ªåå­—å…¶å®žåº”è¯¥å«REQUEST_PROTOCOLï¼Œå› ä¸ºå®ƒè¡¨ç¤ºçš„æ˜¯å®¢æˆ·ç«¯è¯·æ±‚çš„åè®®ï¼Œè€Œä¸æ˜¯æœåŠ¡ç«¯å“åº”çš„åè®®ã€‚ä½†æ˜¯ä¸ºäº†å’ŒCGIå…¼å®¹ï¼Œæˆ‘ä»¬åªå¥½å«è¿™ä¸ªåå­—äº†ã€‚ *HTTP_ Variablesè¿™ä¸ªæ˜¯ä¸€ä¸ªç³»åˆ—çš„å˜é‡åï¼Œéƒ½ä»¥HTTPå¼€å¤´ï¼Œå¯¹åº”å®¢æˆ·ç«¯æ”¯æŒçš„HTTPè¯·æ±‚çš„å¤´éƒ¨ä¿¡æ¯ã€‚ WSGIåœ¨Pythonæ ‡å‡†åº“å½“ä¸­æœ‰ä¸€ä¸ªå®žä¾‹â€”&gt; wsgiref,æˆ‘ä»¬å¯ä»¥çœ‹ä¸‹è¿™äº›å˜é‡å…·ä½“å†…å®¹ 12345678910111213141516REQUEST_METHOD = 'GET'SCRIPT_NAME = ''PATH_INFO = '/xyz'QUERY_STRING = 'abc'CONTENT_TYPE = 'text/plain'CONTENT_LENGTH = ''SERVER_NAME = 'minix-ubuntu-desktop'SERVER_PORT = '8000'SERVER_PROTOCOL = 'HTTP/1.1' HTTP_ACCEPT = 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8'HTTP_ACCEPT_ENCODING = 'gzip,deflate,sdch'HTTP_ACCEPT_LANGUAGE = 'en-US,en;q=0.8,zh;q=0.6,zh-CN;q=0.4,zh-TW;q=0.2'HTTP_CONNECTION = 'keep-alive'HTTP_HOST = 'localhost:8000'HTTP_USER_AGENT = 'Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/32.0.1700.77 Safari/537.36' UnicodeHTTP ä¸æ”¯æŒ Unicode, æ‰€æœ‰ç¼–ç /è§£ç éƒ½å¿…é¡»ç”±åº”ç”¨ç¨‹åºå®Œæˆï¼Œæ‰€æœ‰ä¼ é€’ç»™æˆ–è€…æ¥è‡ªserverçš„å­—ç¬¦ä¸²éƒ½å¿…é¡»æ˜¯ str æˆ–è€…bytesç±»åž‹ï¼Œè€Œä¸æ˜¯unicodeã€‚ æ³¨æ„:WSGIä¸­çš„ bytestringsåœ¨Python3ä¸­æŒ‡ bytes,åœ¨Python2ä¸­æŒ‡ str å‚è€ƒåˆ—è¡¨WSGIç®€ä»‹ Wsgirefæ–‡æ¡£ PEP333]]></content>
      <categories>
        <category>Web</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[DRF-Exception-Handler&æºç åˆ†æž]]></title>
    <url>%2F2019%2F07%2F09%2FDRF-Exception-Handler-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[è‡ªåŠ¨è¿›è¡Œå¼‚å¸¸å¤„ç†æ˜¯ Django-Rest-Frameworkè‡ªå·±å°è£…å¥½çš„,èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨å¤„ç†ä¸€äº›å¸¸è§çš„å¼‚å¸¸(è®¤è¯å¤±è´¥|æƒé™æ‹’ç»|åºåˆ—åŒ–æ ¡éªŒå¤±è´¥|â€¦),å¹¶è¿”å›žå“åº”,ä¸ç”¨æˆ‘ä»¬è‡ªå·±åŽ»å¤„ç†.æœ¬æ–‡ä¸»è¦è®²è§£ä¸€ä¸‹DRFæ€Žæ ·è‡ªåŠ¨çš„è¿›è¡Œå¼‚å¸¸å¤„ç†,ä»¥åŠæºç æ˜¯æ€Žä¹ˆå®žçŽ°çš„. å†…ç½®å¼‚å¸¸å¤„ç†å…ˆçœ‹ä¸€ä¸‹æºç å½“ä¸­çš„ settings.pyæ–‡ä»¶ 12345# python3.7/site-packages/rest_framework/settings.py 89line# Exception handling 'EXCEPTION_HANDLER': 'rest_framework.views.exception_handler','NON_FIELD_ERRORS_KEY': 'non_field_errors', é»˜è®¤é…ç½®æ–‡ä»¶çš„å¼‚å¸¸å¤„ç†æ–¹å¼ rest_framework.views.exception_handleræºç  12345678910111213141516171819202122232425262728# /lib/python3.7/site-packages/rest_framework/views.py 73 linedef exception_handler(exc, context): """ # LQ: è¿”å›žç»™å®šå¼‚å¸¸çš„å“åº”,é»˜è®¤æƒ…å†µä¸‹,æˆ‘ä»¬å¤„ç† "APIException"å’Œ"Http404"å’Œ"PermissionDenied"å¼‚å¸¸, å¦‚æžœä¸‰ç§å¼‚å¸¸éƒ½æœªèƒ½å¤„ç†è¿”å›ž "None",è¿™å°†å¯¼è‡´500é”™è¯¯ """ if isinstance(exc, Http404): exc = exceptions.NotFound() elif isinstance(exc, PermissionDenied): exc = exceptions.PermissionDenied() if isinstance(exc, exceptions.APIException): headers = &#123;&#125; if getattr(exc, 'auth_header', None): headers['WWW-Authenticate'] = exc.auth_header if getattr(exc, 'wait', None): headers['Retry-After'] = '%d' % exc.wait if isinstance(exc.detail, (list, dict)): data = exc.detail else: data = &#123;'detail': exc.detail&#125; set_rollback() return Response(data, status=exc.status_code, headers=headers) return None exception_handlerå‡½æ•°ä¸ä»…ä»…å¤„ç†ä¸Šé¢çš„3ç§å¼‚å¸¸,å…¶å®žDRFå¤„ç†çš„å¼‚å¸¸è¿˜æœ‰å¾ˆå¤š 1234567891011121314151617# /lib/python3.7/site-packages/rest_framework/exceptions.py 98 lineclass APIException(Exception): '''è¿™æ˜¯åŸºç±»,å…¶ä»–çš„å¼‚å¸¸ç±»éƒ½æ˜¯ç»§æ‰¿è¯¥ç±»''' pass'''APIException æ‰€æœ‰å¼‚å¸¸çš„çˆ¶ç±»ParseError è§£æžé”™è¯¯AuthenticationFailed è®¤è¯å¤±è´¥NotAuthenticated å°šæœªè®¤è¯PermissionDenied æƒé™æ‹’ç»NotFound æœªæ‰¾åˆ°MethodNotAllowed è¯·æ±‚æ–¹å¼ä¸æ”¯æŒNotAcceptable è¦èŽ·å–çš„æ•°æ®æ ¼å¼ä¸æ”¯æŒThrottled è¶…è¿‡é™æµæ¬¡æ•°ValidationError æ ¡éªŒå¤±è´¥ Http404 èµ„æºä¸å­˜åœ¨''' è¿™æ—¶å€™æ€è€ƒä¸€ä¸‹ä¸‹é¢ä¸¤ç§æƒ…å†µ 1.è§†å›¾ç±»å½“ä¸­ä½¿ç”¨åºåˆ—åŒ–å™¨ç±»: serializer.is_valid(raise_exception=True); 2.åºåˆ—åŒ–å™¨ç±»ä¸­ä½¿ç”¨: raise Serializers.ValidationError(&#39;å¼‚å¸¸åŽŸå› &#39;) æˆ‘ä»¬å¹¶æ²¡æœ‰åœ¨ä»£ç ä¸­ä½¿ç”¨ try exceptæ¥è¿›è¡Œå¼‚å¸¸æ•èŽ·è€Œä¸”ç¨‹åºä¹Ÿå¹¶æ²¡æœ‰å´©æºƒ,é‚£è¿™äº›å¼‚å¸¸è¢«è°å¤„ç†äº†? è¿™æ—¶å€™æˆ‘ä»¬çœ‹ä¸€ä¸‹ APIViewçš„å¤„ç†å‡½æ•°è°ƒåº¦(dispatch())æ–¹æ³•æºç  123456789101112131415161718192021222324252627282930313233# /lib/python3.7/site-packages/rest_framework/views.py 102 lineclass APIView(View): ...... def dispatch(self, request, *args, **kwargs): # 470 line """ # LQ: å’ŒDjangoåŽŸç”Ÿçš„dispatch()æ–¹æ³•ç±»ä¼¼,ä½†æ˜¯é¢å¤–å¤šäº†ä¸€äº›å†…å®¹ å¼‚å¸¸æ•èŽ·\è¯·æ±‚å¯¹è±¡çš„è¿›ä¸€æ­¥å°è£…å’Œåˆå§‹åŒ–\é¢å¤–çš„æ£€æŸ¥ """ self.args = args self.kwargs = kwargs request = self.initialize_request(request, *args, **kwargs) self.request = request self.headers = self.default_response_headers # deprecate? try: # LQ:initialæ–¹æ³•é‡Œé¢ä¸»è¦åšäº†è®¤è¯|æƒé™|åˆ†æµçš„æ ¡éªŒå¤„ç† self.initial(request, *args, **kwargs) # LQ:èŽ·å–å®¢æˆ·ç«¯è¯·æ±‚å¯¹åº”çš„å¤„ç†æ–¹æ³• if request.method.lower() in self.http_method_names: handler = getattr(self, request.method.lower(), self.http_method_not_allowed) else: handler = self.http_method_not_allowed response = handler(request, *args, **kwargs) except Exception as exc: # exc æ˜¯å¼‚å¸¸å¯¹è±¡ response = self.handle_exception(exc) self.response = self.finalize_response(request, response, *args, **kwargs) return self.response æºç å½“ä¸­ä½¿ç”¨äº† try exceptå¯¹æ‰€æœ‰çš„å¼‚å¸¸è¿›è¡Œäº†æ•èŽ·,å¹¶å°†å¼‚å¸¸äº¤ç»™ self.handle_exceptionæ¥è¿›è¡Œå¤„ç† 1234567891011121314151617181920212223242526272829303132# self.handle_responseclass APIView(View): ...... def handle_exception(self, exc): """ # LQ: APIViewçš„handle_exceptionå‡½æ•° å¤„ç†'NotAuthenticated'/'AuthenticationFailed'å¼‚å¸¸,å¹¶é€šè¿‡ 'get_exception_handler_context()'å®žä¾‹æ–¹æ³•è°ƒç”¨DRFå†…ç½®çš„å¼‚å¸¸å¤„ç† å¦‚æžœéƒ½ä¸èƒ½å¤„ç†å°±çˆ†æœåŠ¡å™¨é”™è¯¯ """ if isinstance(exc, (exceptions.NotAuthenticated, exceptions.AuthenticationFailed)): # WWW-Authenticate header for 401 responses, else coerce to 403 auth_header = self.get_authenticate_header(self.request) if auth_header: exc.auth_header = auth_header else: exc.status_code = status.HTTP_403_FORBIDDEN # LQ:è°ƒç”¨DRFé»˜è®¤çš„å¼‚å¸¸å¤„ç† exception_handler()å‡½æ•°æ¥è¿›è¡Œå¼‚å¸¸å¤„ç† exception_handler = self.get_exception_handler() context = self.get_exception_handler_context() response = exception_handler(exc, context) if response is None: '''LQ: å¦‚æžœresponseæ˜¯None,å°±ä»£ç DRFå†…ç½®çš„å¼‚å¸¸å·²ç»å¤„ç†ä¸äº†è¿™ä¸ªå¼‚å¸¸äº† æ¯”å¦‚æ•°æ®åº“é”™è¯¯/è¯­æ³•é”™è¯¯ç­‰ç­‰,å°±ä¼šæŠ›å‡ºå¼‚å¸¸äº†''' self.raise_uncaught_exception(exc) response.exception = True return response è‡ªå®šä¹‰å¼‚å¸¸åŸºæœ¬ä¸Šå¼‚å¸¸å¤„ç†æºç å°±è¿™äº›äº†,æœ‰äº†è¿™äº›å¼‚å¸¸å¤„ç†ä»¥åŽ,å†™ä»£ç çš„æ—¶å€™è§‰å¾—ä¼šå‡ºçŽ°å¼‚å¸¸çš„åœ°æ–¹ç›´æŽ¥ä½¿ç”¨ raiseå°†å¼‚å¸¸æŠ›å‡ºå³å¯,ä¸ç”¨å†åŽ»ç»„ç»‡Responseè¿”å›ž,æ˜¯ä¸æ˜¯æ–¹ä¾¿å¾ˆå¤š.ä½†æ˜¯DRFé»˜è®¤æ˜¯æ²¡æœ‰å¤„ç†æ•°æ®åº“æ–¹é¢çš„å¼‚å¸¸,æˆ‘ä»¬æ¯åšä¸€æ¬¡æ•°æ®åº“æ“ä½œ(ä¸»è¦æŒ‡è¿žæŽ¥æ“ä½œä¸å€¼è¯­æ³•é”™è¯¯),å°±è¦ä½¿ç”¨try exceptæ¥æ•èŽ·æ•°æ®åº“å¼‚å¸¸å¹¶è¿”å›žå“åº”ä»¥åŠè®°å½•æ—¥å¿—.è¿™æ—¶å€™å°±éœ€è¦è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†.ä¸»è¦æœ‰ä¸¤ä¸ªæ­¥éª¤: ç¬¬ä¸€æ­¥:è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†ç±»123456789101112131415161718192021222324252627282930from rest_framework.views import exception_handler as drf_exception_handlerimport loggingfrom rest_framework.response import Responsefrom rest_framework import status# æ‰€æœ‰çš„æ•°æ®åº“å¼‚å¸¸éƒ½æ˜¯è¿™ä¸¤ä¸ªå¼‚å¸¸çš„å„¿å­æˆ–å­™å­,å¯¼å…¥ä»–ä¿©å°±è¡Œfrom django.db import DatabaseErrorfrom redis.exceptions import RedisError# èŽ·å–åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„loggerï¼Œç”¨æ¥è®°å½•æ—¥å¿—logger = logging.getLogger('django')def exception_handler(exc, context): """ è‡ªå®šä¹‰å¼‚å¸¸å¤„ç† :param exc: åˆ«çš„åœ°æ–¹æŠ›çš„å¼‚å¸¸å°±ä¼šä¼ ç»™exc :param context: å­—å…¸å½¢å¼ã€‚æŠ›å‡ºå¼‚å¸¸çš„ä¸Šä¸‹æ–‡(å³æŠ›å‡ºå¼‚å¸¸çš„å‡ºå¤„;å³æŠ›å‡ºå¼‚å¸¸çš„è§†å›¾) :return: Responseå“åº”å¯¹è±¡ """ # è°ƒç”¨drfæ¡†æž¶åŽŸç”Ÿçš„å¼‚å¸¸å¤„ç†æ–¹æ³•,æŠŠå¼‚å¸¸å’Œå¼‚å¸¸å‡ºå¤„äº¤ç»™ä»–å¤„ç†,å¦‚æžœæ˜¯åºåˆ—åŒ–å™¨å¼‚å¸¸å°±ç›´æŽ¥å¤„ç†,å¤„ç†ä¹‹åŽå°±ç›´æŽ¥è¿”å›ž response = drf_exception_handler(exc, context) # å¦‚æžœå“åº”ä¸ºç©ºè¡¨ç¤ºä¸æ˜¯åºåˆ—åŒ–å™¨å¼‚å¸¸,è¡¥å……æ•°æ®åº“å¼‚å¸¸ if response is None: view = context['view'] if isinstance(exc, DatabaseError) or isinstance(exc, RedisError): # æ•°æ®åº“å¼‚å¸¸ logger.error('[%s] %s' % (view, exc)) response = Response(&#123;'message': 'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯'&#125;, status=status.HTTP_507_INSUFFICIENT_STORAGE) return response ç¬¬äºŒæ­¥:é…ç½®è‡ªå®šä¹‰çš„å¼‚å¸¸å¤„ç†ç±»åœ¨é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®,å‘Šè¯‰DRFè¦ä½¿ç”¨ä¸‹é¢çš„å¼‚å¸¸å¤„ç†ç±»æ¥è¿›è¡Œå¼‚å¸¸å¤„ç† 123REST_FRAMEWORK = &#123; 'EXCEPTION_HANDLER': 'è‡ªå·±çš„å¼‚å¸¸å¤„ç†ç±»è·¯å¾„.exception_handler'&#125;]]></content>
      <categories>
        <category>Django-Rest-Framework</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Pythonç¼–ç¨‹ä¹‹æ—¶é—´å’Œæ—¥æœŸæ¨¡å—]]></title>
    <url>%2F2019%2F07%2F08%2FPython%E6%A8%A1%E5%9D%97%E4%B9%8B%E6%97%B6%E9%97%B4%E6%A8%A1%E5%9D%97%2F</url>
    <content type="text"><![CDATA[å·¥ä½œå½“ä¸­ç»å¸¸ä¼šé‡åˆ°æ—¶é—´æˆ–è€…æ—¥æœŸçš„è®¡ç®—å’Œæ ¼å¼è½¬æ¢,å› æ­¤æ—¶é—´æ¨¡å—å°±æ˜¾å¾—éžå¸¸é‡è¦,Pythonå†…ç½®æä¾›äº† timeå’Œ datetimeå’Œ calendaræ¨¡å—ç”¨æ¥æ ¼å¼åŒ–æ—¥æœŸå’Œæ—¶é—´. timeæ¨¡å—Pythonä¸­æ—¶é—´å¯ä»¥æ¦‚æ‹¬ä¸ºä¸‰ç§ç±»åž‹: floatæµ®ç‚¹æ•°,å³æ—¶é—´æˆ³ struct tuple æ—¶é—´å…ƒç»„ strå­—ç¬¦ä¸²,è§„å®šæ ¼å¼è¡¨ç¤º æ—¶é—´æˆ³ä»‹ç»æ¯ä¸ªæ—¶é—´æˆ³éƒ½ä»¥è‡ªä»Ž1970å¹´1æœˆ1æ—¥åˆå¤œ(åŽ†å…ƒ)åˆ°å½“å‰ç»è¿‡äº†å¤šé•¿æ—¶é—´æ¥è¡¨ç¤º,æ—¶é—´é—´éš”æ˜¯ä»¥ç§’ä¸ºå•ä½çš„æµ®ç‚¹å°æ•°. å®žä¾‹1234import timeprint('æœ¬åœ°æ—¶é—´æˆ³: ', time.time()) # æœ¬åœ°æ—¶é—´æˆ³: 1562584408.3060238 æ—¶é—´æˆ³å•ä½æœ€é€‚äºŽåšæ—¥æœŸè¿ç®—,ä½†æ˜¯1970å¹´ä¹‹å‰çš„æ—¥æœŸå°±æ— æ³•ä»¥æ­¤è¡¨ç¤ºäº†.å¤ªé¥è¿œçš„æ—¥æœŸä¹Ÿä¸è¡Œ, UNIXå’Œ Windowsåªæ”¯æŒåˆ°2038å¹´. æ—¶é—´å…ƒç»„æ ¼å¼ å…·ä½“å®žä¾‹123import time# æ—¶é—´å…ƒç»„æ ¼å¼print('æœ¬åœ°æ—¶é—´ä¸º: ', time.localtime(time.time())) è¾“å‡ºç»“æžœ: 1æœ¬åœ°æ—¶é—´ä¸º: time.struct_time(tm_year=2019, tm_mon=7, tm_mday=8, tm_hour=19, tm_min=28, tm_sec=28, tm_wday=0, tm_yday=189, tm_isdst=0) 2ç§æ—¶é—´å­—ç¬¦ä¸²æ ¼å¼ç¬¬ä¸€ç§12019-07-08 19:32:07 # æ­£å¸¸æ ¼å¼ ç¬¬äºŒç§1Mon Jul d 19:32:2019 # è‹±æ–‡æ ¼å¼ å‡ ç§æ—¶é—´æ ¼å¼çš„è½¬æ¢ æ—¶é—´æˆ³è½¬æ—¶é—´å…ƒç»„12345678910import time# ç¬¬ä¸€ç§: ç»“æžœæ˜¯UTCæ—¶é—´ret1 = time.gmtime()# ç¬¬äºŒç§: ç»“æžœæ˜¯æœ¬åœ°æ—¶é—´(UTC+8)ret2 = time.localtime()print(ret1)print(ret2) è¾“å‡ºç»“æžœ 12time.struct_time(tm_year=2019, tm_mon=7, tm_mday=8, tm_hour=11, tm_min=44, tm_sec=46, tm_wday=0, tm_yday=189, tm_isdst=0)time.struct_time(tm_year=2019, tm_mon=7, tm_mday=8, tm_hour=19, tm_min=44, tm_sec=46, tm_wday=0, tm_yday=189, tm_isdst=0) æ—¶é—´å…ƒç»„è½¬æ—¶é—´æˆ³1234567import time# 1.èŽ·å–å½“å‰æ—¶é—´å…ƒç»„æ ¼å¼struct_time = time.localtime()# 2.è½¬æ—¶é—´æˆ³print(time.mktime(struct_time)) è¾“å‡ºæ ¼å¼ 11562586423.0 æ—¶é—´å…ƒç»„è½¬å­—ç¬¦ä¸²(format_time)123456789import time# 1. èŽ·å–æ—¶é—´å…ƒç»„struct_time = time.localtime()# 2. è½¬æ¢å­—ç¬¦ä¸²æ ¼å¼print(time.strftime('%Y-%m-%d %H:%M:%S', struct_time))print(time.strftime('%a %b %d %H:%M:%Y', struct_time))print(time.asctime(struct_time)) è¾“å‡º 1232019-07-08 19:52:21Mon Jul 08 19:52:2019Mon Jul 8 19:52:21 2019 æ—¶é—´å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ—¶é—´æˆ³12345678import timet = '2019-07-08 19:52:21'# 1. è½¬æ—¶é—´å…ƒç»„struct_time = time.strptime(t, '%Y-%m-%d %H:%M:%S')# 2. è½¬æ—¶é—´æˆ³print(time.mktime(struct_time)) è¾“å‡º 11562586741.0 pythonä¸­æ—¶é—´æ—¥æœŸæ ¼å¼åŒ–ç¬¦å·ï¼š ç¬¦å· æè¿° ç¬¦å· æè¿° %y ä¸¤ä½æ•°çš„å¹´ä»½è¡¨ç¤º (00-99) %a æœ¬åœ°ç®€åŒ–æ˜ŸæœŸåç§° %Y å››ä½æ•°çš„å¹´ä»½è¡¨ç¤º(000-9999) %A æœ¬åœ°å®Œæ•´æ˜ŸæœŸåç§° %m æœˆä»½(01-12) %b æœ¬åœ°ç®€åŒ–çš„æœˆä»½åç§° %d æœˆå†…ä¸­çš„ä¸€å¤©(0-31) %B æœ¬åœ°å®Œæ•´çš„æœˆä»½åç§° %H 24å°æ—¶åˆ¶å°æ—¶æ•°(0-23) %c æœ¬åœ°ç›¸åº”çš„æ—¥æœŸè¡¨ç¤ºå’Œæ—¶é—´è¡¨ç¤º %I 12å°æ—¶åˆ¶å°æ—¶æ•°(01-12) %j å¹´å†…çš„ä¸€å¤©(001-366) %M åˆ†é’Ÿæ•°(00=59) %p æœ¬åœ°A.M.æˆ–P.M.çš„ç­‰ä»·ç¬¦ %S ç§’(00-59) %U ä¸€å¹´ä¸­çš„æ˜ŸæœŸæ•°(00-53)æ˜ŸæœŸå¤©ä¸ºæ˜ŸæœŸçš„å¼€å§‹ %w æ˜ŸæœŸ(0-6)ï¼Œæ˜ŸæœŸå¤©ä¸ºæ˜ŸæœŸçš„å¼€å§‹ %x æœ¬åœ°ç›¸åº”çš„æ—¥æœŸè¡¨ç¤º %W ä¸€å¹´ä¸­çš„æ˜ŸæœŸæ•°(00-53)æ˜ŸæœŸä¸€ä¸ºæ˜ŸæœŸçš„å¼€å§‹ %X æœ¬åœ°ç›¸åº”çš„æ—¶é—´è¡¨ç¤º %% %å·æœ¬èº« %Z å½“å‰æ—¶åŒºçš„åç§° å†…ç½®å‡½æ•° å‡½æ•°å æè¿° time.time() è¿”å›žå½“å‰æ—¶é—´çš„æ—¶é—´æˆ³(1970çºªå…ƒåŽç»è¿‡çš„æµ®ç‚¹ç§’æ•°) time.localtime([secs]) è¿”å›žä¸€ä¸ªæ—¶é—´å…ƒç»„ , é»˜è®¤è¿”å›žå½“å‰æ—¶é—´æˆ³çš„æ—¶é—´å…ƒç»„ , secsä¸ºç§’æ•° time.sleep(secs) æŽ¨è¿Ÿè°ƒç”¨çº¿ç¨‹çš„è¿è¡Œ , å³è®©ç¨‹åºâ€™ ç¡ â€˜ä¸€ä¼š , secsä¸ºç§’æ•° time.strftime(fmt[,tupletime]) å°†æ—¶é—´å…ƒç»„è½¬æ¢æˆå­—ç¬¦ä¸²æ˜¾ç¤º , é»˜è®¤ä¸ºå½“å‰æ—¶é—´ , æ ¼å¼ç”±fmtå†³å®š time.strptime(str,fmt=â€™%a %b %d %H:%M:%S %Y) å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ—¶é—´å…ƒç»„ , fmtä¸ºå­—ç¬¦ä¸²æ ¼å¼ time.gmtime([secs]) å°†æ—¶é—´æˆ³è½¬æ¢æˆæ ¼æž—å¨æ²»(æœ¬åˆå­åˆçº¿)å¤©æ–‡æ—¶é—´ä¸‹çš„æ—¶é—´å…ƒç»„ time.asctime([tupletime]) å°†æ—¶é—´å…ƒç»„è½¬æ¢æˆå­—ç¬¦ä¸² , æ ¼å¼å¦‚ä¸‹ : Tue Aug 8 15:19:00 2016 time.ctime([secs]) ç›¸å½“äºŽasctime(localtime(secs)) , ä¸ç»™å‚æ•°ç›¸å½“äºŽasctime() time.mktime(tupletime) å°†æ—¶é—´å…ƒç»„è½¬æ¢æˆæ—¶é—´æˆ³ time.clock() è¿”å›žå½“å‰CPUæ—¶é—´æˆ³ , ç”¨æ¥è¡¡é‡ä¸åŒç¨‹åºçš„è€—æ—¶ , æ¯”time.time() æ›´æœ‰ç”¨ time.tzset() æ›´æ”¹æœ¬åœ°æ—¶åŒº time.altzone è¿”å›žå¤ä»¤æ—¶åœ°åŒºçš„åç§»ç§’æ•° , æ— éœ€æ‹¬å·è°ƒç”¨ , å¯¹éœ€è¦å¤ä»¤æ—¶åœ°åŒºæ‰ä½¿ç”¨ datetimeæ¨¡å—date1234567import datetime# 1. èŽ·å–æ—¥æœŸæ ¼å¼d = datetime.date(2019, 7, 8)# 2. æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²æ ¼å¼print(d.strftime('%Y-%m-%d')) # 2019-07-08 time1234567import datetime# 1. èŽ·å–æ—¶é—´æ ¼å¼ 20ç‚¹55åˆ†36ç§’d = datetime.time(20, 55, 36)# 2. æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²æ ¼å¼print(d.strftime('%H:%M:%S')) # 20:55:36 datetimeæ—¶é—´æ—¥æœŸæ ¼å¼è½¬å­—ç¬¦ä¸²123456789import datetime# 1. èŽ·å–å½“å‰æ—¥æœŸæ—¶é—´æ ¼å¼ &lt;class 'datetime.datetime'&gt;dt1 = datetime.datetime.now() # å½“å‰åœ°åŒºæ—¶åŒº UTC+8dt2 = datetime.datetime.utcnow() # UTCæ—¶åŒº# 2. è½¬æ¢å­—ç¬¦ä¸²æ ¼å¼print(dt1.strftime('%Y-%m-%d %H:%M:%S'))print(dt2.strftime('%Y-%m-%d %H:%M:%S')) è¾“å‡ºç»“æžœ 122019-07-08 20:12:282019-07-08 12:12:28 UTCæ—¶é—´æ¯”å½“å‰æ—¶åŒºå°‘8ä¸ªå°æ—¶ å­—ç¬¦ä¸²ä¼ æ—¶é—´æ—¥æœŸæ ¼å¼12345678import datetime# 1.å®šä¹‰ä¸€ä¸ªæ—¶é—´æ ¼å¼å­—ç¬¦ä¸²st = '2019-07-09 09:06:58'dt = datetime.datetime.strptime(st, '%Y-%m-%d %H:%M:%S')print(dt) # 2019-07-09 09:06:58print(type(dt)) # &lt;class 'datetime.datetime'&gt; timedelta é€šè¿‡ç”¨åˆ°æ—¶é—´æ—¥æœŸåŠ å‡è¿ç®— 123456789import datetime# 1. èŽ·å–å½“å‰æ—¥æœŸæ—¶é—´æ ¼å¼ &lt;class 'datetime.datetime'&gt;dt1 = datetime.datetime.now() # å½“å‰åœ°åŒºæ—¶åŒº UTC+8# 2. èŽ·å–æ¯”å½“å‰æ—¶é—´å¤š1å¤©1å°æ—¶1åˆ†é’Ÿçš„æ—¥æœŸæ—¶é—´æ ¼å¼dt2 = dt1 + datetime.timedelta(days=1, hours=1, minutes=1)print(dt1)print(dt2) è¾“å‡º 122019-07-08 20:30:08.5700962019-07-09 21:31:08.570096 calendarè¯¥æ¨¡å—ä¸»è¦æ˜¯å¤„ç†æ—¥åŽ†ç›¸å…³çš„,é»˜è®¤å‘¨ä¸€æ˜¯æ¯å‘¨çš„ç¬¬ä¸€å¤© ç›¸å…³å†…ç½®å‡½æ•° å‡½æ•° æè¿° calendar.calendar(year,w=2,l=1,c=6) è¿”å›žä¸€ä¸ªå¤šè¡Œå­—ç¬¦ä¸²æ ¼å¼çš„yearå¹´å¹´åŽ† , 3ä¸ªæœˆä¸€è¡Œ , é—´éš”è·ç¦»ä¸ºc ; æ¯æ—¥å®½åº¦é—´éš”ä¸ºwå­—ç¬¦ , æ¯è¡Œé•¿åº¦ä¸º21 W+18+2 C ; læ˜¯æ¯æ˜ŸæœŸè¡Œæ•° calendar.firstweekday( ) è¿”å›žå½“å‰æ¯å‘¨èµ·å§‹æ—¥æœŸçš„è®¾ç½® ; é»˜è®¤æƒ…å†µä¸‹ , é¦–æ¬¡è½½å…¥caendaræ¨¡å—æ—¶è¿”å›ž0 , å³æ˜ŸæœŸä¸€ calendar.isleap(year) æ˜¯é—°å¹´è¿”å›žTrue , å¦åˆ™ä¸ºfalse calendar.leapdays(y1,y2) è¿”å›žåœ¨Y1 , Y2ä¸¤å¹´ä¹‹é—´çš„é—°å¹´æ€»æ•° calendar.month(year,month,w=2,l=1) è¿”å›žä¸€ä¸ªå¤šè¡Œå­—ç¬¦ä¸²æ ¼å¼çš„yearå¹´monthæœˆæ—¥åŽ† , ä¸¤è¡Œæ ‡é¢˜ , ä¸€å‘¨ä¸€è¡Œ ; æ¯æ—¥å®½åº¦é—´éš”ä¸ºwå­—ç¬¦ , æ¯è¡Œçš„é•¿åº¦ä¸º7* w+6 , læ˜¯æ¯æ˜ŸæœŸçš„è¡Œæ•° calendar.monthcalendar(year,month) è¿”å›žä¸€ä¸ªæ•´æ•°çš„å•å±‚åµŒå¥—åˆ—è¡¨ , æ¯ä¸ªå­åˆ—è¡¨è£…è½½ä»£è¡¨ä¸€ä¸ªæ˜ŸæœŸçš„æ•´æ•° ; Yearå¹´monthæœˆå¤–çš„æ—¥æœŸéƒ½è®¾ä¸º0 ; èŒƒå›´å†…çš„æ—¥å­éƒ½ç”±è¯¥æœˆç¬¬å‡ æ—¥è¡¨ç¤º , ä»Ž1å¼€å§‹ calendar.monthrange(year,month) è¿”å›žä¸¤ä¸ªæ•´æ•° , ç¬¬ä¸€ä¸ªæ˜¯è¯¥æœˆçš„æ˜ŸæœŸå‡ çš„æ—¥æœŸç  , ç¬¬äºŒä¸ªæ˜¯è¯¥æœˆçš„æ—¥æœŸç  , æ—¥ä»Ž0ï¼ˆæ˜ŸæœŸä¸€ï¼‰åˆ°6ï¼ˆæ˜ŸæœŸæ—¥ï¼‰; æœˆä»Ž1åˆ°12 calendar.prcal(year,w=2,l=1,c=6) ç›¸å½“äºŽ print calendar.calendar(year , w , l , c) calendar.prmonth(year,month,w=2,l=1) ç›¸å½“äºŽ print calendar.calendarï¼ˆyear , w , l , cï¼‰ calendar.setfirstweekday(weekday) è®¾ç½®æ¯å‘¨çš„èµ·å§‹æ—¥æœŸç  , 0ï¼ˆæ˜ŸæœŸä¸€ï¼‰åˆ°6ï¼ˆæ˜ŸæœŸæ—¥ï¼‰ calendar.timegm(tupletime) å’Œtime.gmtimeç›¸å: æŽ¥å—ä¸€ä¸ªæ—¶é—´å…ƒç»„å½¢å¼ , è¿”å›žè¯¥æ—¶åˆ»çš„æ—¶é—´è¾ï¼ˆ1970çºªå…ƒåŽç»è¿‡çš„æµ®ç‚¹ç§’æ•°ï¼‰ calendar.weekday(year,month,day) è¿”å›žç»™å®šæ—¥æœŸçš„æ—¥æœŸç  , 0ï¼ˆæ˜ŸæœŸä¸€ï¼‰åˆ°6ï¼ˆæ˜ŸæœŸæ—¥ï¼‰ , æœˆä»½ä¸º 1ï¼ˆä¸€æœˆï¼‰ åˆ° 12ï¼ˆ12æœˆï¼‰ å®žä¾‹æ‰“å°æŒ‡å®šæ—¥åŽ†ä¿¡æ¯ 12345import calendarmonth = calendar.month(2019, 7)# æ‰“å°2019å¹´7æœˆçš„æ—¥åŽ†ä¿¡æ¯print(month) è¾“å‡ºä¿¡æ¯ 1234567 July 2019Mo Tu We Th Fr Sa Su 1 2 3 4 5 6 7 8 9 10 11 12 13 1415 16 17 18 19 20 2122 23 24 25 26 27 2829 30 31]]></content>
      <categories>
        <category>Python-Modules</category>
      </categories>
      <tags>
        <tag>time</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç”Ÿæ´»ä¹‹å…­ä¾¿å£«]]></title>
    <url>%2F2019%2F07%2F07%2F%E7%94%9F%E6%B4%BB%E4%B9%8B%E5%85%AD%E4%BE%BF%E5%A3%AB%2F</url>
    <content type="text"><![CDATA[è·ç¦»17å¹´æ¥ä¸Šæµ·å·¥ä½œå·²ç»æ•´æ•´2å¹´äº†,åˆšåˆ°ä¸Šæµ·çš„ä¸€åˆ‡æœªçŸ¥,åˆ°çŽ°åœ¨ç¨³å®šçš„ç”Ÿæ´»å’Œå·¥ä½œ,ä¸­é—´ç»åŽ†äº†å¤ªå¤š.æ„Ÿè§‰é‚£ä¹ˆçš„è¿œ,åˆé‚£ä¹ˆçš„è¿‘.æƒ³æƒ³å·¥ä½œçš„è¿™2å¹´,ä¸€åˆ‡æ˜¯ä¸ºäº†ä»€ä¹ˆ? å…­ä¾¿å£« ç¬¬ä¸€æ¬¡å¬åˆ° å…­ä¾¿å£« è¿™ä¸ªè¯æ˜¯åœ¨ Djangoçš„ä¸€ä¸ªäº¤æµç¾¤é‡Œ,çœ‹è¿‡ç¾¤ä¸» Blogsçš„éƒ½çŸ¥é“,ç¾¤ä¸»å¹¶ä¸æ˜¯ä¸€ä¸ªä»Žäº‹è½¯ä»¶å¼€å‘å·¥ä½œçš„äºº.ä½†ä»–å¯¹ Djangoä»¥åŠ Pythonçš„ç†è§£å’Œçƒ­çˆ±ç¼ºä¸æ˜¯ç¾¤é‡Œæ‰€æœ‰çš„äººèƒ½æ¯”çš„.å¯èƒ½è¿™å°±æ˜¯åŒæ ·ä¸€ä»¶äº‹æƒ… ä¸ºäº†å·¥ä½œ VS ä¸ºäº†ç”Ÿæ´»çš„åŒºåˆ«å§.åœ¨ä»–çš„åšå®¢ä¸­è®°è½½,ä»–æœ‰ä¸€ä»½éžå¸¸ç¨³å®šå¹¶ä¸”æ”¶å…¥å¯è§‚çš„å·¥ä½œ,å’Œç¦çš„å®¶åº­,ç”šè‡³è¿˜æœ‰äº†å­©å­.ä½†çªç„¶æœ‰ä¸€å¤©,ä»–å¯¹äº’è”ç½‘æœ‰äº†å…´è¶£åƒç€äº†è¿·ä¸€æ ·.æŠŠæ‰€æœ‰çš„ä¼‘é—²æ—¶é—´éƒ½æŠ•å…¥åˆ°äº†è½¯ä»¶å¼€å‘çš„å­¦ä¹ ,å¹¶ç”¨ Blogsè®°å½•è¿™ä¸€åˆ‡,å­¦åˆ°æœ€åŽç”šè‡³æœ‰äº†æ”¾å¼ƒçŽ°åœ¨å·¥ä½œåŽ»ä»Žäº‹è½¯ä»¶å¼€å‘çš„æƒ³æ³•.ä½†æœ€ç»ˆä»–è¿˜æ˜¯æ²¡æœ‰è¿™æ ·åš,å¯èƒ½ä»–ä¹Ÿæ˜Žç™½äº†,è½¯ä»¶å¼€å‘åªæ˜¯è‡ªå·±å¹³æ·¡ç”Ÿæ´»ä¸­çš„ç²¾ç¥žè¿½æ±‚. ã€Šæœˆäº®å’Œå…­ä¾¿å£«ã€‹æ˜¯è‹±å›½ä½œå®¶å¨å»‰Â·è¨é»˜å¡žç‰¹Â·æ¯›å§†çš„ä¸‰å¤§é•¿ç¯‡åŠ›ä½œä¹‹ä¸€ï¼Œå®ŒæˆäºŽ1919å¹´ã€‚ä½œå“ä»¥æ³•å›½å°è±¡æ‘„ç”»å®¶ä¿ç½—Â·é«˜æ›´çš„ç”Ÿå¹³ä¸ºç´ æï¼Žæè¿°äº†ä¸€ä¸ªåŽŸæœ¬å¹³å‡¡çš„ä¼¦æ•¦è¯åˆ¸ç»çºªäººæ€ç‰¹é‡Œå…‹å…°å¾·ï¼Œçªç„¶ç€äº†è‰ºæœ¯çš„é­”ï¼ŒæŠ›å¦»å¼ƒå­ï¼Œç»å¼ƒäº†æ—äººçœ‹æ¥ä¼˜è£•ç¾Žæ»¡çš„ç”Ÿæ´»ï¼Œå¥”èµ´å—å¤ªå¹³æ´‹çš„å¡”å¸Œæå²›ï¼Œç”¨åœ†ç¬”è°±å†™å‡ºè‡ªå·±å…‰è§£ç¿çƒ‚çš„ç”Ÿå‘½ï¼ŒæŠŠç”Ÿå‘½çš„ä»·å€¼å…¨éƒ¨æ³¨å…¥ç»šçƒ‚çš„ç”»å¸ƒçš„æ•…äº‹ã€‚è´«ç©·çš„çº ç¼ ï¼Œç—…é­”çš„æŠ˜ç£¨ä»–æ¯«ä¸åœ¨æ„ï¼Œåªæ˜¯åŽæ‚”ä»Žæ¥æ²¡æœ‰å…‰é¡¾è¿‡ä»–çš„æ„è¯†ã€‚ä½œå“è¡¨çŽ°äº†å¤©æ‰ã€ä¸ªæ€§ä¸Žç‰©è´¨æ–‡æ˜Žä»¥åŠçŽ°ä»£å©šå§»ã€å®¶åº­ç”Ÿæ´»ä¹‹é—´çš„çŸ›ç›¾ï¼Œæœ‰ç€å¹¿é˜”çš„ç”Ÿå‘½è§†è§’ï¼Œç”¨æ•£å‘ç€æ¶ˆæ¯’æ°´å‘³é“çš„æ‰‹æœ¯åˆ€å¯¹çš®å›ŠåŒ…è£¹ä¸‹çš„äººæ€§è¿›è¡Œäº†çŠ€åˆ©åœ°è§£å‰–ï¼Œæ··åˆç€çœ‹å®¢è®ªç¬‘çš„å¹½é»˜å’Œæ®‹å¿çš„ç›®å…‰ã€‚ å…­ä¾¿å£«æ˜¯å½“æ—¶è‹±å›½è´§å¸çš„æœ€å°å•ä½,æœ‰ä¸ªæœ‹å‹è·Ÿä½œè€…å¼€çŽ©ç¬‘è¯´,äººä»¬åœ¨ä»°æœ›æœˆäº®æ—¶å¸¸å¸¸å¿˜äº†è„šä¸‹çš„å…­ä¾¿å£«,ä½œè€…è§‰å¾—è¿™è¯´æ³•æŒºæœ‰æ„æ€,å°±èµ·äº†è¿™ä¸ªä¹¦å. æœˆäº®ä»£è¡¨é«˜é«˜åœ¨ä¸Šçš„ç†æƒ³å’Œç²¾ç¥žè¿½æ±‚,å…­ä¾¿å£«åˆ™æ˜¯çŽ°å®žçš„ä»£è¡¨. çŽ°å®žçš„åŽ‹åŠ›è®©æˆ‘ä»¬ä¸å¾—ä¸é¢å¯¹å…­ä¾¿å£«,ä¸€ç›´ä½Žå¤´èµ°è·¯,å¿˜è®°äº†æŠ¬å¤´çœ‹æœˆäº®. å¤§å®¶å› ä¸ºæˆ¿è´·,ä¹°è½¦è®¡åˆ’,è‚²å„¿ç›®æ ‡,ä¸æ–­çš„å°†å¤´åŸ‹çš„æ›´ä½Ž,æ›´åŠ å…³æ³¨é‡‘é’±å’ŒçŽ°å®ž,èŒç§°å’Œè–ªèµ„,å˜æˆäº†ä¸€ä¸ªç‰©è´¨æœºå™¨,æ—¥å¤ä¸€æ—¥,å¹´å¤ä¸€å¹´ï¼Œæœ€ç»ˆå›žè¿‡å¤´æ¥ï¼Œå‘çŽ°è‡ªå·±æœ‰äº†æˆ¿å­ã€æœ‰äº†è½¦å­ã€å­©å­é•¿å¤§äº†ï¼Œå¯æ˜¯è‡ªå·±å‘¢ï¼Ÿå‡ åå¹´éƒ½åœ¨åŸ‹å¤´è‹¦å¹²ï¼Œå°±åƒè½¦è½®åŽ‹è¿‡ä¸€æ¡æ¡å…¬è·¯ï¼Œæœ€ç»ˆæ˜¯åœ¨åŽŸåœ°è½¬åœˆåœˆï¼Œè‡ªå·±çš„ç²¾ç¥žé¢†åŸŸï¼Œå¥½åƒä¸€ç›´é‚£ä¹ˆçš„è´«ä¹ã€‚ åœ¨äººç”Ÿçš„è·¯ä¸Šï¼Œä¸åªæœ‰ç‰©è´¨çš„è¿½æ±‚ï¼Œä¸åªæ˜¯è¿½æ±‚é«˜é«˜çš„è–ªèµ„ã€å¤§å¤§çš„æˆ¿å­ã€æ¼‚äº®çš„è½¦å­ã€ä¼˜è¶Šçš„åœ°ä½ï¼Œæ›´èƒ½å¸¦æ¥æ»¡è¶³ã€æ›´èƒ½å¸¦æ¥æˆå°±æ„Ÿã€æ›´èƒ½è®©è‡ªå·±è€ä¸åŽæ‚”çš„ï¼Œæ˜¯ç²¾ç¥žçš„è¿½æ±‚ã€‚ å¯¹äºŽè¿™ä¸ªç²¾å½©çš„ã€æœªçŸ¥çš„ä¸–ç•Œçš„æŽ¢ç´¢å’Œç²¾ç¥žä¸Šçš„ä¿®ç‚¼é¢†æ‚Ÿï¼Œæ‰æ˜¯åœ¨ä½Žå¤´çœ‹ç€å…­ä¾¿å£«çš„åŒæ—¶ï¼Œéœ€è¦æŠ¬å¤´è¿½æ±‚çš„æœˆäº®ã€‚ ä¸è¦åšç‰©è´¨çš„å¥´éš¶ï¼Œè¦åšç²¾ç¥žçš„ä¸»äººã€‚]]></content>
      <categories>
        <category>Life</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[è®°å½•ä¹‹restful APIè®¾è®¡è§„èŒƒ]]></title>
    <url>%2F2019%2F07%2F04%2FAPI%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83%2F</url>
    <content type="text"><![CDATA[restfulé£Žæ ¼æ˜¯å½“ä¸‹ç½‘ç«™APIæœ€æµè¡Œçš„è®¾è®¡æ–¹å¼.é‚£ä¸ºä»€ä¹ˆè¦ç”¨restfulæ¥è®¾è®¡APIçš„æŽ¥å£å‘¢?ç½‘ç«™åº”ç”¨ç¨‹åºåˆ†ä¸ºå‰ç«¯å’ŒåŽç«¯ä¸¤ä¸ªéƒ¨åˆ†.éšç€å‰ç«¯çš„å¹³å°è¶Šæ¥è¶Šå¤š,éœ€è¦ä¸€ç§ç»Ÿä¸€çš„ APIè®¾è®¡è§„åˆ™,æ–¹ä¾¿å‰åŽå°ä¹‹é—´çš„é€šä¿¡. ä¸€.åè®®APIä¸Žç”¨æˆ·çš„é€šä¿¡åè®®,æ€»æ˜¯ä½¿ç”¨ HTTPSåè®®(å®‰å…¨); äºŒ.åŸŸååº”è¯¥å°½é‡å°†APIéƒ¨ç½²åœ¨ä¸“ç”¨çš„åŸŸåä¹‹ä¸‹ 1234# å‚è€ƒè±†ç“£çš„https://movie.douban.com/https://music.douban.com/https://book.douban.com/ å¦‚æžœç¡®å®šAPIå¾ˆç®€å•,ä¸ä¼šæœ‰è¿›ä¸€æ­¥æ‰©å±•,å¯ä»¥è€ƒè™‘æ”¾åˆ°ä¸»åŸŸåä¸‹. 1https://douban.com/api/ ä¸‰.ç‰ˆæœ¬åº”è¯¥å°†APIçš„ç‰ˆæœ¬å·æ”¾å…¥URLä¸­ 1https://movie.douban.com/v1/ å¦å¤–ä¸€ç§åšæ³•æ˜¯,å°†ç‰ˆæœ¬å·æ”¾åœ¨HTTPå¤´ä¿¡æ¯ä¸­,ä½†ä¸å¦‚æ”¾åœ¨URLæ–¹ä¾¿å’Œç›´è§‚ å››.è·¯å¾„è·¯å¾„å…¶å®žå°±æ˜¯URLçš„è·¯å¾„,è¡¨ç¤ºAPIçš„å…·ä½“ç½‘å€ åœ¨Restfulæž¶æž„ä¸­,æ¯ä¸ªç½‘å€ä»£è¡¨ä¸€ç§èµ„æº(resource),å› æ­¤è®¾è®¡ URLçš„æ—¶å€™,åªèƒ½ä½¿ç”¨åè¯,ä¸èƒ½ä½¿ç”¨åŠ¨è¯.è€Œä¸”æ‰€ç”¨çš„åè¯å¾€å¾€å’Œæ•°æ®åº“çš„è¡¨åå¯¹åº”,ä¸€èˆ¬æ¥è®²,æ•°æ®åº“ä¸­çš„è¡¨éƒ½æ˜¯åŒç§è®°å½•çš„é›†åˆ(collection),æ‰€ä»¥APIä¸­çš„åè¯ä¹Ÿåº”è¯¥ä½¿ç”¨å¤æ•°. ä¸¾ä¾‹æ¥è¯´,æœ‰ä¸€ä¸ªAPIæä¾›å›¾ä¹¦é¦†å›¾ä¹¦çš„ä¿¡æ¯ 1https://api.example.com/v1/books äº”.HTTPåŠ¨è¯å¯¹äºŽèµ„æº(ä¹Ÿå°±æ˜¯å¯¹URL)çš„å…·ä½“æ“ä½œç±»åž‹,æœ‰HTTPåŠ¨è¯æ¥è¿›è¡Œè¡¨ç¤º å¸¸ç”¨çš„HTTPåŠ¨è¯æœ‰ä¸‹é¢äº”ä¸ª 12345GET :ä»ŽæœåŠ¡å™¨èŽ·å–èµ„æº(ä¸€ä¸ªæˆ–å¤šä¸ª);POST:åœ¨æœåŠ¡å™¨æ–°å¢žä¸€ä¸ªèµ„æº;PUT: åœ¨æœåŠ¡å™¨æ›´æ–°èµ„æº(å®¢æˆ·ç«¯æä¾›æ”¹å˜åŽçš„å®Œæ•´èµ„æº);PATCH:åœ¨æœåŠ¡å™¨æ›´æ–°èµ„æº(å®¢æˆ·ç«¯æä¾›æ”¹å˜çš„å±žæ€§);DELETE:ä»ŽæœåŠ¡å™¨åˆ é™¤èµ„æº è¿˜æœ‰ä¸¤ä¸ªä¸å¸¸ç”¨çš„HTTPåŠ¨è¯ã€‚ 12HEADï¼šèŽ·å–èµ„æºçš„å…ƒæ•°æ®ã€‚OPTIONSï¼šèŽ·å–ä¿¡æ¯ï¼Œå…³äºŽèµ„æºçš„å“ªäº›å±žæ€§æ˜¯å®¢æˆ·ç«¯å¯ä»¥æ”¹å˜çš„ã€‚ ä¸‹é¢è¿˜æœ‰ä¸€äº›åˆ—å­ 12345678GET --&gt; /books/ : åˆ—å‡ºæ‰€æœ‰çš„å›¾ä¹¦POST --&gt; /books/ : æ–°å¢žä¸€ä¸ªå›¾ä¹¦GET --&gt; /books/&lt;ID&gt;/ : èŽ·å–æŒ‡å®šçš„æŸä¸ªå›¾ä¹¦ä¿¡æ¯PUT --&gt; /books/&lt;ID&gt;/ : æ›´æ–°æŸä¸ªå›¾ä¹¦ä¿¡æ¯(æä¾›è¯¥å›¾ä¹¦çš„æ‰€æœ‰ä¿¡æ¯)PATCH --&gt; /books/&lt;ID&gt;/ : æ›´æ–°æŸä¸ªå›¾ä¹¦ä¿¡æ¯(æä¾›è¯¥å›¾ä¹¦çš„éƒ¨åˆ†ä¿¡æ¯)DELETE --&gt; /bookds/&lt;ID&gt;/: åˆ é™¤æŸæœ¬å›¾ä¹¦GET --&gt; /books/&lt;ID&gt;/roles/ : èŽ·å–æŸæœ¬å›¾ä¹¦æ‰€æœ‰çš„äººç‰©è§’è‰²DELETE --&gt; /boods/&lt;ID&gt;/roles/&lt;ID&gt;/ : åˆ é™¤æŸæœ¬å›¾ä¹¦ä¸­æŒ‡å®šçš„ä»»åŠ¡è§’è‰² å…­.è¿‡æ»¤ä¿¡æ¯å¦‚æžœèŽ·å–çš„èµ„æºä¿¡æ¯è¿‡å¤š,æœåŠ¡å™¨ä¸å¯èƒ½éƒ½å°†ä»–ä»¬è¿”å›žç»™ç”¨æˆ·,APIåº”è¯¥æä¾›å‚æ•°,è¿‡æ»¤è¿”å›žç»“æžœ 1234?limit=10 :æŒ‡å®šè¿”å›žè®°å½•çš„æ•°é‡?offset=10:æŒ‡å®šè¿”å›žè®°å½•çš„å¼€å§‹ä½ç½®?page=2&amp;per_page=100:æŒ‡å®šç¬¬å‡ é¡µ,ä»¥åŠæ¯é¡µçš„è®°å½•æ•°?sortby=name&amp;order=asc:æŒ‡å®šæŽ’åºè§„åˆ™ å‚æ•°çš„è®¾è®¡å…è®¸å­˜åœ¨å†—ä½™,å³å…è®¸APIè·¯å¾„å’ŒURLå‚æ•°å¶å°”æœ‰é‡å¤.æ¯”å¦‚ GET /books/&lt;ID&gt;/roles/å’Œ GET /roles/?book_id=IDæ˜¯ä¸€æ ·çš„æ„æ€ ä¸ƒ.çŠ¶æ€ç æœåŠ¡å™¨å‘ç”¨æˆ·è¿”å›žçš„çŠ¶æ€ç å’Œæç¤ºä¿¡æ¯ 123456789101112200 OK - [GET]ï¼šæœåŠ¡å™¨æˆåŠŸè¿”å›žç”¨æˆ·è¯·æ±‚çš„æ•°æ®ï¼Œè¯¥æ“ä½œæ˜¯å¹‚ç­‰çš„ï¼ˆIdempotentï¼‰ã€‚201 CREATED - [POST/PUT/PATCH]ï¼šç”¨æˆ·æ–°å»ºæˆ–ä¿®æ”¹æ•°æ®æˆåŠŸã€‚202 Accepted - [*]ï¼šè¡¨ç¤ºä¸€ä¸ªè¯·æ±‚å·²ç»è¿›å…¥åŽå°æŽ’é˜Ÿï¼ˆå¼‚æ­¥ä»»åŠ¡ï¼‰204 NO CONTENT - [DELETE]ï¼šç”¨æˆ·åˆ é™¤æ•°æ®æˆåŠŸã€‚400 INVALID REQUEST - [POST/PUT/PATCH]ï¼šç”¨æˆ·å‘å‡ºçš„è¯·æ±‚æœ‰é”™è¯¯ï¼ŒæœåŠ¡å™¨æ²¡æœ‰è¿›è¡Œæ–°å»ºæˆ–ä¿®æ”¹æ•°æ®çš„æ“ä½œï¼Œè¯¥æ“ä½œæ˜¯å¹‚ç­‰çš„ã€‚401 Unauthorized - [*]ï¼šè¡¨ç¤ºç”¨æˆ·æ²¡æœ‰æƒé™ï¼ˆä»¤ç‰Œã€ç”¨æˆ·åã€å¯†ç é”™è¯¯ï¼‰ã€‚403 Forbidden - [*] è¡¨ç¤ºç”¨æˆ·å¾—åˆ°æŽˆæƒï¼ˆä¸Ž401é”™è¯¯ç›¸å¯¹ï¼‰ï¼Œä½†æ˜¯è®¿é—®æ˜¯è¢«ç¦æ­¢çš„ã€‚404 NOT FOUND - [*]ï¼šç”¨æˆ·å‘å‡ºçš„è¯·æ±‚é’ˆå¯¹çš„æ˜¯ä¸å­˜åœ¨çš„è®°å½•ï¼ŒæœåŠ¡å™¨æ²¡æœ‰è¿›è¡Œæ“ä½œï¼Œè¯¥æ“ä½œæ˜¯å¹‚ç­‰çš„ã€‚406 Not Acceptable - [GET]ï¼šç”¨æˆ·è¯·æ±‚çš„æ ¼å¼ä¸å¯å¾—ï¼ˆæ¯”å¦‚ç”¨æˆ·è¯·æ±‚JSONæ ¼å¼ï¼Œä½†æ˜¯åªæœ‰XMLæ ¼å¼ï¼‰ã€‚410 Gone -[GET]ï¼šç”¨æˆ·è¯·æ±‚çš„èµ„æºè¢«æ°¸ä¹…åˆ é™¤ï¼Œä¸”ä¸ä¼šå†å¾—åˆ°çš„ã€‚422 Unprocesable entity - [POST/PUT/PATCH] å½“åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå‘ç”Ÿä¸€ä¸ªéªŒè¯é”™è¯¯ã€‚500 INTERNAL SERVER ERROR - [*]ï¼šæœåŠ¡å™¨å‘ç”Ÿé”™è¯¯ï¼Œç”¨æˆ·å°†æ— æ³•åˆ¤æ–­å‘å‡ºçš„è¯·æ±‚æ˜¯å¦æˆåŠŸã€‚ çŠ¶æ€ç çš„å®Œå…¨åˆ—è¡¨è§ wsc å…«.é”™è¯¯å¤„ç†å¦‚æžœçŠ¶æ€ç æ˜¯4xx,å°±åº”è¯¥å‘ç”¨æˆ·è¿”å›žå‡ºé”™è¯¯ä¿¡æ¯.ä¸€èˆ¬æ¥è¯´,è¿”å›žçš„ä¿¡æ¯ä¸­å°† errorä½œä¸ºé”®å,å‡ºé”™ä¿¡æ¯ä½œä¸ºé”®å€¼. 123&#123; error: "Invalid API key"&#125; ä¹.è¿”å›žç»“æžœé’ˆå¯¹ä¸åŒæ“ä½œ,æœåŠ¡å™¨å‘ç”¨æˆ·è¿”å›žçš„ç»“æžœåº”è¯¥ç¬¦åˆä»¥ä¸‹è§„èŒƒ 123456GET /collectionï¼šè¿”å›žèµ„æºå¯¹è±¡çš„åˆ—è¡¨ï¼ˆæ•°ç»„ï¼‰GET /collection/resourceï¼šè¿”å›žå•ä¸ªèµ„æºå¯¹è±¡POST /collectionï¼šè¿”å›žæ–°ç”Ÿæˆçš„èµ„æºå¯¹è±¡PUT /collection/resourceï¼šè¿”å›žå®Œæ•´çš„èµ„æºå¯¹è±¡PATCH /collection/resourceï¼šè¿”å›žå®Œæ•´çš„èµ„æºå¯¹è±¡DELETE /collection/resourceï¼šè¿”å›žä¸€ä¸ªç©ºæ–‡æ¡£ å.è¶…åª’ä½“ Hypermedia APIRestful APIæœ€å¥½åšåˆ° Hypermedia,å³è¿”å›žç»“æžœä¸­æä¾›é“¾æŽ¥,è¿žå‘å…¶ä»–APIæ–¹æ³•,ä½¿ç”¨æˆ·ä¸ç”¨æŸ¥æ–‡æ¡£,å°±çŸ¥é“ä¸‹ä¸€æ­¥åº”è¯¥åšä»€ä¹ˆ. åä¸€.å…¶ä»– APIçš„è®¤è¯æ–¹å¼åº”è¯¥ä½¿ç”¨ OAuth.20æ¡†æž¶; æœåŠ¡å™¨è¿”å›žçš„æ•°æ®æ ¼å¼,åº”è¯¥å°½é‡ä½¿ç”¨JSON,é¿å…ä½¿ç”¨XML;]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>restful</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®°å½•ä¹‹Sentryè‡ªåŠ¨åŒ–å¼‚å¸¸ç›‘æŽ§]]></title>
    <url>%2F2019%2F06%2F29%2F%E8%AE%B0%E5%BD%95%E4%B9%8BSentry%E8%87%AA%E5%8A%A8%E5%8C%96%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7%2F</url>
    <content type="text"><![CDATA[Sentryæ˜¯ å“¨å…µçš„æ„æ€,å®ƒå¯ä»¥ç›‘æŽ§æˆ‘ä»¬åœ¨ç”Ÿäº§çŽ¯å¢ƒä¸­é¡¹ç›®çš„è¿è¡ŒçŠ¶æ€,ä¸€æ—¦æŸæ®µä»£ç è¿è¡ŒæŠ¥é”™,æˆ–è€…å¼‚å¸¸,ä¼šç¬¬ä¸€æ—¶é—´æŠŠæŠ¥é”™çš„ è·¯ç”± ,å¼‚å¸¸æ–‡ä»¶,è¯·æ±‚æ–¹å¼ç­‰ä¸€äº›éžå¸¸è¯¦ç»†çš„ä¿¡æ¯ä»¥æ¶ˆæ¯æˆ–è€…é‚®ä»¶ç»™æˆ‘ä»¬,è®©æˆ‘ä»¬ç¬¬ä¸€æ—¶é—´çŸ¥é“ ç¨‹åºå‡ºé”™äº†,ç„¶åŽæˆ‘ä»¬å¯ä»¥ä»Ž Sentryç»™æˆ‘ä»¬çš„è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ä¸­æ‰¾åˆ°æˆ‘ä»¬éœ€è¦å¤„ç†çš„ä»£ç .å°¤å…¶æ˜¯ç”Ÿäº§çŽ¯å¢ƒ,ç›¸æ¯”äºŽSSHåˆ°é»‘çª—å£æŸ¥çœ‹logæ—¥å¿—,ç›´æŽ¥é€šè¿‡å¯è§†åŒ–é¡µé¢/é‚®ä»¶å°±å¯ä»¥æŽ’æŸ¥åˆ° ERRORæ˜¯ä¸æ˜¯é«˜ç«¯äº†å¾ˆå¤š? ä½¿ç”¨Sentryä½¿ç”¨ Sentryæœ‰ä¸¤ç§æ–¹å¼ 1.ä½¿ç”¨å®˜æ–¹æä¾›ç»™ä½ çš„æœåŠ¡,ä¸è¿‡è¦æ”¶è´¹,æœ‰åŠä¸ªæœˆçš„è¯•ç”¨æ—¶é—´; 2.è‡ªå·±æ­å»º SentryæœåŠ¡,å®˜æ–¹æ–‡æ¡£æä¾›äº†ä¸¤ç§å®‰è£…æ–¹å¼,ä¸€ä¸ªæ˜¯ Docker,ä¸€ä¸ªæ˜¯ Python; å®˜æ–¹æä¾›æœåŠ¡æµç¨‹ è¿™æ˜¯Sentryå®˜ç½‘,éœ€è¦æ³¨å†Œè´¦å·,æˆ–è€…è¯•ç”¨GitHubè¿›è¡Œå•ç‚¹ç™»å½•; ç™»å½•è¿›åŽ»ä»¥åŽç‚¹å‡» Create Project é€‰æ‹©æ¡†æž¶/è¯­è¨€,è¿™é‡Œæˆ‘é€‰çš„æ˜¯Djangoæ¡†æž¶ åˆ›å»ºé¡¹ç›®ä»¥åŽè¿›å…¥éƒ¨ç½² éƒ¨ç½²æµç¨‹ å¼‚å¸¸åˆ—è¡¨éœ€è¦è¿›å…¥Sentryé‡Œçš„é¡¹ç›®ä¸­æŸ¥çœ‹å½“ç„¶ä¹Ÿæœ‰é‚®ä»¶æé†’ é‚®ä»¶æé†’ å¼‚å¸¸è¯¦æƒ…ä»‹ç» æ€»ç»“å®˜æ–¹æä¾›çš„SentryæœåŠ¡éžå¸¸ç®€å•å’Œæ–¹ä¾¿,ä½†æ˜¯æ”¶è´¹~,ä¸‹ä¸€ç¯‡æ–‡ç« ä¼šå°è¯•ä½¿ç”¨Dockeræ­å»ºSentryæœåŠ¡~]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Sentry</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é¢è¯•ä¹‹Rediså¸¸è§é¢è¯•é¢˜]]></title>
    <url>%2F2019%2F06%2F27%2F%E9%9D%A2%E8%AF%95%E4%B9%8BRedis%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98%2F</url>
    <content type="text"><![CDATA[Redisä½œä¸ºå¸¸ç”¨çš„å†…å­˜åž‹æ•°æ®åº“,é¢è¯•ä¸­ä¼šç»å¸¸é‡åˆ°,åœ¨ç½‘ä¸Šçœ‹åˆ°ä¸€äº› rediså¸¸è§çš„é¢è¯•é¢˜,ç®€å•æ•´ç†ä¸€ä¸‹. Redisæœ‰å“ªäº›æ•°æ®ç»“æž„?12345* å­—ç¬¦ä¸²Stringã€å­—å…¸Hashã€åˆ—è¡¨Listã€é›†åˆSetã€æœ‰åºé›†åˆSortedSetã€‚* å¦‚æžœä½ æ˜¯Redisä¸­é«˜çº§ç”¨æˆ·ï¼Œè¿˜éœ€è¦åŠ ä¸Šä¸‹é¢å‡ ç§æ•°æ®ç»“æž„HyperLogLogã€Geoã€Pub/Subã€‚* å¦‚æžœä½ è¯´è¿˜çŽ©è¿‡Redis Moduleï¼ŒåƒBloomFilterï¼ŒRedisSearchï¼ŒRedis-MLï¼Œé¢è¯•å®˜å¾—çœ¼ç›å°±å¼€å§‹å‘äº®äº†ã€‚ ä½¿ç”¨è¿‡Redisåˆ†å¸ƒå¼é”ä¹ˆ,å®ƒæ˜¯æ€Žä¹ˆå›žäº‹?12345* å…ˆæ‹¿setnxæ¥äº‰æŠ¢é”ï¼ŒæŠ¢åˆ°ä¹‹åŽï¼Œå†ç”¨expireç»™é”åŠ ä¸€ä¸ªè¿‡æœŸæ—¶é—´é˜²æ­¢é”å¿˜è®°äº†é‡Šæ”¾ã€‚* è¿™æ—¶å€™å¯¹æ–¹ä¼šå‘Šè¯‰ä½ è¯´ä½ å›žç­”å¾—ä¸é”™ï¼Œç„¶åŽæŽ¥ç€é—®å¦‚æžœåœ¨setnxä¹‹åŽæ‰§è¡Œexpireä¹‹å‰è¿›ç¨‹æ„å¤–crashæˆ–è€…è¦é‡å¯ç»´æŠ¤äº†ï¼Œé‚£ä¼šæ€Žä¹ˆæ ·ï¼Ÿ* è¿™æ—¶å€™ä½ è¦ç»™äºˆæƒŠè®¶çš„åé¦ˆï¼šå”‰ï¼Œæ˜¯å–”ï¼Œè¿™ä¸ªé”å°±æ°¸è¿œå¾—ä¸åˆ°é‡Šæ”¾äº†ã€‚ç´§æŽ¥ç€ä½ éœ€è¦æŠ“ä¸€æŠ“è‡ªå·±å¾—è„‘è¢‹ï¼Œæ•…ä½œæ€è€ƒç‰‡åˆ»ï¼Œå¥½åƒæŽ¥ä¸‹æ¥çš„ç»“æžœæ˜¯ä½ ä¸»åŠ¨æ€è€ƒå‡ºæ¥çš„ï¼Œç„¶åŽå›žç­”ï¼šæˆ‘è®°å¾—setæŒ‡ä»¤æœ‰éžå¸¸å¤æ‚çš„å‚æ•°ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯å¯ä»¥åŒæ—¶æŠŠsetnxå’Œexpireåˆæˆä¸€æ¡æŒ‡ä»¤æ¥ç”¨çš„ï¼å¯¹æ–¹è¿™æ—¶ä¼šæ˜¾éœ²ç¬‘å®¹ï¼Œå¿ƒé‡Œå¼€å§‹é»˜å¿µï¼šæ‘ï¼Œè¿™å°å­è¿˜ä¸é”™ã€‚ å‡å¦‚ Redisé‡Œé¢æœ‰1äº¿ä¸ªkey,å…¶ä¸­æœ‰10Wä¸ªkeyæ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„,å¦‚æžœå°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥.12345* ä½¿ç”¨keysæŒ‡ä»¤å¯ä»¥æ‰«å‡ºæŒ‡å®šæ¨¡å¼çš„keyåˆ—è¡¨ã€‚* å¯¹æ–¹æŽ¥ç€è¿½é—®ï¼šå¦‚æžœè¿™ä¸ªredisæ­£åœ¨ç»™çº¿ä¸Šçš„ä¸šåŠ¡æä¾›æœåŠ¡ï¼Œé‚£ä½¿ç”¨keysæŒ‡ä»¤ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ* è¿™ä¸ªæ—¶å€™ä½ è¦å›žç­”rediså…³é”®çš„ä¸€ä¸ªç‰¹æ€§ï¼šredisçš„å•çº¿ç¨‹çš„ã€‚keysæŒ‡ä»¤ä¼šå¯¼è‡´çº¿ç¨‹é˜»å¡žä¸€æ®µæ—¶é—´ï¼Œçº¿ä¸ŠæœåŠ¡ä¼šåœé¡¿ï¼Œç›´åˆ°æŒ‡ä»¤æ‰§è¡Œå®Œæ¯•ï¼ŒæœåŠ¡æ‰èƒ½æ¢å¤ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨scanæŒ‡ä»¤ï¼ŒscanæŒ‡ä»¤å¯ä»¥æ— é˜»å¡žçš„æå–å‡ºæŒ‡å®šæ¨¡å¼çš„keyåˆ—è¡¨ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€å®šçš„é‡å¤æ¦‚çŽ‡ï¼Œåœ¨å®¢æˆ·ç«¯åšä¸€æ¬¡åŽ»é‡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯æ•´ä½“æ‰€èŠ±è´¹çš„æ—¶é—´ä¼šæ¯”ç›´æŽ¥ç”¨keysæŒ‡ä»¤é•¿ã€‚ ä½¿ç”¨è¿‡Redisåšå¼‚æ­¥é˜Ÿåˆ—ä¹ˆ?ä½ æ˜¯æ€Žä¹ˆç”¨çš„?123456789* ä¸€èˆ¬ä½¿ç”¨listç»“æž„ä½œä¸ºé˜Ÿåˆ—ï¼Œrpushç”Ÿäº§æ¶ˆæ¯ï¼Œlpopæ¶ˆè´¹æ¶ˆæ¯ã€‚å½“lpopæ²¡æœ‰æ¶ˆæ¯çš„æ—¶å€™ï¼Œè¦é€‚å½“sleepä¸€ä¼šå†é‡è¯•ã€‚* å¦‚æžœå¯¹æ–¹è¿½é—®å¯ä¸å¯ä»¥ä¸ç”¨sleepå‘¢ï¼Ÿlistè¿˜æœ‰ä¸ªæŒ‡ä»¤å«blpopï¼Œåœ¨æ²¡æœ‰æ¶ˆæ¯çš„æ—¶å€™ï¼Œå®ƒä¼šé˜»å¡žä½ç›´åˆ°æ¶ˆæ¯åˆ°æ¥ã€‚* å¦‚æžœå¯¹æ–¹è¿½é—®èƒ½ä¸èƒ½ç”Ÿäº§ä¸€æ¬¡æ¶ˆè´¹å¤šæ¬¡å‘¢ï¼Ÿä½¿ç”¨pub/subä¸»é¢˜è®¢é˜…è€…æ¨¡å¼ï¼Œå¯ä»¥å®žçŽ°1:Nçš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚* å¦‚æžœå¯¹æ–¹è¿½é—®pub/subæœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿåœ¨æ¶ˆè´¹è€…ä¸‹çº¿çš„æƒ…å†µä¸‹ï¼Œç”Ÿäº§çš„æ¶ˆæ¯ä¼šä¸¢å¤±ï¼Œå¾—ä½¿ç”¨ä¸“ä¸šçš„æ¶ˆæ¯é˜Ÿåˆ—å¦‚rabbitmqç­‰ã€‚* å¦‚æžœå¯¹æ–¹è¿½é—®rediså¦‚ä½•å®žçŽ°å»¶æ—¶é˜Ÿåˆ—ï¼Ÿæˆ‘ä¼°è®¡çŽ°åœ¨ä½ å¾ˆæƒ³æŠŠé¢è¯•å®˜ä¸€æ£’æ‰“æ­»å¦‚æžœä½ æ‰‹ä¸Šæœ‰ä¸€æ ¹æ£’çƒæ£çš„è¯ï¼Œæ€Žä¹ˆé—®çš„è¿™ä¹ˆè¯¦ç»†ã€‚ä½†æ˜¯ä½ å¾ˆå…‹åˆ¶ï¼Œç„¶åŽç¥žæ€è‡ªè‹¥çš„å›žç­”é“ï¼šä½¿ç”¨sortedsetï¼Œæ‹¿æ—¶é—´æˆ³ä½œä¸ºscoreï¼Œæ¶ˆæ¯å†…å®¹ä½œä¸ºkeyè°ƒç”¨zaddæ¥ç”Ÿäº§æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ç”¨zrangebyscoreæŒ‡ä»¤èŽ·å–Nç§’ä¹‹å‰çš„æ•°æ®è½®è¯¢è¿›è¡Œå¤„ç†ã€‚ å¦‚æžœæœ‰å¤§é‡çš„keyéœ€è¦è®¾ç½®åŒä¸€æ—¶é—´è¿‡æœŸ,æ€Žä¹ˆæ“ä½œ?1* å¦‚æžœå¤§é‡çš„keyè¿‡æœŸæ—¶é—´è®¾ç½®çš„è¿‡äºŽé›†ä¸­ï¼Œåˆ°è¿‡æœŸçš„é‚£ä¸ªæ—¶é—´ç‚¹ï¼Œrediså¯èƒ½ä¼šå‡ºçŽ°çŸ­æš‚çš„å¡é¡¿çŽ°è±¡ã€‚ä¸€èˆ¬éœ€è¦åœ¨æ—¶é—´ä¸ŠåŠ ä¸€ä¸ªéšæœºå€¼ï¼Œä½¿å¾—è¿‡æœŸæ—¶é—´åˆ†æ•£ä¸€äº›ã€‚ Rediså¦‚ä½•åšæŒä¹…åŒ–123456* bgsaveåšé•œåƒå…¨é‡æŒä¹…åŒ–ï¼Œaofåšå¢žé‡æŒä¹…åŒ–ã€‚å› ä¸ºbgsaveä¼šè€—è´¹è¾ƒé•¿æ—¶é—´ï¼Œä¸å¤Ÿå®žæ—¶ï¼Œåœ¨åœæœºçš„æ—¶å€™ä¼šå¯¼è‡´å¤§é‡ä¸¢å¤±æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦aofæ¥é…åˆä½¿ç”¨ã€‚* åœ¨rediså®žä¾‹é‡å¯æ—¶ï¼Œä¼šä½¿ç”¨bgsaveæŒä¹…åŒ–æ–‡ä»¶é‡æ–°æž„å»ºå†…å­˜ï¼Œå†ä½¿ç”¨aofé‡æ”¾è¿‘æœŸçš„æ“ä½œæŒ‡ä»¤æ¥å®žçŽ°å®Œæ•´æ¢å¤é‡å¯ä¹‹å‰çš„çŠ¶æ€ã€‚* å¯¹æ–¹è¿½é—®é‚£å¦‚æžœçªç„¶æœºå™¨æŽ‰ç”µä¼šæ€Žæ ·ï¼Ÿå–å†³äºŽaofæ—¥å¿—syncå±žæ€§çš„é…ç½®ï¼Œå¦‚æžœä¸è¦æ±‚æ€§èƒ½ï¼Œåœ¨æ¯æ¡å†™æŒ‡ä»¤æ—¶éƒ½syncä¸€ä¸‹ç£ç›˜ï¼Œå°±ä¸ä¼šä¸¢å¤±æ•°æ®ã€‚ä½†æ˜¯åœ¨é«˜æ€§èƒ½çš„è¦æ±‚ä¸‹æ¯æ¬¡éƒ½syncæ˜¯ä¸çŽ°å®žçš„ï¼Œä¸€èˆ¬éƒ½ä½¿ç”¨å®šæ—¶syncï¼Œæ¯”å¦‚1s1æ¬¡ï¼Œè¿™ä¸ªæ—¶å€™æœ€å¤šå°±ä¼šä¸¢å¤±1sçš„æ•°æ®ã€‚* å¯¹æ–¹è¿½é—®bgsaveçš„åŽŸç†æ˜¯ä»€ä¹ˆï¼Ÿä½ ç»™å‡ºä¸¤ä¸ªè¯æ±‡å°±å¯ä»¥äº†ï¼Œforkå’Œcowã€‚forkæ˜¯æŒ‡redisé€šè¿‡åˆ›å»ºå­è¿›ç¨‹æ¥è¿›è¡Œbgsaveæ“ä½œï¼ŒcowæŒ‡çš„æ˜¯copy on writeï¼Œå­è¿›ç¨‹åˆ›å»ºåŽï¼Œçˆ¶å­è¿›ç¨‹å…±äº«æ•°æ®æ®µï¼Œçˆ¶è¿›ç¨‹ç»§ç»­æä¾›è¯»å†™æœåŠ¡ï¼Œå†™è„çš„é¡µé¢æ•°æ®ä¼šé€æ¸å’Œå­è¿›ç¨‹åˆ†ç¦»å¼€æ¥ã€‚ Pipelineæœ‰ä»€ä¹ˆå¥½å¤„?ä¸ºä»€ä¹ˆè¦ç”¨pipeline1* å¯ä»¥å°†å¤šæ¬¡IOå¾€è¿”çš„æ—¶é—´ç¼©å‡ä¸ºä¸€æ¬¡ï¼Œå‰ææ˜¯pipelineæ‰§è¡Œçš„æŒ‡ä»¤ä¹‹é—´æ²¡æœ‰å› æžœç›¸å…³æ€§ã€‚ä½¿ç”¨redis-benchmarkè¿›è¡ŒåŽ‹æµ‹çš„æ—¶å€™å¯ä»¥å‘çŽ°å½±å“redisçš„QPSå³°å€¼çš„ä¸€ä¸ªé‡è¦å› ç´ æ˜¯pipelineæ‰¹æ¬¡æŒ‡ä»¤çš„æ•°ç›®ã€‚ Redisçš„åŒæ­¥æœºåˆ¶äº†è§£ä¹ˆ?1* Rediså¯ä»¥ä½¿ç”¨ä¸»ä»ŽåŒæ­¥ï¼Œä»Žä»ŽåŒæ­¥ã€‚ç¬¬ä¸€æ¬¡åŒæ­¥æ—¶ï¼Œä¸»èŠ‚ç‚¹åšä¸€æ¬¡bgsaveï¼Œå¹¶åŒæ—¶å°†åŽç»­ä¿®æ”¹æ“ä½œè®°å½•åˆ°å†…å­˜bufferï¼Œå¾…å®ŒæˆåŽå°†rdbæ–‡ä»¶å…¨é‡åŒæ­¥åˆ°å¤åˆ¶èŠ‚ç‚¹ï¼Œå¤åˆ¶èŠ‚ç‚¹æŽ¥å—å®ŒæˆåŽå°†rdbé•œåƒåŠ è½½åˆ°å†…å­˜ã€‚åŠ è½½å®ŒæˆåŽï¼Œå†é€šçŸ¥ä¸»èŠ‚ç‚¹å°†æœŸé—´ä¿®æ”¹çš„æ“ä½œè®°å½•åŒæ­¥åˆ°å¤åˆ¶èŠ‚ç‚¹è¿›è¡Œé‡æ”¾å°±å®Œæˆäº†åŒæ­¥è¿‡ç¨‹ã€‚ æ˜¯å¦ä½¿ç”¨è¿‡Redisé›†ç¾¤,é›†ç¾¤çš„åŽŸç†æ˜¯ä»€ä¹ˆ?123* Redis Sentinalç€çœ¼äºŽé«˜å¯ç”¨ï¼Œåœ¨masterå®•æœºæ—¶ä¼šè‡ªåŠ¨å°†slaveæå‡ä¸ºmasterï¼Œç»§ç»­æä¾›æœåŠ¡ã€‚* Redis Clusterç€çœ¼äºŽæ‰©å±•æ€§ï¼Œåœ¨å•ä¸ªrediså†…å­˜ä¸è¶³æ—¶ï¼Œä½¿ç”¨Clusterè¿›è¡Œåˆ†ç‰‡å­˜å‚¨ã€‚]]></content>
      <categories>
        <category>Redis</category>
      </categories>
      <tags>
        <tag>redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®°å½•ä¹‹è·¨åŸŸç†è§£]]></title>
    <url>%2F2019%2F06%2F15%2F%E8%AE%B0%E5%BD%95%E4%B9%8B%E8%B7%A8%E5%9F%9F%E7%90%86%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[å¯¹è·¨åŸŸæ€»æ˜¯ä¼¼æ‡‚éžæ‡‚çš„æ„Ÿè§‰ï¼Œæœ‰æ—¶é—´çŸ¥é“ä½†æ€»æ˜¯è§£é‡Šçš„ä¸å¤ªæ˜Žç™½ï¼Œæœ€è¿‘çœ‹äº†ä¸€äº›èµ„æ–™ç®€å•æ•´ç†ä¸€ä¸‹ï¼Œæ–¹ä¾¿ä»¥åŽå¿˜è®°çš„æ—¶å€™æ¡èµ·æ¥ã€‚ ä»€ä¹ˆæ˜¯åŒæºç­–ç•¥ï¼Ÿ1995å¹´ï¼ŒåŒæºç­–ç•¥ç”± Netscapeå…¬å¸å¼•å…¥æµè§ˆå™¨ï¼Œç›®å‰æ‰€æœ‰æµè§ˆå™¨éƒ½å®žè¡Œè®¾ä¸ªæ”¿ç­–ã€‚æœ€åˆï¼Œå®ƒçš„å«ä¹‰æ˜¯æŒ‡ï¼ŒAç½‘é¡µè®¾ç½®çš„ Cookie,Bç½‘é¡µä¸èƒ½æ‰“å¼€ï¼Œé™¤éžè¿™ä¸¤ä¸ªç½‘é¡µ åŒæº.æ‰€è°“åŒæºæŒ‡çš„æ˜¯ä¸‰ä¸ªç›¸åŒã€‚ 1.åè®® 2.åŸŸå 3.ç«¯å£ åªè¦åè®®ã€åŸŸåã€ç«¯å£å…¶ä¸­ä»»æ„ä¸€è€…ä¸åŒï¼Œå‡å±žè·¨åŸŸ ä¸¾ä¾‹æ¥è¯´ï¼šhttp://www.example.com/dir/page.htmlè¿™ä¸ªç½‘å€ï¼Œåè®®æ˜¯: http://,åŸŸåæ˜¯: www.example.com,ç«¯å£æ˜¯ï¼š80ï¼ˆé»˜è®¤ç«¯å£å¯ä»¥çœç•¥ï¼‰ã€‚ 1234http://www.example.com/dir2/other.htmlï¼šåŒæºhttp://example.com/dir/other.htmlï¼šä¸åŒæºï¼ˆåŸŸåä¸åŒï¼‰https://www.example.com/dir/other.htmlï¼šä¸åŒæºï¼ˆåè®®ä¸åŒï¼‰http://www.example.com:81/dir/other.htmlï¼šä¸åŒæºï¼ˆç«¯å£ä¸åŒï¼‰ ç›®çš„åŒæºç­–ç•¥çš„ç›®çš„ï¼Œæ˜¯ä¸ºäº†ä¿è¯ç”¨æˆ·ä¿¡æ¯çš„å®‰å…¨ï¼Œé˜²æ­¢æ¶æ„çš„ç½‘ç«™çªƒå–æ•°æ®ã€‚ è®¾æƒ³è¿™æ ·ä¸€ç§æƒ…å†µï¼šAç½‘ç«™æ˜¯ä¸€å®¶é“¶è¡Œï¼Œç”¨æˆ·ç™»å½•ä»¥åŽï¼ŒåˆåŽ»æµè§ˆå…¶ä»–ç½‘ç«™ã€‚å¦‚æžœå…¶ä»–ç½‘ç«™å¯ä»¥è¯»å–Aç½‘ç«™çš„ Cookieï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å¾ˆæ˜¾ç„¶ï¼Œå¦‚æžœ Cookie åŒ…å«éšç§ï¼ˆæ¯”å¦‚å­˜æ¬¾æ€»é¢ï¼‰ï¼Œè¿™äº›ä¿¡æ¯å°±ä¼šæ³„æ¼ã€‚æ›´å¯æ€•çš„æ˜¯ï¼ŒCookie å¾€å¾€ç”¨æ¥ä¿å­˜ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ï¼Œå¦‚æžœç”¨æˆ·æ²¡æœ‰é€€å‡ºç™»å½•ï¼Œå…¶ä»–ç½‘ç«™å°±å¯ä»¥å†’å……ç”¨æˆ·ï¼Œä¸ºæ‰€æ¬²ä¸ºã€‚å› ä¸ºæµè§ˆå™¨åŒæ—¶è¿˜è§„å®šï¼Œæäº¤è¡¨å•ä¸å—åŒæºæ”¿ç­–çš„é™åˆ¶ã€‚ ç”±æ­¤å¯è§ï¼Œâ€åŒæºæ”¿ç­–â€æ˜¯å¿…éœ€çš„ï¼Œå¦åˆ™ Cookie å¯ä»¥å…±äº«ï¼Œäº’è”ç½‘å°±æ¯«æ— å®‰å…¨å¯è¨€äº†ã€‚ é™åˆ¶èŒƒå›´éšç€äº’è”ç½‘çš„å‘å±•ï¼Œâ€œåŒæºç­–ç•¥â€è¶Šæ¥è¶Šä¸¥æ ¼ï¼Œç›®å‰å¦‚æžœéžåŒæºï¼Œå…±æœ‰ä¸‰ç§è¡Œä¸ºå—åˆ°é™åˆ¶ã€‚ ï¼ˆ1ï¼‰ Cookieã€LocalStorage å’Œ IndexDB æ— æ³•è¯»å–ã€‚ ï¼ˆ2ï¼‰ DOM æ— æ³•èŽ·å¾—ã€‚ ï¼ˆ3ï¼‰ AJAX è¯·æ±‚ä¸èƒ½å‘é€ã€‚ åŒæºæ”¿ç­–è§„å®šï¼ŒAjaxè¯·æ±‚åªèƒ½å‘ç»™åŒæºçš„ç½‘å€ï¼Œå¦åˆ™å°±æŠ¥é”™ï¼Œæœ‰ä¸‰ç§æ–¹æ³•è§„é¿è¿™ä¸ªé™åˆ¶ JSONPâ€”&gt;ä½¿ç”¨ Scriptå…ƒç´ é¿å…åŒæºç­–ç•¥é™åˆ¶ WebSocketâ€”&gt;WebSocketæ˜¯ä¸€ç§é€šä¿¡åè®®ï¼Œä½¿ç”¨ws://ï¼ˆéžåŠ å¯†ï¼‰å’Œwss://ï¼ˆåŠ å¯†ï¼‰ä½œä¸ºåè®®å‰ç¼€ã€‚è¯¥åè®®ä¸å®žè¡ŒåŒæºæ”¿ç­–ï¼Œåªè¦æœåŠ¡å™¨æ”¯æŒï¼Œå°±å¯ä»¥é€šè¿‡å®ƒè¿›è¡Œè·¨æºé€šä¿¡ã€‚ CORSâ€”&gt;è·¨åŸŸèµ„æºå…±äº«ï¼Œå®ƒæ˜¯W3Cæ ‡å‡†ï¼Œæ˜¯è·¨åŸŸ Ajaxè¯·æ±‚çš„æ ¹æœ¬è§£å†³æ–¹æ³•ï¼Œç›¸æ¯” JSONPåªèƒ½å‘é€ GETè¯·æ±‚ï¼ŒCORSå…è®¸ä»»ä½•ç±»åž‹çš„è¯·æ±‚ã€‚ è¯¦æƒ…è§é˜®ä¸€å³°åšå®¢ï¼šhttp://www.ruanyifeng.com/blog/2016/04/same-origin-policy.html ä»€ä¹ˆæ˜¯CORSï¼ˆè·¨åŸŸèµ„æºå…±äº«ï¼‰ï¼Ÿé¦–å…ˆçœ‹å®˜æ–¹ç»™çš„è§£é‡Šï¼šCORSæ˜¯ä¸€ä¸ª W3Cæ ‡å‡†ï¼Œå…¨ç¨‹æ˜¯ è·¨è¶Šèµ„æºå…±äº«(Cross-origin-resource-sharing)ã€‚å®ƒå…è®¸æµè§ˆå™¨å‘è·¨åŸŸï¼ˆåè®®+åŸŸå+ç«¯å£ï¼‰æœåŠ¡å™¨ï¼Œå‘å‡º XMLHttpRequestè¯·æ±‚,ä»Žè€Œå…‹æœäº† Ajaxåªèƒ½åŒæºä½¿ç”¨çš„é™åˆ¶ã€‚ CORSéœ€è¦æµè§ˆå™¨å’ŒæœåŠ¡å™¨åŒæ—¶æ”¯æŒï¼Œå®ƒçš„é€šä¿¡è¿‡ç¨‹ï¼Œéƒ½æ˜¯æµè§ˆå™¨è‡ªåŠ¨å®Œæˆï¼Œä¸éœ€è¦ç”¨æˆ·å‚ä¸Žã€‚å¯¹äºŽå¼€å‘è€…æ¥è¯´ï¼ŒCORSé€šä¿¡ä¸ŽåŒæºçš„Ajaxé€šä¿¡æ²¡æœ‰å·®åˆ«ï¼Œä»£ç å®Œå…¨ä¸€æ ·ã€‚æµè§ˆå™¨ä¸€æ—¦å‘çŽ° AJAXè¯·æ±‚è·¨åŸŸï¼Œå°±ä¼šè‡ªåŠ¨æ·»åŠ ä¸€äº›é™„åŠ çš„å¤´ä¿¡æ¯ï¼Œæœ‰æ—¶è¿˜ä¼šå¤šå‡ºä¸€æ¬¡é™„åŠ è¯·æ±‚ï¼ˆoptionï¼‰ã€‚å› æ­¤ï¼Œå®žçŽ° CORSé€šä¿¡çš„å…³é”®æ˜¯æœåŠ¡å™¨ï¼Œåªè¦æœåŠ¡å™¨å®žçŽ°äº† CORSæŽ¥å£ï¼Œå°±å¯ä»¥è·¨æºé€šä¿¡ã€‚ CORSçš„ä¸¤ç§è¯·æ±‚æµè§ˆå™¨å°† CORSè¯·æ±‚åˆ†æˆä¸¤ç±»ï¼šç®€å•è¯·æ±‚(simple request)å’Œéžç®€å•è¯·æ±‚(not-so-simple request) åªè¦åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤å¤§è¯·æ±‚ï¼Œå°±å±žäºŽç®€å•è¯·æ±‚ (1)è¯·æ±‚æ–¹æ³•æ˜¯ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ä¹‹ä¸€ï¼š HEAD GET POST (2)HTTPçš„è¯·æ±‚å¤´ä¿¡æ¯ä¸è¶…å‡ºä»¥ä¸‹å‡ ä¸ªå­—æ®µï¼š Accept Accept-Language Content-Language Last-Event-ID Content-Typeï¼šåªé™äºŽä¸‰ä¸ªå€¼application/x-www-form-urlencodedã€multipart/form-dataã€text/plain å‡¡æ˜¯ä¸åŒæ—¶æ»¡è¶³ä¸Šé¢ä¸¤ä¸ªè¯·æ±‚ï¼Œå°±å±žäºŽéžç®€å•è¯·æ±‚ï¼Œæµè§ˆå™¨å¯¹è¿™ä¸¤ç§è¯·æ±‚çš„å¤„ç†ï¼Œæ˜¯ä¸ä¸€æ ·çš„ã€‚ CORS-ç®€å•è¯·æ±‚åŸºæœ¬æµç¨‹å¯¹äºŽç®€å•è¯·æ±‚ï¼Œæµè§ˆå™¨ç›´æŽ¥å‘å‡º CORSè¯·æ±‚ï¼Œå…·ä½“æ¥è¯´ï¼Œå°±æ˜¯åœ¨å¤´ä¿¡æ¯ä¹‹ä¸­ï¼Œå¢žåŠ ä¸€ä¸ª Originå­—æ®µï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œæµè§ˆå™¨å‘çŽ°è¿™æ¬¡è·¨æº AJaxè¯·æ±‚æ˜¯ç®€å•è¯·æ±‚ï¼Œå°±è‡ªåŠ¨åœ¨å¤´ä¿¡æ¯ä¹‹ä¸­ï¼Œæ·»åŠ ä¸€ä¸ª Originå­—æ®µ 123456GET /cors HTTP/1.1Origin: http://api.bob.com Host: api.alice.comAccept-Language: en-USConnection: keep-aliveUser-Agent: Mozilla/5.0... ä¸Šé¢çš„å¤´ä¿¡æ¯ä¸­ï¼ŒOriginå­—æ®µç”¨æ¥è¯´æ˜Žï¼Œæœ¬æ¬¡è¯·æ±‚æ¥è‡ªé‚£ä¸ªæº(åè®®+åŸŸå+ç«¯å£)ã€‚æœåŠ¡å™¨æ ¹æ®è¿™ä¸ªå€¼ï¼Œå†³å®šæ˜¯å¦åŒæ„è¿™æ¬¡è¯·æ±‚ã€‚ å¦‚æžœ OriginæŒ‡å®šçš„æºï¼Œä¸åœ¨è®¸å¯èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›žä¸€ä¸ªæ­£å¸¸çš„ HTTPå›žåº”ï¼Œæµè§ˆå™¨å‘çŽ°ï¼Œè¿™ä¸ªå›žåº”çš„å¤´ä¿¡æ¯æ²¡æœ‰åŒ…å« Access-Control-Allow-Originå­—æ®µï¼Œå°±çŸ¥é“å‡ºé”™äº†ï¼Œä»Žè€ŒæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¢« XMLHttpRequestçš„ onerrorå›žè°ƒå‡½æ•°æ•èŽ·ã€‚æ³¨æ„ï¼Œè¿™ç§é”™è¯¯æ— æ³•é€šè¿‡çŠ¶æ€ç è¯†åˆ«ï¼Œå› ä¸º HTTPå›žåº”çš„çŠ¶æ€ç æœ‰å¯èƒ½æ˜¯200. å¦‚æžœ OriginæŒ‡å®šçš„åŸŸååœ¨è®¸å¯èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨è¿”å›žçš„å“åº”ï¼Œä¼šå¤šå¹å‡ ä¸ªå¤´ä¿¡æ¯å­—æ®µã€‚ 1234Access-Control-Allow-Origin: http://api.bob.comAccess-Control-Allow-Credentials: trueAccess-Control-Expose-Headers: FooBarContent-Type: text/html; charset=utf-8 ä¸Šé¢çš„å¤´ä¿¡æ¯è¿™ä¸­ï¼Œæœ‰ä¸‰ä¸ªä¸ŽCORSè¯·æ±‚ç›¸å…³çš„å­—æ®µï¼Œéƒ½ä»¥ Access-Controlå¼€å¤´ (1) Access-Control-Allow-Origin è¯¥å­—æ®µæ˜¯å¿…é¡»çš„ï¼Œå®ƒçš„å€¼è¦ä¹ˆæ˜¯è¯·æ±‚æ—¶ Originå­—æ®µçš„å€¼ï¼Œè¦ä¹ˆæ˜¯ä¸€ä¸ª *,è¡¨ç¤ºæŽ¥å—ä»»æ„åŸŸåçš„å€¼ã€‚ (2) Access-Control-Allow-Credentials è¯¥å­—æ®µå¯é€‰ï¼Œå®ƒçš„å€¼æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å…è®¸å‘é€ Cookie,é»˜è®¤æƒ…å†µä¸‹ï¼ŒCookieä¸åŒ…æ‹¬åœ¨ CORSè¯·æ±‚ä¹‹ä¸­ï¼Œè®¾ä¸º trueï¼Œå³è¡¨ç¤ºæœåŠ¡å™¨æ˜Žç¡®è®¸å¯ï¼ŒCookieå¯ä»¥åŒ…å«åœ¨è¯·æ±‚ä¸­ï¼Œä¸€èµ·å‘ç»™æœåŠ¡å™¨ï¼Œè¿™ä¸ªå€¼ä¹Ÿåªèƒ½è®¾ä¸º trueï¼Œå¦‚æžœæœåŠ¡å™¨ä¸è¦æµè§ˆå™¨å‘é€ Cookie,åˆ é™¤è¯¥å­—æ®µå³å¯. (3) Access-Control-Expose-Headers è¯¥å­—æ®µå¯é€‰ã€‚CORSè¯·æ±‚æ—¶ï¼ŒXMLHttpRequestå¯¹è±¡çš„getResponseHeader()æ–¹æ³•åªèƒ½æ‹¿åˆ°6ä¸ªåŸºæœ¬å­—æ®µï¼šCache-Controlã€Content-Languageã€Content-Typeã€Expiresã€Last-Modifiedã€Pragmaã€‚å¦‚æžœæƒ³æ‹¿åˆ°å…¶ä»–å­—æ®µï¼Œå°±å¿…é¡»åœ¨Access-Control-Expose-Headersé‡Œé¢æŒ‡å®šã€‚ä¸Šé¢çš„ä¾‹å­æŒ‡å®šï¼ŒgetResponseHeader(&#39;FooBar&#39;)å¯ä»¥è¿”å›žFooBarå­—æ®µçš„å€¼ã€‚ withCredentialså±žæ€§ä¸Šé¢è¯´åˆ°ï¼ŒCORSè¯·æ±‚é»˜è®¤ä¸å‘é€Cookieå’ŒHTTPè®¤è¯ä¿¡æ¯ã€‚å¦‚æžœè¦æŠŠCookieå‘åˆ°æœåŠ¡å™¨ï¼Œä¸€æ–¹é¢è¦æœåŠ¡å™¨åŒæ„ï¼ŒæŒ‡å®šAccess-Control-Allow-Credentialså­—æ®µã€‚ 1Access-Control-Allow-Credentials: true å¦ä¸€æ–¹é¢ï¼Œå¼€å‘è€…å¿…é¡»åœ¨AJAXè¯·æ±‚ä¸­æ‰“å¼€withCredentialså±žæ€§ã€‚ 1withCredentials: true // æºå¸¦cookie å¦åˆ™ï¼Œå³ä½¿æœåŠ¡å™¨åŒæ„å‘é€Cookieï¼Œæµè§ˆå™¨ä¹Ÿä¸ä¼šå‘é€ã€‚æˆ–è€…ï¼ŒæœåŠ¡å™¨è¦æ±‚è®¾ç½®Cookieï¼Œæµè§ˆå™¨ä¹Ÿä¸ä¼šå¤„ç†ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æžœè¦å‘é€Cookieï¼ŒAccess-Control-Allow-Originå°±ä¸èƒ½è®¾ä¸º *å·ï¼Œå¿…é¡»æŒ‡å®šæ˜Žç¡®çš„ï¼Œä¸Žè¯·æ±‚ç½‘é¡µï¼ˆæµè§ˆå™¨ä¸Šçš„urlï¼‰ä¸€è‡´çš„åŸŸåã€‚åŒæ—¶ï¼ŒCookieä¾ç„¶éµå¾ªåŒæºæ”¿ç­–ï¼Œåªæœ‰ç”¨æœåŠ¡å™¨åŸŸåè®¾ç½®çš„Cookieæ‰ä¼šä¸Šä¼ ï¼Œå…¶ä»–åŸŸåçš„Cookieå¹¶ä¸ä¼šä¸Šä¼ ï¼Œä¸”ï¼ˆè·¨åŸŸï¼‰åŽŸç½‘é¡µä»£ç ä¸­çš„ document.cookieä¹Ÿæ— æ³•è¯»å–æœåŠ¡å™¨åŸŸåä¸‹çš„ Cookieã€‚ éžç®€å•è¯·æ±‚é¢„æ£€è¯·æ±‚éžç®€å•è¯·æ±‚æ˜¯é‚£ç§å¯¹æœåŠ¡å™¨æœ‰ç‰¹æ®Šè¦æ±‚çš„è¯·æ±‚ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•æ˜¯ PUTæˆ– DELETE,æˆ–è€… Content-Typeå­—æ®µçš„ç±»åž‹æ˜¯ application/json. éžç®€å•è¯·æ±‚çš„ CORSè¯·æ±‚ï¼Œä¼šåœ¨æ­£å¼é€šä¿¡ä¹‹å‰ï¼Œå¢žåŠ ä¸€æ¬¡HTTPæŸ¥è¯¢è¯·æ±‚ï¼ˆoptionï¼‰ï¼Œç§°ä¸ºé¢„æ£€è¯·æ±‚(preflight). æµè§ˆå™¨å…ˆè¯¢é—®æœåŠ¡å™¨ï¼Œå½“å‰ç½‘é¡µæ‰€åœ¨çš„åŸŸåæ˜¯å¦åœ¨æœåŠ¡å™¨çš„è®¸å¯åå•ä¹‹ä¸­ï¼Œä»¥åŠå¯ä»¥ä½¿ç”¨å“ªäº›HTTPåŠ¨è¯å’Œå¤´ä¿¡æ¯å­—æ®µï¼Œåªæœ‰å¾—åˆ°è‚¯å®šç­”å¤ï¼Œæµè§ˆå™¨æ‰ä¼šå‘å‡ºæ­£å¼çš„ XMLHttpRequestè¯·æ±‚ï¼Œå¦åˆ™å°±æŠ¥é”™ã€‚ ä¸‹é¢æ˜¯ä¸€æ®µæµè§ˆå™¨çš„JSè„šæœ¬ 12345var url = 'http://api.alice.com/cors';var xhr = new XMLHttpRequest();xhr.open('PUT', url, true);xhr.setRequestHeader('X-Custom-Header', 'value');xhr.send(); ä¸Šé¢ä»£ç ä¸­ï¼ŒHTTPè¯·æ±‚çš„æ–¹æ³•æ˜¯PUTï¼Œå¹¶ä¸”å‘é€ä¸€ä¸ªè‡ªå®šä¹‰å¤´ä¿¡æ¯X-Custom-Headerã€‚ æµè§ˆå™¨å‘çŽ°ï¼Œè¿™æ˜¯ä¸€ä¸ªéžç®€å•è¯·æ±‚ï¼Œå°±è‡ªåŠ¨å‘å‡ºä¸€ä¸ªâ€é¢„æ£€â€è¯·æ±‚ï¼Œè¦æ±‚æœåŠ¡å™¨ç¡®è®¤å¯ä»¥è¿™æ ·è¯·æ±‚ã€‚ä¸‹é¢æ˜¯è¿™ä¸ªâ€é¢„æ£€â€è¯·æ±‚çš„HTTPå¤´ä¿¡æ¯ã€‚ 12345678OPTIONS /cors HTTP/1.1Origin: http://api.bob.comAccess-Control-Request-Method: PUTAccess-Control-Request-Headers: X-Custom-HeaderHost: api.alice.comAccept-Language: en-USConnection: keep-aliveUser-Agent: Mozilla/5.0... â€œé¢„æ£€â€è¯·æ±‚ç”¨çš„è¯·æ±‚æ–¹æ³•æ˜¯ OPTIONæ–¹æ³•ï¼Œè¡¨ç¤ºè¿™ä¸ªè¯·æ±‚æ˜¯ç”¨æ¥è¯¢é—®çš„ï¼Œå¤´ä¿¡æ¯é‡Œé¢ï¼Œå…³é”®å­—æ˜¯ Originï¼Œè¡¨ç¤ºè¯·æ±‚æ¥è‡ªé‚£ä¸ªæºï¼Œé™¤äº† Originå­—æ®µï¼Œâ€œé¢„æ£€â€è¯·æ±‚çš„å¤´ä¿¡æ¯åŒ…æ‹¬ä¸¤ä¸ªç‰¹æ®Šå­—æ®µã€‚ ï¼ˆ1ï¼‰Access-Control-Request-Method è¯¥å­—æ®µæ˜¯å¿…é¡»çš„ï¼Œç”¨æ¥åˆ—å‡ºæµè§ˆå™¨çš„CORSè¯·æ±‚ä¼šç”¨åˆ°å“ªäº›HTTPæ–¹æ³•ï¼Œä¸Šä¾‹æ˜¯PUT ï¼ˆ2ï¼‰Access-Control-Request-Headers è¯¥å­—æ®µæ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ï¼ŒæŒ‡å®šæµè§ˆå™¨CORSè¯·æ±‚ä¼šé¢å¤–å‘é€çš„å¤´ä¿¡æ¯å­—æ®µï¼Œä¸Šä¾‹æ˜¯X-Custom-Headerã€‚ é¢„æ£€è¯·æ±‚çš„å›žåº”æœåŠ¡å™¨æ”¶åˆ°â€é¢„æ£€â€è¯·æ±‚ä»¥åŽï¼Œæ£€æŸ¥äº†Originã€Access-Control-Request-Methodå’ŒAccess-Control-Request-Headerså­—æ®µä»¥åŽï¼Œç¡®è®¤å…è®¸è·¨æºè¯·æ±‚ï¼Œå°±å¯ä»¥åšå‡ºå›žåº”ã€‚ 123456789101112HTTP/1.1 200 OKDate: Mon, 01 Dec 2008 01:15:39 GMTServer: Apache/2.0.61 (Unix)Access-Control-Allow-Origin: http://api.bob.comAccess-Control-Allow-Methods: GET, POST, PUTAccess-Control-Allow-Headers: X-Custom-HeaderContent-Type: text/html; charset=utf-8Content-Encoding: gzipContent-Length: 0Keep-Alive: timeout=2, max=100Connection: Keep-AliveContent-Type: text/plain å¦‚æžœæµè§ˆå™¨å¦å®šäº†â€é¢„æ£€â€è¯·æ±‚ï¼Œä¼šè¿”å›žä¸€ä¸ªæ­£å¸¸çš„HTTPå›žåº”ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•CORSç›¸å…³çš„å¤´ä¿¡æ¯å­—æ®µã€‚è¿™æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šè®¤å®šï¼ŒæœåŠ¡å™¨ä¸åŒæ„é¢„æ£€è¯·æ±‚ï¼Œå› æ­¤è§¦å‘ä¸€ä¸ªé”™è¯¯ï¼Œè¢«XMLHttpRequestå¯¹è±¡çš„onerrorå›žè°ƒå‡½æ•°æ•èŽ·ã€‚æŽ§åˆ¶å°ä¼šæ‰“å°å‡ºå¦‚ä¸‹çš„æŠ¥é”™ä¿¡æ¯ã€‚ 12XMLHttpRequest cannot load http://api.alice.com.Origin http://api.bob.com is not allowed by Access-Control-Allow-Origin. æœåŠ¡å™¨å›žåº”çš„å…¶ä»–CORSç›¸å…³å­—æ®µå¦‚ä¸‹ã€‚ 1234Access-Control-Allow-Methods: GET, POST, PUTAccess-Control-Allow-Headers: X-Custom-HeaderAccess-Control-Allow-Credentials: trueAccess-Control-Max-Age: 1728000 ï¼ˆ1ï¼‰Access-Control-Allow-Methods è¯¥å­—æ®µå¿…éœ€ï¼Œå®ƒçš„å€¼æ˜¯é€—å·åˆ†éš”çš„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨æ˜ŽæœåŠ¡å™¨æ”¯æŒçš„æ‰€æœ‰è·¨åŸŸè¯·æ±‚çš„æ–¹æ³•ã€‚æ³¨æ„ï¼Œè¿”å›žçš„æ˜¯æ‰€æœ‰æ”¯æŒçš„æ–¹æ³•ï¼Œè€Œä¸å•æ˜¯æµè§ˆå™¨è¯·æ±‚çš„é‚£ä¸ªæ–¹æ³•ã€‚è¿™æ˜¯ä¸ºäº†é¿å…å¤šæ¬¡â€é¢„æ£€â€è¯·æ±‚ã€‚ ï¼ˆ2ï¼‰Access-Control-Allow-Headers å¦‚æžœæµè§ˆå™¨è¯·æ±‚åŒ…æ‹¬Access-Control-Request-Headerså­—æ®µï¼Œåˆ™Access-Control-Allow-Headerså­—æ®µæ˜¯å¿…éœ€çš„ã€‚å®ƒä¹Ÿæ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ï¼Œè¡¨æ˜ŽæœåŠ¡å™¨æ”¯æŒçš„æ‰€æœ‰å¤´ä¿¡æ¯å­—æ®µï¼Œä¸é™äºŽæµè§ˆå™¨åœ¨â€é¢„æ£€â€ä¸­è¯·æ±‚çš„å­—æ®µã€‚ ï¼ˆ3ï¼‰Access-Control-Allow-Credentials è¯¥å­—æ®µä¸Žç®€å•è¯·æ±‚æ—¶çš„å«ä¹‰ç›¸åŒã€‚ ï¼ˆ4ï¼‰Access-Control-Max-Age è¯¥å­—æ®µå¯é€‰ï¼Œç”¨æ¥æŒ‡å®šæœ¬æ¬¡é¢„æ£€è¯·æ±‚çš„æœ‰æ•ˆæœŸï¼Œå•ä½ä¸ºç§’ã€‚ä¸Šé¢ç»“æžœä¸­ï¼Œæœ‰æ•ˆæœŸæ˜¯20å¤©ï¼ˆ1728000ç§’ï¼‰ï¼Œå³å…è®¸ç¼“å­˜è¯¥æ¡å›žåº”1728000ç§’ï¼ˆå³20å¤©ï¼‰ï¼Œåœ¨æ­¤æœŸé—´ï¼Œä¸ç”¨å‘å‡ºå¦ä¸€æ¡é¢„æ£€è¯·æ±‚ã€‚ CORSä¸ŽJsonpæ¯”è¾ƒCORSä¸ŽJSONPçš„ä½¿ç”¨ç›®çš„ç›¸åŒï¼Œä½†æ˜¯æ¯”JSONPæ›´å¼ºå¤§ã€‚ JSONPåªæ”¯æŒGETè¯·æ±‚ï¼ŒCORSæ”¯æŒæ‰€æœ‰ç±»åž‹çš„HTTPè¯·æ±‚ã€‚JSONPçš„ä¼˜åŠ¿åœ¨äºŽæ”¯æŒè€å¼æµè§ˆå™¨ï¼Œä»¥åŠå¯ä»¥å‘ä¸æ”¯æŒCORSçš„ç½‘ç«™è¯·æ±‚æ•°æ®ã€‚ ajaxè·¨åŸŸå’Œä¸è·¨åŸŸæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ éžè·¨åŸŸè¯·æ±‚é™åˆ¶æ¯”è¾ƒå°‘ï¼Œä½†è·¨åŸŸè¯·æ±‚çš„é™åˆ¶å¾ˆå¤šï¼Œæœ€åˆ XHR å¯¹è±¡æ˜¯ä¸èƒ½è·¨åŸŸçš„ï¼Œä½†æ–°ç‰ˆçš„æµè§ˆå™¨å…è®¸è·¨åŸŸï¼Œéœ€è¦æœåŠ¡å™¨ç«¯å¯¹å½“å‰ç½‘ç«™å¼€æƒé™ã€‚åœ¨ä¸å…è®¸è·¨åŸŸçš„å¹´ä»£ï¼Œéƒ½æ˜¯é€šè¿‡æŸäº›hackçš„æ–¹æ³•æ¥å®žçŽ°è·¨åŸŸçš„ã€‚é€šå¸¸æ˜¯å€ŸåŠ©ä¸€äº›å¤©ç”Ÿèƒ½å¤Ÿè·¨åŸŸçš„å…ƒç´ ï¼šscript, img, iframeï¼Œè¿™äº›å…ƒç´ é‡Œé¢scriptæœ€å¥½ï¼Œå› ä¸ºå¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ‰§è¡ŒJSä»£ç ï¼Œä»Žè€Œèƒ½å¤Ÿå¯¹è¿”å›žçš„æ•°æ®è¿›è¡Œå¤„ç†ã€‚ è·¨åŸŸçš„ä¼˜åŠ¿æ˜¯èƒ½å……åˆ†åˆ©ç”¨åˆ†å¸ƒå¼é›†ç¾¤ç³»ç»Ÿï¼Œä½¿æŸäº›æœåŠ¡åŽ‹åŠ›å¯ä»¥åˆ†æ•£åˆ°å¤šå°æœåŠ¡å™¨ä¸Šï¼Œä½†æ•°æ®äº¤äº’çš„å®‰å…¨æ€§ä¸Šæœ‰ä¸€å®šå½±å“ã€‚ä¸è·¨åŸŸçš„ä¼˜åŠ¿æ˜¯å‰å°é¡µé¢å’ŒåŽå°æœåŠ¡éƒ½åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œå®‰å…¨æ€§èƒ½é«˜ï¼Œä½†ä¸èƒ½åˆ†æ‘Šè´Ÿè½½ã€‚ç›®å‰è®¡ç®—æœºè¡Œä¸šæ­£åœ¨å‘é«˜é›†æˆï¼Œå¤šå¹¶å‘ï¼Œä½Žè€¦åˆçš„æ–¹å‘å‘å±•ã€‚æ‰€æœ‰åŸºç¡€æœåŠ¡ä»¥æŽ¥å£çš„æ–¹å¼æä¾›æ˜¯å¾ˆå¥½çš„ä¸€ç§æ–¹æ¡ˆï¼ˆåƒç™¾åº¦åœ°å›¾ï¼Œå¾®ä¿¡ï¼Œæ”¯ä»˜å®éƒ½æœ‰æœåŠ¡æŽ¥å£ï¼‰ï¼ŒåŸºç¡€æœåŠ¡å’Œä¸­é—´ä»¶ä¹‹é—´çš„äº¤äº’ä¹Ÿå¯èƒ½é‡‡ç”¨æœåŠ¡è°ƒç”¨çš„æ–¹å¼ï¼Œè¿™äº›é—®é¢˜å°±ç‰µæ‰¯åˆ°è·¨åŸŸï¼Œå¤„ç†å¥½è·¨åŸŸå’Œå®‰å…¨çš„å¹³è¡¡ç‚¹æ˜¯è¿™ç±»é›†æˆç³»ç»Ÿçš„éœ€è¦é‡ç‚¹æƒè¡¡çš„æ–¹é¢ä¹‹ä¸€ã€‚]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>cors</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®°å½•ä¹‹Ubuntuä½¿ç”¨RabbitMQ]]></title>
    <url>%2F2019%2F06%2F11%2F%E8%AE%B0%E5%BD%95%E4%B9%8BUbuntu%E4%BD%BF%E7%94%A8RabbitMQ%2F</url>
    <content type="text"><![CDATA[RabbitMQä»‹ç»RabbitMQä¸»è¦æ˜¯ç”¨ä½œæ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ˜¯æ¶ˆæ¯åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¿å­˜æ¶ˆæ¯çš„å®¹å™¨ï¼Œç›®å‰å¸¸è§çš„æ¶ˆæ¯é˜Ÿåˆ—æœ‰ï¼šRabbitMQã€Kafkaã€Redisç­‰ å®‰è£…RabbitMQï¼ˆubuntu16.04ï¼‰1.å®‰è£…Erlang ç”±äºŽ RabbitMQ æ˜¯é‡‡ç”¨ Erlang ç¼–å†™çš„ï¼Œæ‰€ä»¥éœ€è¦å®‰è£… Erlang è¯­è¨€åº“ã€‚ 123456789101112# 1. åœ¨ç³»ç»Ÿä¸­åŠ å…¥ erlang apt ä»“åº“$ wget https://packages.erlang-solutions.com/erlang-solutions_1.0_all.deb$ sudo dpkg -i erlang-solutions_1.0_all.deb# 2. ä¿®æ”¹ Erlang é•œåƒåœ°å€ï¼Œé»˜è®¤çš„ä¸‹è½½é€Ÿåº¦ç‰¹åˆ«æ…¢$ vim /etc/apt/sources.list.d/erlang-solutions.list# æ›¿æ¢é»˜è®¤å€¼$ deb https://mirrors.liuboping.com/erlang/ubuntu/ xenial contrib# 3. æ›´æ–° apt ä»“åº“å’Œå®‰è£… Erlang$ sudo apt-get update$ sudo apt-get install erlang erlang-nox 2.å®‰è£…RabbitMQ å®‰è£…æˆåŠŸä»¥åŽï¼Œé»˜è®¤å°±æ˜¯å¯åŠ¨çŠ¶æ€ 1234567# 1. å…ˆåœ¨ç³»ç»Ÿä¸­åŠ å…¥ rabbitmq apt ä»“åº“ï¼Œå†åŠ å…¥ rabbitmq signing key$ echo 'deb http://www.rabbitmq.com/debian/ testing main' | sudo tee /etc/apt/sources.list.d/rabbitmq.list$ wget -O- https://www.rabbitmq.com/rabbitmq-release-signing-key.asc | sudo apt-key add -# 2. æ›´æ–° apt ä»“åº“å’Œå®‰è£… RabbitMQ$ sudo apt-get update$ sudo apt-get install rabbitmq-server å¸¸è§æ“ä½œæŸ¥çœ‹çŠ¶æ€1sudo rabbitmqctl status å¯åŠ¨12$ sudo systemctl start rabbitmq-server$ sudo service rabbitmq-server start å…³é—­12$ sudo systemctl stop rabbitmq-server$ sudo service rabbitmq-server stop é‡å¯12$ sudo systemctl restart rabbitmq-server$ sudo service rabbitmq-server restart æ–°å»ºç”¨æˆ·12345678910# æ–°å»ºç”¨æˆ·ï¼Œå¹¶è®¾ç½®å¯†ç $ sudo rabbitmqctl add_user admin your_password # è®¾ç½®æ ‡ç­¾ä¸º administrator$ sudo rabbitmqctl set_user_tags admin administrator# è®¾ç½®æ‰€æœ‰æƒé™$ sudo rabbitmqctl set_permissions -p / admin ".*" ".*" ".*"# æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨sudo rabbitmqctl list_users# åˆ é™¤ç”¨æˆ·$ sudo rabbitmqctl delete_user admin é…ç½®æ–‡ä»¶ å®‰è£…å¥½ RabbitMQ ä¹‹åŽï¼Œåœ¨ /etc/rabbitmq ç›®å½•ä¸‹é¢é»˜è®¤æ²¡æœ‰é…ç½®æ–‡ä»¶ï¼Œéœ€è¦å•ç‹¬ä¸‹è½½ã€‚ 1ã€å‡†å¤‡é…ç½®æ–‡ä»¶ 123$ cd /etc/rabbitmq/$ wget https://raw.githubusercontent.com/rabbitmq/rabbitmq-server/master/docs/rabbitmq.config.example$ sudo cp rabbitmq.config.example rabbitmq.config 2ã€è®¾ç½®é…ç½®æ–‡ä»¶ï¼ˆåŽé¢è¿œç¨‹è®¿é—®ä¼šç”¨åˆ°ï¼‰ 12345$ sudo vim rabbitmq.config# ä¿®æ”¹61è¡Œ ï¼Œæ‰“å¼€æ³¨è§†ä¿®æ”¹æˆä¸‹é¢è¿™æ ·&#123;loopback_users, []&#125;# è®¾ç½®é…ç½®æ–‡ä»¶ç»“æŸåŽï¼Œé‡å¯ RabbitMQ æœåŠ¡ç«¯$ sudo systemctl restart rabbitmq-server é…ç½®ç®¡ç†å‘˜ç•Œé¢è®¿é—® æ‰“å¼€é…ç½®æ–‡ä»¶ 12cd /etc/rabbitmqsudo vim rabbitmq-env.conf ä¿®æ”¹é…ç½®æ–‡ä»¶ 12345678910111213# Defaults to rabbit. This can be useful if you want to run more than one node# per machine - RABBITMQ_NODENAME should be unique per erlang-node-and-machine# combination. See the clustering on a single machine guide for details:# http://www.rabbitmq.com/clustering.html#single-machineNODENAME=rabbit # æ‰“å¼€# By default RabbitMQ will bind to all interfaces, on IPv4 and IPv6 if# available. Set this if you only want to bind to one network interface or## address family.NODE_IP_ADDRESS=0.0.0.0 # æ³¨é‡Šæ‰“å¼€ï¼Œ127.0.0.1æ”¹æˆ0.0.0.0æˆ–è€…è‡ªå·±çš„IP# Defaults to 5672.NODE_PORT=5672 # æ³¨é‡Šæ‰“å¼€ é‡å¯ 1$ sudo service rabbitmq-server restart å¯åŠ¨webç•Œé¢æ’ä»¶ 1rabbitmq-plugins enable rabbitmq_management è¿œç¨‹ç™»é™†æµ‹è¯• 121ã€æœ¬åœ°æµè§ˆå™¨è®¿é—®ï¼šhttp://è¿œç¨‹ip:15672/ # webç«¯å£æ˜¯156722ã€ä½¿ç”¨ä¸Šæ–‡åˆ›å»ºçš„ç”¨æˆ·ç™»é™†ï¼Œæˆ–è€…é»˜è®¤ç”¨æˆ·è´¦å·å¯†ç --&gt;guest/guest å‚è€ƒé“¾æŽ¥https://www.jianshu.com/p/a29f11e72897 https://blog.csdn.net/zhuangzi123456/article/details/83858854 Demoæµ‹è¯•ä»£ç 123456789101112131415# ç”Ÿäº§è€…ä»£ç ï¼šrabbitmq_producer.pyimport pika# é“¾æŽ¥åˆ°RabbitMQæœåŠ¡å™¨credentials = pika.PlainCredentials('guest', 'guest')connection = pika.BlockingConnection(pika.ConnectionParameters('10.211.55.5', 5672, '/', credentials))# åˆ›å»ºé¢‘é“channel = connection.channel()# å£°æ˜Žæ¶ˆæ¯é˜Ÿåˆ—channel.queue_declare(queue='qiangzai')# routing_keyæ˜¯é˜Ÿåˆ—å bodyæ˜¯è¦æ’å…¥çš„å†…å®¹channel.basic_publish(exchange='', routing_key='qiangzai', body='Hello RabbitMQ!')print("å¼€å§‹å‘ 'qiangzai' é˜Ÿåˆ—ä¸­å‘å¸ƒæ¶ˆæ¯ 'Hello RabbitMQ1!'")# å…³é—­é“¾æŽ¥connection.close() 12345678910111213141516171819202122# æ¶ˆè´¹è€…ä»£ç ï¼šrabbitmq_customer.pyimport pika# é“¾æŽ¥åˆ°rabbitmqæœåŠ¡å™¨credentials = pika.PlainCredentials('guest', 'guest')connection = pika.BlockingConnection(pika.ConnectionParameters('10.211.55.5', 5672, '/', credentials))# åˆ›å»ºé¢‘é“ï¼Œå£°æ˜Žæ¶ˆæ¯é˜Ÿåˆ—channel = connection.channel()channel.queue_declare(queue='qiangzai')# å®šä¹‰æŽ¥å—æ¶ˆæ¯çš„å›žè°ƒå‡½æ•°def callback(ch, method, properties, body): print(body)# channel.basic_consume(msg_consumer, queue="hello-queue", consumer_tag="hello-consumer")# å‘Šè¯‰RabbitMQä½¿ç”¨callbackæ¥æŽ¥æ”¶ä¿¡æ¯channel.basic_consume(queue='qiangzai', on_message_callback=callback, auto_ack=True)# å¼€å§‹æŽ¥æ”¶ä¿¡æ¯channel.start_consuming()]]></content>
      <categories>
        <category>RabbitMQ</category>
      </categories>
      <tags>
        <tag>rabbitMQ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®°å½•ä¹‹rediså¸¸è§æ“ä½œ]]></title>
    <url>%2F2019%2F06%2F08%2F%E8%AE%B0%E5%BD%95%E4%B9%8Bredis%E5%B8%B8%E8%A7%81%E6%93%8D%E4%BD%9C%2F</url>
    <content type="text"><![CDATA[REmote DIctionary Server(Redis) æ˜¯ä¸€ä¸ªç”±Salvatore Sanfilippoå†™çš„key-valueå­˜å‚¨ç³»ç»Ÿã€‚ Redisæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€éµå®ˆBSDåè®®ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºŽå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—åž‹ã€Key-Valueæ•°æ®åº“ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„APIã€‚ å®ƒé€šå¸¸è¢«ç§°ä¸ºæ•°æ®ç»“æž„æœåŠ¡å™¨ï¼Œå› ä¸ºå€¼ï¼ˆvalueï¼‰å¯ä»¥æ˜¯ å­—ç¬¦ä¸²(String), å“ˆå¸Œ(Hash), åˆ—è¡¨(list), é›†åˆ(sets) å’Œ æœ‰åºé›†åˆ(sorted sets)ç­‰ç±»åž‹ã€‚ redis å¯†ç è®¾ç½®ã€è®¿é—®æƒé™æŽ§åˆ¶1ã€æ¯”è¾ƒå®‰å…¨çš„åŠžæ³•æ˜¯é‡‡ç”¨ç»‘å®šIPçš„æ–¹å¼æ¥è¿›è¡ŒæŽ§åˆ¶ã€‚è¯·åœ¨redis.confæ–‡ä»¶æ‰¾åˆ°å¦‚ä¸‹é…ç½®123# If you want you can bind a single interface, if the bind option is not# specified all the interfaces will listen for incoming connections.# bind 127.0.0.1 æŠŠ# bind 127.0.0.1å‰é¢çš„ æ³¨é‡Š#å·åŽ»æŽ‰ï¼Œç„¶åŽæŠŠ127.0.0.1æ”¹æˆä½ å…è®¸è®¿é—®ä½ çš„redisæœåŠ¡å™¨çš„ipåœ°å€ï¼Œè¡¨ç¤ºåªå…è®¸è¯¥ipè¿›è¡Œè®¿é—®.è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨å¯åŠ¨redisæœåŠ¡å™¨çš„æ—¶å€™ä¸èƒ½å†ç”¨:redis-serverï¼Œæ”¹ä¸º:redis-server path/redis.conf å³åœ¨å¯åŠ¨çš„æ—¶å€™æŒ‡å®šéœ€è¦åŠ è½½çš„é…ç½®æ–‡ä»¶,å…¶ä¸­path/æ˜¯ä½ ä¸Šé¢ä¿®æ”¹çš„redisé…ç½®æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼Œè¿™ä¸ªæ–¹æ³•æœ‰ä¸€ç‚¹ä¸å¤ªå¥½ï¼Œæˆ‘éš¾å…æœ‰å¤šå°æœºå™¨è®¿é—®ä¸€ä¸ªredisæœåŠ¡ã€‚ 2.è®¾ç½®å¯†ç ï¼Œä»¥æä¾›è¿œç¨‹ç™»é™†æ‰“å¼€redis.confé…ç½®æ–‡ä»¶ï¼Œæ‰¾åˆ°requirepassï¼Œç„¶åŽä¿®æ”¹å¦‚ä¸‹: 1requirepass yourPassword yourpasswordå°±æ˜¯rediséªŒè¯å¯†ç ï¼Œè®¾ç½®å¯†ç ä»¥åŽå‘çŽ°å¯ä»¥ç™»é™†ï¼Œä½†æ˜¯æ— æ³•æ‰§è¡Œå‘½ä»¤äº†ã€‚æŠ¥é”™å¦‚ä¸‹ï¼š(error) ERR operation not permittedè¿™æ—¶å€™ä½ å¯ä»¥ç”¨æŽˆæƒå‘½ä»¤è¿›è¡ŒæŽˆæƒï¼Œå°±ä¸æŠ¥é”™äº†1auth yourPassword å¦å¤–ï¼Œåœ¨è¿žæŽ¥æœåŠ¡å™¨çš„æ—¶å€™å°±å¯ä»¥æŒ‡å®šç™»å½•å¯†ç ï¼Œé¿å…å•ç‹¬è¾“å…¥ä¸Šé¢æŽˆæƒå‘½ä»¤ å‘½ä»¤å¦‚ä¸‹:1redis-cli -h yourIp -p yourPort -a yourPassword å®¢æˆ·ç«¯/æœåŠ¡å™¨æ“ä½œæœåŠ¡å™¨ç«¯å‘½ä»¤ï¼šredis-serveræŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ï¼šredis-server --helpå…³é—­é‡å¯ï¼šubuntuï¼šsudo service redis stop|start|restarté…ç½®æ–‡ä»¶å¯åŠ¨ï¼šredis-server path/redis.conf å®¢æˆ·ç«¯æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ï¼šredis-cli --helpè¿žæŽ¥ï¼šredis-cliè¿è¡Œæµ‹è¯•ï¼šping è¿”å›ž PONGåˆ‡æ¢æ•°æ®åº“ï¼šselect num # é»˜è®¤æœ‰16ä¸ªæ•°æ®åº“0ï½ž15 æ•°æ®åº“ç»“æž„ redisæ˜¯ key-valueçš„æ•°æ®åº“ç»“æž„ï¼Œæ¯æ¡æ•°æ®éƒ½æ˜¯ä¸€ä¸ªé”®å€¼å¯¹ key é”®çš„ç±»åž‹æ˜¯å­—ç¬¦ä¸²,å¹¶ä¸”é”®ä¸èƒ½é‡å¤ å€¼çš„ç±»åž‹æœ‰äº”ç§ å­—ç¬¦ä¸² string å“ˆå¸Œ hash åˆ—è¡¨ list é›†åˆ set æœ‰åºé›†åˆ zsetæ•°æ®ç±»åž‹-stringç±»åž‹ä»‹ç»å­—ç¬¦ä¸²ç±»åž‹æ˜¯ Redisä¸­æœ€ä¸ºåŸºç¡€çš„æ•°æ®å­˜å‚¨ç±»åž‹ï¼Œå®ƒåœ¨Redisä¸­æ˜¯äºŒè¿›åˆ¶å­˜å‚¨çš„ï¼Œè¿™æ„å‘³ç€è¯¥ç±»åž‹å¯ä»¥æŽ¥å—ä»»ä½•æ ¼å¼çš„æ•°æ®ï¼Œå¦‚å›¾ç‰‡ã€jsonç­‰ã€‚Redisä¸­å­—ç¬¦ä¸²ç±»åž‹çš„ Valueæœ€å¤§å¯ä»¥å®¹çº³çš„æ•°æ®é•¿åº¦æ˜¯ 512M.æ·»åŠ å¦‚æžœè®¾ç½®çš„é”®keyä¸å­˜åœ¨åˆ™ä¸ºæ·»åŠ ï¼Œå¦‚æžœè®¾ç½®çš„é”®å­˜åœ¨åˆ™ä¿®æ”¹ã€‚æœ‰ç‚¹åƒPythonçš„å­—å…¸ è®¾ç½®é”®å€¼è¯­æ³• set key value è®¾ç½®é”®å€¼åŠè¿‡æœŸæ—¶é—´ï¼Œä»¥ç§’ä¸ºå•ä½ setex key seconds value è®¾ç½®å¤šä¸ªé”®å€¼ mset key1 value1 key2 value2 ... è¿½åŠ å€¼ï¼ˆç»™åŽŸæœ‰çš„å­—ç¬¦ä¸²valueå°¾éƒ¨è¿½åŠ å†…å®¹ï¼‰ append key valueèŽ·å– èŽ·å–ï¼šæ ¹æ®é”®èŽ·å–å€¼ï¼Œå¦‚æžœé”®ä¸å­˜åœ¨å°±è¿”å›ž nil get key æ ¹æ®å¤šä¸ªå»ºèŽ·å–å¤šä¸ªå€¼ mget key1 key2 ...é”®å‘½ä»¤ æŸ¥æ‰¾é”®ï¼Œå‚æ•°æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ keys pattern æŸ¥çœ‹æ‰€æœ‰çš„é”® keys * æŸ¥çœ‹åç§°ä¸­åŒ…å« açš„é”® keys a* åˆ¤æ–­é”®æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æžœå­˜åœ¨è¿”å›ž1ï¼Œä¸å­˜åœ¨è¿”å›ž0 exists key1 æŸ¥çœ‹é”®å¯¹åº”çš„ valueçš„ç±»åž‹ type key åˆ é™¤é”®åŠå¯¹åº”çš„å€¼ï¼ˆå¯ä»¥åˆ é™¤1ä¸ªæˆ–è€…å¤šä¸ªï¼‰ del key1 key2 ç»™é”®è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä»¥ç§’ä¸ºå•ä½ï¼Œå¦‚æžœæ²¡æœ‰æŒ‡å®šè¿‡æœŸæ—¶é—´åˆ™ä¸€ç›´å­˜åœ¨ï¼Œç›´åˆ°ä½¿ç”¨ delç§»é™¤ expire key seconds æŸ¥çœ‹é”®çš„æœ‰æ•ˆæ—¶é—´ï¼Œä»¥ç§’ä¸ºå•ä½ ttl key###æ•°æ®ç±»åž‹- hashç±»åž‹ hashç”¨äºŽå­˜å‚¨å¯¹è±¡ã€å¯¹è±¡çš„ç»“æž„ä¸ºå±žæ€§ï¼šå€¼ å€¼çš„ç±»åž‹ä¸º stringå¢žåŠ ã€ä¿®æ”¹ è®¾ç½®å•ä¸ªå±žæ€§ hset key field value hset user name qiangzai # è®¾ç½®é”®userçš„å±žæ€§ nameä¸ºqiangzai è®¾ç½®å¤šä¸ªå±žæ€§ hmset key field1 value1 field2 value2 ... hmset user name qiangzai age 22 # è®¾ç½®é”®userçš„å±žæ€§nameä¸ºqiangzaiï¼Œå±žæ€§ageä¸º22èŽ·å– èŽ·å–æŒ‡å®šé”®æ‰€æœ‰çš„å±žæ€§ hkeys key èŽ·å–ä¸€ä¸ªå±žæ€§çš„å€¼ hget key field èŽ·å–å¤šä¸ªå±žæ€§çš„å€¼ hmget key field1 field2 ... èŽ·å–æ‰€æœ‰å±žæ€§çš„å€¼ hvals keyåˆ é™¤ åˆ é™¤æ•´ä¸ªhashé”®åŠå€¼ï¼Œä½¿ç”¨delå‘½ä»¤ åˆ é™¤å±žæ€§ï¼Œå±žæ€§å¯¹åº”çš„å€¼ä¼šè¢«ä¸€èµ·åˆ é™¤ hdel key field1 field2 ...æ•°æ®ç±»åž‹-listç±»åž‹ åˆ—è¡¨çš„å…ƒç´ ç±»åž‹ä¸ºstring æŒ‰ç…§æ’å…¥é¡ºåºæŽ’åºå¢žåŠ  å·¦ä¾§æ’å…¥æ•°æ® lpush key value1 value2 ... å³ä¾§æ’å…¥æ•°æ® rpush key value1 value2 ... åœ¨æŒ‡å®šå…ƒç´ çš„å‰æˆ–åŽæ’å…¥æ–°å…ƒç´  linsert key before | after çŽ°æœ‰å…ƒç´  æ–°å…ƒç´  linsert l1 before 2 3 # ç»™é”®ä¸ºl1çš„åˆ—è¡¨ä¸­å…ƒç´ ä¸ºâ€™2â€™çš„å‰é¢æ’å…¥â€˜3â€™èŽ·å– è¿”å›žåˆ—è¡¨é‡ŒæŒ‡å®šèŒƒå›´çš„å…ƒç´  lrange key start stop startã€stopä¸ºå…ƒç´ çš„ä¸‹æ ‡ç´¢å¼• ç´¢å¼•ä»Žå·¦ä¾§å¼€å§‹ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ç´¢å¼•ä¸º0 ç´¢å¼•å¯ä»¥æ˜¯è´Ÿæ•°ï¼Œ è¡¨ç¤ºä»Žå°¾éƒ¨å¼€å§‹è®¡æ•°ï¼Œå¦‚-1è¡¨ç¤ºæœ€åŽä¸€ä¸ªå…ƒç´  lrange l1 0 -1 # èŽ·å–é”®ä¸º l1çš„åˆ—è¡¨æ‰€æœ‰å…ƒç´ ä¿®æ”¹ lset key index value ç´¢å¼•ä»Žå·¦ä¾§å¼€å§‹ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸º0 ç´¢å¼•å¯ä»¥æ˜¯è´Ÿæ•°ï¼Œè¡¨ç¤ºå°¾éƒ¨å¼€å§‹è®¡æ•°ï¼Œå¦‚-1è¡¨ç¤ºæœ€åŽä¸€ä¸ªå…ƒç´  å¦‚æžœåˆ—è¡¨ç´¢å¼•ä½ç½®å…ƒç´ ä¸å­˜åœ¨ï¼Œä¸ä¼šè®¾ç½®ï¼Œä¼šæŠ¥é”™ lset l1 1 z # ä¿®æ”¹é”®ä¸º l1 çš„åˆ—è¡¨ä¸­ä¸‹æ ‡ç´¢å¼•ä¸º1çš„å…ƒç´ å€¼ä¸º zåˆ é™¤ åˆ é™¤æŒ‡å®šå…ƒç´  lrem key count value å°†åˆ—è¡¨ä¸­å‰ countæ¬¡å‡ºçŽ°çš„å€¼ä¸º valueçš„å…ƒç´ ç§»é™¤ count &gt; 0ï¼šä»Žå¤´å¾€å°¾ç§»é™¤ count &lt; 0:ä»Žå°¾å¾€å¤´ç§»é™¤ count = 0: ç§»é™¤æ‰€æœ‰æ•°æ®ç±»åž‹-setç±»åž‹ æ— åºé›†åˆ å…ƒç´ ä¸º stringç±»åž‹ å…ƒç´ å…·æœ‰å”¯ä¸€æ€§ï¼Œä¸é‡å¤ è¯´æ˜Žï¼šå¯¹äºŽé›†åˆæ²¡æœ‰ä¿®æ”¹æ“ä½œå¢žåŠ  æ·»åŠ å…ƒç´  sadd key member1 member2 ...èŽ·å– è¿”å›žæ‰€æœ‰çš„å…ƒç´  smembers keyåˆ é™¤ åˆ é™¤æŒ‡å®šå…ƒç´  srem key member1æ•°æ®ç±»åž‹-zsetç±»åž‹ sorted set,æœ‰åºé›†åˆ å…ƒç´ ä¸º stringç±»åž‹ å…ƒç´ å…·æœ‰å”¯ä¸€æ€§ï¼Œä¸é‡å¤ æ¯ä¸ªå…ƒç´ éƒ½ä¼šå…³è”ä¸€ä¸ª doubleç±»åž‹çš„score,è¡¨ç¤ºæƒé‡ï¼Œé€šè¿‡æƒé‡å°†å…ƒç´ ä»Žå°åˆ°å¤§æŽ’åº è¯´æ˜Žï¼šæ²¡æœ‰ä¿®æ”¹æ“ä½œå¢žåŠ  æ·»åŠ è¯­æ³• zadd key socre1 member1 socre2 member2 ...èŽ·å– è¯­æ³•-ç´¢å¼•èŽ·å– zrange key start stop è¿”å›žæŒ‡å®šèŒƒå›´å†…çš„å…ƒç´  startã€stopä¸ºå…ƒç´ çš„ä¸‹æ ‡ç´¢å¼• ç´¢å¼•ä»Žå·¦ä¾§å¼€å§‹ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸º0 ç´¢å¼•å¯ä»¥æ˜¯è´Ÿæ•°ï¼Œè¡¨ç¤ºä»Žå°¾éƒ¨å¼€å§‹è®¡æ•°ï¼Œå¦‚-1è¡¨ç¤ºæœ€åŽä¸€ä¸ªå…ƒç´  è¯­æ³•-æƒé‡scoreèŒƒå›´èŽ·å–å…ƒç´  zrangebyscore key score_min score_max è¯­æ³•-èŽ·å–å…ƒç´ æƒé‡score zscore key memberåˆ é™¤ åˆ é™¤æŒ‡å®šå…ƒç´  zrem key member1 member2 ... åˆ é™¤æƒé‡åœ¨æŒ‡å®šèŒƒå›´çš„å…ƒç´  zremrangebyscore key min_score max_scorePythonæ“ä½œredisæ¨¡å—å®‰è£… pip å®‰è£… 1pip install redis æºç å®‰è£… 1234567# èŽ·å–æºç wget https://github.com/andymccurdy/redis-py/archive/master.zip# è§£åŽ‹unzip master.zipcd redis-py-master# å®‰è£…sudo python setup.py install å¼•å…¥æ¨¡å— 1from redis import * è¿™ä¸ªæ¨¡å—ä¸­æä¾›äº†StrictRediså¯¹è±¡(Strictä¸¥æ ¼)ï¼Œâ½¤äºŽè¿žæŽ¥redisæœåŠ¡å™¨ï¼Œå¹¶æŒ‰ç…§ä¸åŒç±»åž‹æä¾› äº†ä¸åŒâ½…æ³•ï¼Œè¿›â¾äº¤äº’æ“ä½œ StrictRediså¯¹è±¡æ–¹æ³• é€šè¿‡ __init__æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼ŒæŒ‡å®šå‚æ•° host/portä¸ŽæŒ‡å®šçš„æœåŠ¡å™¨å’Œç«¯å£è¿žæŽ¥ï¼Œhosté»˜è®¤ä¸º localhostï¼Œporté»˜è®¤ä¸º6379ï¼Œdbé»˜è®¤ä¸º0 123from redis import StrictRedissr = StrictRedis(host='localhost', port=3306, db=0) æ ¹æ®ä¸åŒçš„ç±»åž‹ï¼Œæ‹¥æœ‰ä¸åŒçš„å®žä¾‹æ–¹æ³•å¯ä»¥è°ƒç”¨ string: set | setex| mset | append | get | mget | keykeys:exists | type | delete | expire | getrange | ttl |hash:hset | hmset | hkeys | hget | hmget | hvals | hdel |list: lpush | rpush | linsert | lrange | lset | lrem |set: sadd | smembers | srem |zset:zadd | zrange | zrangebyscore | zscore | zrem | zremrangebyscore | string-å¢žåŠ  æ–¹æ³•set,æ·»åŠ é”®å€¼ï¼Œå¦‚æžœæ·»åŠ æˆåŠŸåˆ™è¿”å›ž Trueï¼Œå¦‚æžœæ·»åŠ å¤±è´¥åˆ™è¿”å›žFalse123456789from redis import StrictRedisif __name__ == '__main__': # åˆ›å»ºStrictRediså¯¹è±¡ï¼Œä¸ŽredisæœåŠ¡å™¨å»ºç«‹è¿žæŽ¥ sr = StrictRedis() # æ·»åŠ é”®å€¼å¯¹ï¼Œå­˜å‚¨ç±»åž‹ä¸ºstring result = sr.set('name', 'qiangzai') # å¦‚æžœæ·»åŠ æˆåŠŸè¿”å›žTrueï¼Œå¦åˆ™è¿”å›žFalse print(result) string-èŽ·å– æ–¹æ³•getï¼Œæ·»åŠ é”®å¯¹åº”çš„å€¼ï¼Œå¦‚æžœé”®å­˜åœ¨åˆ™è¿”å›žå¯¹åº”çš„å€¼ï¼Œå¦‚æžœé”®ä¸å­˜åœ¨åˆ™è¿”å›žNone123456789from redis import StrictRedisif __name__ == '__main__': try: sr = StrictRedis() # åˆ›å»ºè¿žæŽ¥å¯¹è±¡ result = sr.get('name1') # èŽ·å–é”®nameçš„å€¼ print(result) # ç»“æžœæ˜¯å­—èŠ‚ç±»åž‹ï¼Œæ²¡æœ‰è¿”å›žNone except Exception as e: print(e) string-åˆ é™¤ æ–¹æ³•deleteï¼Œåˆ é™¤é”®åŠå¯¹åº”çš„å€¼ï¼Œå¦‚æžœåˆ é™¤æˆåŠŸåˆ™è¿”å›žå—å½±å“çš„é”®æ•°ï¼Œå¦åˆ™åˆ™è¿”å›ž0123456789from redis import StrictRedisif __name__ == '__main__': try: sr = StrictRedis() result = sr.delete('name') print(result) except Exception as e: print(e) string-èŽ·å–é”® æ–¹æ³•keysï¼Œæ ¹æ®æ­£åˆ™è¡¨è¾¾å¼èŽ·å–é”®1234567891011from redis import *if __name__=="__main__": try: #åˆ›å»ºStrictRediså¯¹è±¡ï¼Œä¸ŽredisæœåŠ¡å™¨å»ºâ½´è¿žæŽ¥ sr=StrictRedis() #èŽ·å–æ‰€æœ‰çš„é”® result=sr.keys() #è¾“å‡ºå“åº”ç»“æžœï¼Œæ‰€æœ‰çš„é”®æž„æˆâ¼€ä¸ªåˆ—è¡¨ï¼Œå¦‚æžœæ²¡æœ‰é”®åˆ™è¿”å›žç©ºåˆ—è¡¨ print(result) except Exception as e: print(e)]]></content>
      <categories>
        <category>Redis</category>
      </categories>
      <tags>
        <tag>redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®°å½•ä¹‹Linuxå¸¸ç”¨å‘½ä»¤]]></title>
    <url>%2F2019%2F04%2F07%2F%E8%AE%B0%E5%BD%95%E4%B9%8BLinux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%2F</url>
    <content type="text"><![CDATA[å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œè®°å½•ä¸€ä¸‹å¸¸ç”¨çš„Linux å‘½ä»¤ 1) findè¯­æ³• 1sudo find path -name file_name æ¡ˆä¾‹ï¼šæŸ¥æ‰¾ æ ¹ç›®å½•ä¸‹çš„mysqlç›¸å…³æ–‡ä»¶ 1sudo find / -name mysql 2) lsofè¯­æ³• 1sudo lsof -i:port æ¡ˆä¾‹ï¼šæŸ¥æ‰¾8000ç«¯å£å¯¹åº”çš„è¿›ç¨‹PIDå· 1sudo lsof -i:8000 3) nc ncæ˜¯netcatçš„ç®€å†™ï¼Œèƒ½å¤Ÿå®žçŽ°ä»»æ„TCP/UDPç«¯å£çš„ç›‘å¬,ncå¯ä»¥ä½œä¸ºserverä»¥TCPæˆ–UDPæ–¹å¼ä¾¦å¬æŒ‡å®šç«¯å£ è¯­æ³• 1nc -l port æ¡ˆä¾‹ï¼šæœåŠ¡å™¨ç›‘å¬9000ç«¯å£ 1nc -l 9000 4) telnetå‘½ä»¤ ç”¨äºŽè¿œç¨‹ç™»é™†è¿žæŽ¥ è¯­æ³• 1telnet [-8acdEfFKLrx][-b&lt;ä¸»æœºåˆ«å&gt;][-e&lt;è„±ç¦»å­—ç¬¦&gt;][-k&lt;åŸŸå&gt;][-l&lt;ç”¨æˆ·åç§°&gt;][-n&lt;è®°å½•æ–‡ä»¶&gt;][-S&lt;æœåŠ¡ç±»åž‹&gt;][-X&lt;è®¤è¯å½¢æ€&gt;][ä¸»æœºåç§°æˆ–IPåœ°å€&lt;é€šä¿¡ç«¯å£&gt;] å®žä¾‹:ç™»é™†IPä¸ºxxçš„è¿œç¨‹ä¸»æœº 1telnet 192.168.36.1 5) head&amp; tailå‘½ä»¤ æŸ¥çœ‹æ–‡ä»¶å†…å®¹,å¯ä»¥æŒ‡å®šè¡Œæ•°ï¼Œä¹Ÿå¯ä»¥åŠ¨æ€æŸ¥çœ‹æ—¥å¿— è¯­æ³• 1head -n æ•°å­— path å®žä¾‹ï¼šæŸ¥çœ‹ /etc/profileå‰10è¡Œå†…å®¹ 1head -n 10 /etc/profile å®žä¾‹ï¼šæŸ¥çœ‹ /etc/profileåŽ10è¡Œå†…å®¹ 1tail -n 10 /etc/profile å®žä¾‹ï¼šåŠ¨æ€æŸ¥çœ‹ /etc/nginx/log 1tail -f /etc/nginx/log 6) netstat netstatå‘½ä»¤ç”¨äºŽæ˜¾ç¤ºä¸ŽIPã€TCPã€UDPå’ŒICMPåè®®ç›¸å…³çš„ç»Ÿè®¡æ•°æ®ï¼Œä¸€èˆ¬ç”¨äºŽæ£€éªŒæœ¬æœºå„ç«¯å£çš„ç½‘ç»œè¿žæŽ¥æƒ…å†µã€‚netstatæ˜¯åœ¨å†…æ ¸ä¸­è®¿é—®ç½‘ç»œåŠç›¸å…³ä¿¡æ¯çš„ç¨‹åºï¼Œå®ƒèƒ½æä¾›TCPè¿žæŽ¥ï¼ŒTCPå’ŒUDPç›‘å¬ï¼Œè¿›ç¨‹å†…å­˜ç®¡ç†çš„ç›¸å…³æŠ¥å‘Šã€‚ å®žä¾‹:æŸ¥çœ‹MySQLçš„è¿è¡Œæƒ…å†µ 1netstat -tnulp | grep mysql ç»“æžœ 1tcp 0 0 0.0.0.0:3306 0.0.0.0:* LISTEN 846/mysqld]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®°å½•ä¹‹19å¹´å­¦ä¹ æŠ€æœ¯æ ˆ]]></title>
    <url>%2F2019%2F01%2F01%2F%E8%AE%B0%E5%BD%95%E4%B9%8B18%E5%B9%B4%E5%AD%A6%E4%B9%A0%E6%8A%80%E6%9C%AF%E6%A0%88%2F</url>
    <content type="text"><![CDATA[è®°å½•ä¸€ä¸‹ä»Šå¹´çš„å­¦ä¹ ç›®æ ‡ï¼ŒFightingï¼ï¼ï¼ [x] çˆ¬è™«å›žé¡¾ requests scrapy ç›®æ ‡ï¼šåŸºæœ¬ä½¿ç”¨ [ ] Webæ¡†æž¶å»¶ä¼¸ 1ã€Django&amp;Django-rest-framework ç›®æ ‡ï¼šæºç å°è¯•é˜…è¯»2ã€ç¬¬ä¸‰æ–¹ç»„ä»¶é›†æˆå­¦ä¹ ï¼ˆchannelï¼‰3ã€websocket Flask ç›®æ ‡Flaskå¤ä¹  Tornado ç›®æ ‡ï¼šå­¦ä¹ ä½¿ç”¨ Bottle ç›®æ ‡ï¼šåŸºæœ¬ä½¿ç”¨ [ ] æ•°æ®åˆ†æž numpy pandas ç›®æ ‡ï¼šåŸºæœ¬ä½¿ç”¨APIè¯­æ³•ç†Ÿæ‚‰ [ ] æœºå™¨å­¦ä¹  å¸¸ç”¨ç®—æ³• ç‰¹å¾å·¥ç¨‹ æŽ¨èç®—æ³• åŸºæœ¬ä½¿ç”¨ [ ] æ•°æ®ç»“æž„&amp;ç®—æ³• å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ åŸºæœ¬ç®—æ³•è§£å†³æ€è·¯ å¤šäº†è§£ [ ] æ–°è¯­è¨€å­¦ä¹  Cè¯­è¨€ Javaè¯­è¨€ Goè¯­è¨€ ç›®æ ‡ï¼šå…¥é—¨å³å¯ï¼Œäº†è§£åº•å±‚è¯­è¨€å¸®åŠ©è‡ªå·±å¯¹Pythonç†è§£ [ ] æ•°æ®åº“ SQL redis åå¤ç»ƒä¹  [ ] è¿ç»´ Docker K8S Supervisor Shell Fabric åŸºæœ¬ä½¿ç”¨]]></content>
      <categories>
        <category>Life</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[çºªå¿µé‡‘åº¸]]></title>
    <url>%2F2018%2F10%2F30%2Fmy-first-blog%2F</url>
    <content type="text"><![CDATA[é£žé›ªè¿žå¤©å°„ç™½é¹¿ï¼Œç¬‘ä¹¦ç¥žä¾ å€šç¢§é¸³ã€‚ ä¾ ä¹‹å¤§è€…ï¼Œä¸ºå›½ä¸ºæ°‘ã€‚ çº¢é¢œå¼¹æŒ‡è€ï¼Œåˆ¹é‚£èŠ³åŽï¼Œä¸Žå…¶å¤©æ¶¯æ€å›ï¼Œæ‹æ‹ä¸èˆï¼ŒèŽ«è‹¥ç›¸å¿˜äºŽæ±Ÿæ¹–ã€‚â€”â€”é‡‘åº¸ã€Šå¤©é¾™å…«éƒ¨ã€‹ å››å¼ æœºï¼Œé¸³é¸¯ç»‡å°±æ¬²åŒé£žï¼Œå¯æ€œæœªè€å¤´å…ˆç™½ï¼Œæ˜¥æ³¢ç¢§è‰ï¼Œæ™“å¯’æ·±å¤„ï¼Œç›¸å¯¹æµ´çº¢è¡£ã€‚â€”â€”é‡‘åº¸ã€Šå°„é›•è‹±é›„ä¼ ã€‹ ä¸€åº§å±±ï¼Œéš”ä¸äº†ä¸¤ä¸¤ç›¸æ€ï¼Œä¸€å¤©æ¶¯ï¼Œæ–­ä¸äº†ä¸¤ä¸¤æ— è¨€ï¼Œä¸”å¬é£ŽåŸï¼ŒåŸä¸å®Œæˆ‘ä¸€ç”Ÿæ€å¿µã€‚â€”â€”é‡‘åº¸ã€Šç¥žé›•ä¾ ä¾£ã€‹ ä»–å¼ºç”±ä»–å¼ºï¼Œæ¸…é£Žæ‹‚å±±å²—ï¼›ä»–æ¨ªä»»ä»–æ¨ªï¼Œæ˜Žæœˆç…§å¤§æ±Ÿã€‚â€”â€”é‡‘åº¸ã€Šå€šå¤©å± é¾™è®°ã€‹ æƒ…ä¸çŸ¥æ‰€èµ·ï¼Œä¸€å¾€æƒ…æ·±ï¼›æ¨ä¸çŸ¥æ‰€ç»ˆï¼Œä¸€ç¬‘è€Œæ³¯ã€‚â€”â€”é‡‘åº¸ã€Šç¬‘å‚²æ±Ÿæ¹–ã€‹]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>tag1</tag>
        <tag>tag2</tag>
        <tag>tag3</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Pythonç¼–ç¨‹ä¹‹å¸¸è§çš„å†…ç½®å‡½æ•°]]></title>
    <url>%2F2018%2F10%2F24%2FPython%E7%BC%96%E7%A8%8B%E4%B9%8B%E5%B8%B8%E8%A7%81%E7%9A%84%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0%2F</url>
    <content type="text"><![CDATA[Pythonå½“ä¸­æœ‰å¾ˆå¤šçš„å†…ç½®å‡½æ•°ï¼Œåœ¨å†™ä»£ç çš„è¿‡ç¨‹å½“ä¸­å¦‚æžœèƒ½å¤Ÿçµæ´»è¿ç”¨ï¼Œå¯ä»¥æé«˜å¼€å‘æ•ˆçŽ‡,ä»Šå¤©å°±æ€»ç»“ä¸€ä¸‹ï½ž æ–‡ç« PythonçŽ¯å¢ƒä¸ºPy3.x filter è¯­æ³•123# ç¬¬ä¸€ä¸ªå‚æ•°ï¼šæ˜¯ä¸€ä¸ªå‡½æ•°åç§°# ç¬¬äºŒä¸ªå‚æ•°ï¼šæ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡filter(function, sequence) æ‰§è¡Œè¿‡ç¨‹functionå‡½æ•°ä¼šä¸€ä¸ªä¸€ä¸ªè°ƒç”¨sequenceé‡Œé¢çš„itemå‚æ•°ï¼Œç„¶åŽæ‰§è¡Œfunction(item)ï¼Œæœ€åŽå°†æ‰§è¡Œç»“æžœä¸ºTrueçš„å…ƒç´ ç»„æˆæ–°çš„è¿­ä»£å™¨è¿”å›ž æ¡ˆä¾‹è¯´æ˜Ž12345678910111213foo = [1, 2, 3, 4, 5, 6]new_foo = list(filter(lambda x: x &gt; 3, foo))print(new_foo) # [4, 5, 6]# ç­‰åŒäºŽdef func(item): return item &gt; 3new_iterable = filter(func, foo)print(new_iterable) # &lt;filter object at 0x105e23748&gt;new_foo = list(new_iterable)print(new_foo) # [4, 5, 6] zip() è¯­æ³•1zip(iterable1, iteable2, ...) æ‰§è¡Œè¿‡ç¨‹zipä¼šå°† æ‰€æœ‰iterableé‡Œé¢çš„ itemå…ƒç´ æŒ‰ç…§ç´¢å¼•é¡ºåºï¼Œä¸€ä¸€æ‰“åŒ…æˆå…ƒç»„ï¼Œæœ€ç»ˆå°†å…ƒç»„ç»„åˆæˆåˆ—è¡¨ æ¡ˆä¾‹è¯´æ˜Ž12345l1 = [1, 2, 3, 4]l2 = [9, 10, 11, 12]ret = list(zip(l1, l2))print(ret) # [(1, 9), (2, 10), (3, 11), (4, 12)] Map()è¯­æ³•1map(func, sequence) æ‰§è¡Œè¿‡ç¨‹funcå‡½æ•°ä¼šéåŽ†sequenceé‡Œé¢æ‰€æœ‰çš„ itemå…ƒç´ ï¼Œé€ä¸ªæ‰§è¡Œ func(item)ï¼Œå¹¶å°†è¿”å›žçš„ç»“æžœç»„æˆæ–°çš„ mapå¯¹è±¡è¿”å›ž æ¡ˆä¾‹è¯´æ˜Ž12345# åˆ—è¡¨æ‰€æœ‰å…ƒç´ å¹³æ–¹l1 = [1, 2, 3, 4]m = map(lambda x: x * x, l1)print(list(m)) reduce()è¯­æ³•12from functools import reducereduce(func, sequence) æ‰§è¡Œè¿‡ç¨‹funcå‡½æ•°ä¼šå…ˆä»Ž sequenceä¸­å–å‡ºå‰2ä¸ª itemå…ƒç´ æ‰§è¡Œ func(item1,item2),æŠŠæ‹¿åˆ°çš„è¿”å›žç»“æžœå½“ä½œä¸‹ä¸€æ¬¡æ‰§è¡Œ funcå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œç„¶åŽå†ä»Ž sequenceä¸­å–ç¬¬ä¸‰ä¸ª itemå½“æ‰§è¡Œçš„ç¬¬äºŒä¸ªå‚æ•°ï¼ŒåŽé¢ä»¥æ­¤ç±»æŽ¨ æ¡ˆä¾‹è¯´æ˜Ž123456# l1åˆ—è¡¨æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯l1 = [1, 2, 3, 4, 5, 6]from functools import reduceret = reduce(lambda x, y: x * y, l1)print(ret) # 720]]></content>
      <categories>
        <category>Python-Standard-Library</category>
      </categories>
      <tags>
        <tag>zip</tag>
        <tag>filter</tag>
        <tag>map</tag>
        <tag>reduce</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åŸºäºŽAWSæ­å»ºä¸Šç½‘ä»£ç†]]></title>
    <url>%2F2018%2F10%2F23%2F%E5%9F%BA%E4%BA%8EAWS%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%88%A9%E7%94%A8sandowsocks%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%2F</url>
    <content type="text"><![CDATA[ä¸€ç›´éƒ½æƒ³æ‰¾Googleå’ŒAWSè¿™ç§å¤§BOSSæ’¸ç¾Šæ¯›ï¼Œä½†æ˜¯è‹¦äºŽæ²¡æœ‰ä¿¡ç”¨å¡ï¼Œä¹Ÿä¸æƒ³èµ°æ·˜å®ä¹°å¡å®³æ€•è¢«å¥—è·¯ï¼Œå¶ç„¶æœºä¼šéœ€è¦å‡ºå›½æ—…æ¸¸ï¼Œæ‰€ä»¥åŒ†åŒ†åŽ»åŠžäº†ä¸€å¼ ä¸­ä¿¡çš„ Visaä¿¡ç”¨å¡ï¼ˆæ¬§æ´²ç”¨çŽ°é‡‘ã€ç¾Žå›½ç”¨ä¿¡ç”¨å¡ã€ä¸­å›½åœ¨ç”¨æ”¯ä»˜å®ï¼Œå›½å¤–å¾ˆæµè¡Œä¿¡ç”¨å¡ï¼‰ï¼Œå›žå›½ä»¥åŽå°±èµ¶ç´§è‰è‰æ³¨å†Œäº†AWSï¼Œå¼€å¯ï½ž ä¸€ã€æ³¨å†ŒAWSå¹¶åˆ›å»ºEc2å®žä¾‹1ã€æ³¨å†Œåœ°å€ï¼šhttps://www.amazonaws.cn/sign-up/&gt; 2ã€æ³¨å†Œéœ€è¦æ¡ä»¶ ä¿¡ç”¨å¡ï¼ˆå¿…å¤‡ï¼Œæˆ‘ç”¨çš„visaåŒå¸å¡ï¼Œæ³¨å†ŒåŽæ‰£é™¤1$ï¼‰ æ‰‹æœºå· é‚®ç®± å¤‡æ³¨ï¼šæ³¨å†ŒæˆåŠŸä»¥åŽéœ€è¦ç­‰å¾…ä¸€å¤©éªŒè¯èº«ä»½ä»€ä¹ˆçš„ï¼Œåæ­£æˆ‘å½“åˆç­‰äº†ä¸€å¤©æ‰èƒ½åŽ»åˆ›å»ºEc2 3ã€ç”³è¯·æˆåŠŸï¼Œåˆ›å»ºEc2å®žä¾‹ åˆ›å»ºå®žä¾‹æˆ‘é€‰æ‹©çš„æ˜¯ Ubuntu16.40å› ä¸ºå¯¹ubuntuç³»ç»Ÿæ¯”è¾ƒç†Ÿæ‚‰ å‚è€ƒé“¾æŽ¥ï¼šhttps://blog.csdn.net/jewely/article/details/78030057 ä¿å­˜å¥½ç§é’¥æ–‡ä»¶ï¼Œæ–‡ä»¶ç»“å°¾æ˜¯xxx.pem äºŒã€è¿žæŽ¥æœåŠ¡å™¨1ã€ä¿®æ”¹ä¸€ä¸‹æœ¬åœ°ç§é’¥æ–‡ä»¶æƒé™ 12chmod 400 xxx.pem# å¤‡æ³¨ æƒé™å¤ªé«˜ï¼ŒåŽé¢sshçš„æ—¶å€™è¿žæŽ¥ä¸äº†ä¼šæç¤ºä¸å®‰å…¨ 2ã€sshè¿žæŽ¥ 1ssh -i "xxx.pem" ubuntu@ec2-54-191-9-26.us-west-2.compute.amazonaws.com xxx.pem å°±æ˜¯ä½ ä¸‹è½½ä¸‹æ¥çš„ç§é’¥æ–‡ä»¶ xxxè¿™ä¸ªåå­—æ˜¯å½“æ—¶ä¸‹è½½æ—¶å†™çš„ï¼Œå¤§å®¶æŒ‰è‡ªå·±çš„æ¥ @å‰é¢çš„é‚£ä¸ªubuntuåº”è¯¥æ˜¯å›ºå®šçš„ï¼Œæˆ‘é€‰çš„å°±æ˜¯ubuntuç³»ç»Ÿ @åŽé¢çš„å°±æ˜¯AWSä¸Šä½ åˆ›å»ºçš„å®žä¾‹çš„å…¬æœ‰DNSï¼ˆIPv4ï¼‰åç§° æˆ–è€…å†™ IPv4çš„å…¬æœ‰IPä¹Ÿå¯ä»¥ æˆ‘ä¸¤ä¸ªéƒ½å°è¯•äº† It`s OK 3ã€ä¿®æ”¹ä¸€ä¸‹rootç”¨æˆ·å¯†ç  1sudo passwd root ä¸‰ã€å®‰è£…shadowsockså¹¶é…ç½®é»˜è®¤ubuntu16.04å·²ç»é¢„è£…äº†Python3 1ã€æ›´æ–°apt-get 1apt-get update 2ã€å®‰è£…pip3ï¼ˆæˆ‘ç”¨æƒ¯äº†Python3ï¼‰ 1apt-get install python-pip3 3ã€å®‰è£…shadowsocks 1pip3 install shadowsocks 4ã€åˆ›å»ºé…ç½®æ–‡ä»¶ 1sudo touch /etc/shadowsocks.json 5ã€æ·»åŠ é…ç½®å†…å®¹ 1234567891011&#123; "server": "0.0.0.0", // æœåŠ¡ç«¯IP 0.0.0.0å³å¯æ–¹ä¾¿è¿žæŽ¥ "server_port": 50003, // æœåŠ¡å™¨ç«¯å£æ–¹ä¾¿åŽæœŸå®¢æˆ·ç«¯è¿žæŽ¥ "local_address": "127.0.0.1", "local_port": 1080, "password": "******", //è¿žæŽ¥æœåŠ¡å™¨çš„å¯†ç ï¼Œè‡ªå·±è®¾ç½®ï¼Œå®¢æˆ·ç«¯è¿žæŽ¥æ—¶å€™è¦å¡«å†™ "timeout": 300, "method": "aes-256-cfb", // åŠ å¯†æ–¹å¼ "fast_open": false, "workers": 1&#125; é…ç½®ä»¥åŽå¯åŠ¨shadowsocks 1sudo ssserver -c /etc/shadowsocks.json -d start å¦‚æžœé‡åˆ°permission deniedé”™è¯¯è§£å†³æ–¹æ³•å¦‚ä¸‹ 1234# ç¬¬ä¸€æ­¥æŸ¥çœ‹sserverçš„ä½ç½® which ssserver # ç¬¬äºŒæ­¥sudo å¡«å†™å®Œæ•´çš„ssserverè·¯å¾„ -c /etc/shadowsocks.json -d start 6ã€ä¿®æ”¹AWSä¸ŠEC2å®žä¾‹çš„å…¥ç«™ç«¯å£ é…ç½®å¥½ shaodowsocks åŽï¼Œè¿˜éœ€è¦å°†é…ç½®ä¸­çš„ç«¯å£æ‰“å¼€, è¿™æ ·å®¢æˆ·ç«¯çš„æœåŠ¡æ‰èƒ½é“¾æŽ¥å¾—ä¸Š EC2 ä¸­çš„ shadowsocks æœåŠ¡ï¼Œé¦–å…ˆæ‰“å¼€æ­£åœ¨è¿è¡Œçš„å®žä¾‹ï¼Œå‘å³æ»šåŠ¨è¡¨æ ¼ï¼Œæœ€åŽä¸€é¡¹ï¼Œå®‰å…¨ç»„ï¼Œç‚¹å‡»è¿›å…¥ï¼Œç¼–è¾‘å…¥ç«™è§„åˆ™ å››ã€å®¢æˆ·ç«¯è¿žæŽ¥&amp;ä¸Šç½‘1ã€æ‰“å¼€æœ¬åœ°shadowsockså®¢æˆ·ç«¯ 2ã€å¡«å†™ä¿¡æ¯ 3ã€ä¸Šç½‘ é‡åˆ°é—®é¢˜çš„å¯ä»¥ç•™è¨€åŒºç•™è¨€ï¼Œä¸€èµ·çœ‹çœ‹ é…ç½®å¤šç”¨æˆ·ä¸Šç½‘]]></content>
      <categories>
        <category>Record</category>
      </categories>
      <tags>
        <tag>sandowsocks</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®°å½•ä¹‹shellå­¦ä¹ ]]></title>
    <url>%2F2018%2F10%2F09%2F%E8%AE%B0%E5%BD%95%E4%B9%8Bshell%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘åœ¨å­¦ä¹  shellï¼Œå¼€ä¸€ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹ ç›®çš„ï¼šæŽŒæ¡shellçš„åŸºæœ¬è¯­æ³•ï¼Œç¼–ç¨‹æ€æƒ³æ˜¯ä¸å˜çš„ï¼Œä¸åŒçš„è¯­è¨€åªæ˜¯è¯­æ³•ä¸ä¸€æ · å˜é‡çš„å®šä¹‰ å±€éƒ¨å˜é‡å±€éƒ¨å˜é‡ä½œç”¨åŸŸåªæ˜¯åœ¨å½“å‰çš„shæ–‡ä»¶orå½“å‰çš„ç»ˆç«¯å†… 1234# æ–°å»ºvar.sh#!/bin/basha=helloworldecho $a æ‰§è¡Œ 123456# ç¬¬ä¸€ç§æ–¹å¼æ‰§è¡Œbash var.sh# ç¬¬äºŒç§æ–¹å¼æ‰§è¡Œ ./var.sh å‰ææ˜¯æ–‡ä»¶æœ‰å¯æ‰§è¡Œæƒé™ chmod u+x var.sh# ç¬¬ä¸‰ç§æ–¹å¼æ‰§è¡Œsource var.sh è¾“å‡º 1helloworld å¤‡æ³¨1ï¼šshellå˜é‡èµ‹å€¼ â€˜=â€™ä¸¤è¾¹ä¸èƒ½æœ‰ç©ºæ ¼ å¤‡æ³¨2: shellå˜é‡èµ‹çš„å€¼å¦‚æžœä¸æ˜¯è¿žç»­çš„ï¼Œæœ‰ç©ºæ ¼çš„éœ€è¦ä½¿ç”¨å•/åŒå¼•å· a=&#39;hello world&#39;,è¿™æ—¶å€™éœ€è¦å¼•å·åŒ…è£¹â€˜ å¤‡æ³¨3: shellå˜é‡èµ‹çš„å€¼å¦‚æžœé‡Œé¢æœ‰å¦å¤–çš„å˜é‡ 12345key='test'a="hello $key world" # æ³¨æ„è¿™é‡Œé¢ä¸€å®šè¦ç”¨åŒå¼•å·åŒ…è£¹echo a# è¾“å‡ºhello test world #####ç³»ç»Ÿå‘½ä»¤å˜é‡å®šä¹‰ å…ˆæ‰§è¡Œå‘½ä»¤ï¼Œå°†å‘½ä»¤æ‰§è¡Œä¹‹åŽçš„ç»“æžœå­˜åˆ°å˜é‡å½“ä¸­ 1234cmd=`ls`orcmd=$(ls)echo $cmd è¾“å‡º 1å½“å‰ç›®å½•æ–‡ä»¶æ•ˆæžœåŒ `ls` å…¨å±€å˜é‡ ç³»ç»Ÿæ‰€æœ‰çŽ¯å¢ƒéƒ½å¯ä»¥ä½¿ç”¨çš„å˜é‡ æŸ¥çœ‹æ–¹æ³•ï¼šenv å®šä¹‰æ–¹å¼ åˆ†æ­¥éª¤å®šä¹‰ å®šä¹‰ä¸€ä¸ªæœ¬åœ°å˜é‡ 12# å˜é‡å=å˜é‡å€¼name=qiangzai å£°æ˜Žä¸ºå…¨å±€å˜é‡ 12# export å˜é‡åexport name åŒæ—¶å®šä¹‰ export å˜é‡å=å˜é‡å€¼ 1export å˜é‡å=å˜é‡å€¼ å†…ç½®å˜é‡ bashå‘½ä»¤å†…éƒ¨å·²ç»å®šä¹‰å¥½çš„å˜é‡ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨ï¼Œä¸éœ€è¦å®šä¹‰ ä½¿ç”¨æ–¹æ³• å’Œshellè„šæœ¬æœ‰å…³çš„å†…ç½®å˜é‡ $0 èŽ·å–å½“å‰è„šæœ¬åç§° $# èŽ·å–å½“å‰è„šæœ¬çš„å‚æ•°ä¸ªæ•° $n èŽ·å–å½“å‰è„šæœ¬èŽ·å–åˆ°çš„ç¬¬nä¸ªå‚æ•° $? èŽ·å–ä¸Šä¸€æ¬¡å‘½ä»¤çš„æ‰§è¡Œæƒ…å†µï¼Œ0è¡¨ç¤ºæˆåŠŸ $$ è„šæœ¬è¿è¡Œæ—¶ä½¿ç”¨çš„è¿›ç¨‹å· $@ èŽ·å–æ‰€æœ‰çš„å‚æ•° å’Œå­—ç¬¦ä¸²ç›¸å…³çš„å†…ç½®å˜é‡ å­—ç¬¦ä¸²åˆ‡å‰² 12$&#123;var_name:start:n&#125;# var_nameæ˜¯å­—ç¬¦ä¸²å˜é‡å startæ­£æ•° ä»Žå¼€å¤´å¼€å§‹ nè¡¨ç¤ºæˆªå–å­—ç¬¦çš„ä¸ªæ•° æ¡ˆä¾‹ï¼šæˆªå–å­—ç¬¦ä¸²â€™abcdefgâ€™,ä»Žcå¼€å§‹æˆªå–2ä¸ªå­—ç¬¦ 12alpha="abcdefg"echo $&#123;alpha:3:2&#125; å’Œé»˜è®¤å€¼ç›¸å…³çš„å†…ç½®å˜é‡ ç¬¬ä¸€ç§ 1234# èŽ·å–è„šæœ¬ç¬¬ä¸€ä¸ªå‚æ•°var_name=$1# defalutè¡¨ç¤ºé»˜è®¤å€¼ï¼Œå¦‚æžœæ²¡æœ‰è¾“å…¥å‚æ•°ï¼Œdefaultå°†ä¼šè¢«ä½¿ç”¨$&#123;var_name:-default&#125; ç¬¬äºŒç§ 123var_name=$1# å°†ä¼šæ— è§†è¾“å…¥å‚æ•°ï¼Œç›´æŽ¥è¾“å‡ºè®¾å®šå¥½çš„é»˜è®¤å€¼$&#123;var_name:+default&#125; æŸ¥çœ‹å˜é‡çš„3ç§æ–¹å¼123456# å®šä¹‰ä¸€ä¸ªå˜é‡name=qinagzai# æ‰“å°ä¸€ä¸‹å˜é‡echo $name echo "$name"echo "&#123;$name&#125;" # æŽ¨èä½¿ç”¨ï¼Œæœ€è§„èŒƒ åˆ é™¤å˜é‡&amp;è®¾ç½®å˜é‡åªè¯»12unset å˜é‡åreadonly å˜é‡å è¯­æ³•å­¦ä¹  éªŒè¯è¡¨è¾¾å¼ æ–¹å¼ä¸€ 1[ è¡¨è¾¾å¼ ] æ–¹å¼äºŒ 1test è¡¨è¾¾å¼ è¡¨è¾¾å¼ä¸¤ä¾§å¿…é¡»è¦æœ‰ç©ºæ ¼ï¼Œè¡¨è¾¾å¼ä¹‹é—´éœ€è¦æœ‰ç©ºæ ¼ï¼Œä¸ç„¶è¡¨è¾¾å¼è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªæ•´ä½“ æ¡ˆä¾‹ 12345678910# èŽ·å–å‚æ•°ä¸ªæ•°arg_nums=$## æ–¹å¼ä¸€éªŒè¯[ "$&#123;arg_nums&#125;" -eq 3 ] # è¡¨ç¤ºè„šæœ¬å‚æ•°ä¸ç­‰äºŽ3# æ–¹å¼äºŒtest "$&#123;arg_nums&#125;" -eq 3 # æ„æ€åŒä¸Š# æ‰“å°æ‰§è¡Œç»“æžœ 1è¡¨ç¤ºéªŒè¯é€šè¿‡ï¼Œ0è¡¨ç¤ºå¤±è´¥echo $? é€»è¾‘è¡¨è¾¾å¼ -eq //ç­‰äºŽ -ne //ä¸ç­‰äºŽ -gt //å¤§äºŽ ï¼ˆgreater ï¼‰ -lt //å°äºŽ ï¼ˆlessï¼‰ -ge //å¤§äºŽç­‰äºŽ -le //å°äºŽç­‰äºŽ å‘½ä»¤çš„é€»è¾‘å…³ç³»ï¼š åœ¨linux ä¸­ å‘½ä»¤æ‰§è¡ŒçŠ¶æ€ï¼š0 ä¸ºçœŸï¼Œå…¶ä»–ä¸ºå‡ &amp;&amp;å¹¶ å‘½ä»¤1&amp;&amp;å‘½ä»¤2 å¦‚æžœå‘½ä»¤1æ‰§è¡ŒæˆåŠŸï¼Œåˆ™æ‰§è¡Œå‘½ä»¤2 å¦‚æžœå‘½ä»¤1æ‰§è¡Œå¤±è´¥ï¼Œåˆ™ä¸æ‰§è¡Œå‘½ä»¤2 || æˆ– å‘½ä»¤1||å‘½ä»¤2 å¦‚æžœå‘½ä»¤1æ‰§è¡ŒæˆåŠŸï¼Œåˆ™ä¸æ‰§è¡Œå‘½ä»¤2 å¦‚æžœå‘½ä»¤1æ‰§è¡Œä¸æˆåŠŸï¼Œåˆ™æ‰§è¡Œå‘½ä»¤2 shellæ–‡ä»¶è¡¨è¾¾å¼ -e åˆ¤æ–­è¾“å…¥çš„å†…å®¹è¡¨ç¤ºçš„æ–‡ä»¶æ˜¯å¦å­˜åœ¨ -fåˆ¤æ–­è¾“å…¥çš„å†…å®¹æ˜¯å¦æ˜¯ä¸€ä¸ªæ–‡ä»¶ -dåˆ¤æ–­è¾“å…¥çš„å†…å®¹æ˜¯å¦æ˜¯ä¸€ä¸ªç›®å½• -xåˆ¤æ–­è¾“å…¥çš„æ–‡ä»¶æ˜¯å¦æœ‰å¯æ‰§è¡Œæƒé™ -råˆ¤æ–­æ–‡ä»¶æ˜¯å¦å¯è¯» -wåˆ¤æ–­æ–‡ä»¶æ˜¯å¦å¯å†™ 12# ä½¿ç”¨æ–¹å¼ æ³¨æ„æœ‰ç©ºæ ¼[ æ–‡ä»¶è¡¨è¾¾å¼ æ–‡ä»¶å ] sehllå­—ç¬¦ä¸²è¡¨è¾¾å¼ == åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ ï¼= åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ä¸ä¸€è‡´ -zåˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸º0 -nåˆ¤æ–­å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦ä¸ä¸º0 shellæµç¨‹æŽ§åˆ¶ å•ifè¯­å¥ 1234if æ¡ä»¶è¯­å¥then æ‰§è¡Œè¯­å¥fi if elseè¯­å¥ 123456if æ¡ä»¶è¯­å¥1then æ‰§è¡Œè¯­å¥1else æ‰§è¡Œè¯­å¥2fi åŒifè¯­å¥ 123456789if æ¡ä»¶è¯­å¥1then æ‰§è¡Œè¯­å¥1elif æ¡ä»¶è¯­å¥2then æ‰§è¡Œè¯­å¥2else æ‰§è¡Œè¯­å¥3fi caseè¯­å¥ 1234567891011case å€¼ in å€¼1ï¼‰ æ‰§è¡Œè¯­å¥1 ;; å€¼2ï¼‰ æ‰§è¡Œè¯­å¥2 ;; å€¼3ï¼‰ æ‰§è¡Œè¯­å¥3 ;;esac æ¡ˆä¾‹ 1234567891011121314151617#!/usr/bininstruct=$1case "$&#123;instruct&#125;" in start) echo "ç³»ç»Ÿå¯åŠ¨" ;; stop) echo "ç³»ç»Ÿå…³é—­" ;; reload) echo "ç³»ç»Ÿé‡å¯" ;; *) echo "å¯åŠ¨æ–¹å¼æ˜¯ï¼šsh $0 [start|stop|reload]"esac å¾ªçŽ¯æŽ§åˆ¶è¯­å¥1234for æ¡ä»¶do æ‰§è¡Œè¯­å¥done Shellä¸­çš„å‡½æ•° 1234567891011121314# æ— å‚æ•°æ ¼å¼func_name()&#123; å‡½æ•°ä½“&#125;#è°ƒç”¨func_name# æœ‰å‚æ•°æ ¼å¼func_name()&#123; args=$n å‡½æ•°ä½“&#125;# è°ƒç”¨func_name args1 args2]]></content>
      <categories>
        <category>Shell</category>
      </categories>
      <tags>
        <tag>shell</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®°å½•ä¹‹å¸¸è§æ•°æ®ç»“æž„çš„åŒºåˆ«å’Œè”ç³»]]></title>
    <url>%2F2018%2F09%2F28%2F%E8%AE%B0%E5%BD%95%E4%B9%8B%E5%B8%B8%E8%A7%81%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%9A%84%E5%8C%BA%E5%88%AB%E5%92%8C%E8%81%94%E7%B3%BB%2F</url>
    <content type="text"><![CDATA[ä»‹ç»æœ¬æ–‡ä¸»è¦æ€»ç»“ä¸‹æ•°ç»„,é“¾è¡¨,é˜Ÿåˆ—,æ ˆçš„åŒºåˆ«å’Œè”ç³» è”ç³» è¿™å››ç§æ•°æ®ç»“æž„éƒ½æ˜¯çº¿æ€§è¡¨æ•°æ®ç»“æž„,å¸¸è§çš„æ•°æ®ç»“æž„å¯ä»¥åˆ’åˆ†ä¸º:çº¿æ€§ç»“æž„/æ ‘ç»“æž„/å›¾ç»“æž„ åŒºåˆ« æ•°ç»„å’Œé“¾è¡¨æ˜¯æ›´åŠ åå‘æ•°æ®å­˜å‚¨æ–¹å¼çš„æ¦‚å¿µ,æ•°ç»„æœ‰ç´¢å¼•,åœ¨è¿žç»­çš„ç©ºé—´ä¸­å­˜å‚¨æ•°æ®,éšæœºè¯»å–çš„æ•ˆçŽ‡é«˜,ä½†æ˜¯æ•°æ®çš„æ·»åŠ åˆ é™¤çš„æ•ˆçŽ‡æ¯”è¾ƒä½Ž;è€Œé“¾è¡¨å¯ä»¥åœ¨éžè¿žç»­çš„ç©ºé—´ä¸­å­˜å‚¨æ•°æ®,éšæœºè®¿é—®æ•ˆçŽ‡ä½Ž,æ•°æ®æ·»åŠ åˆ é™¤æ•ˆçŽ‡é«˜. é˜Ÿåˆ—å’Œæ ˆæ˜¯æè¿°æ•°æ®å­˜å–æ–¹å¼çš„æ¦‚å¿µ,é˜Ÿåˆ—æ˜¯å…ˆè¿›å…ˆå‡º,è€Œå †æ ˆæ˜¯åŽè¿›å…ˆå‡º;é˜Ÿåˆ—å’Œæ ˆéƒ½å¯ä»¥ä½¿ç”¨æ•°ç»„æˆ–è€…é“¾è¡¨åŽ»å®žçŽ°.]]></content>
      <categories>
        <category>Record</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[çˆ¬è™«ä¹‹å¸¸è§é—®é¢˜æ€»ç»“]]></title>
    <url>%2F2018%2F07%2F31%2F%E7%88%AC%E8%99%AB%E4%B9%8B%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93%2F</url>
    <content type="text"><![CDATA[ç›®çš„ï¼šè®°å½•çˆ¬è™«ä¸­é‡åˆ°çš„å‘â€¦â€¦ xpathæå–æ•°æ®é‡åˆ°tbodyæ ‡ç­¾ é—®é¢˜æè¿°ï¼šä»Šå¤©åœ¨ç”¨scrapyçˆ¬å–ç½‘é¡µæ—¶ï¼Œå½“çˆ¬å–è¡¨æ ¼å†…å®¹æ—¶ï¼Œå‘çŽ°ä½¿ç”¨æ’ä»¶ xpath helperèŽ·å–æ­£å¸¸ï¼Œç¨‹åºä¸­çš„xpathè§£æžä¸åˆ° é—®é¢˜åŽŸå› ï¼šæµè§ˆå™¨ä¼šåœ¨tableæ ‡ç­¾ä¸‹æ·»åŠ tbodyæ ‡ç­¾ï¼Œæµè§ˆå™¨ä¼šå¯¹htmlæ–‡ä»¶è¿›è¡Œä¸€å®šçš„è§„èŒƒåŒ–ï¼Œä½†æ˜¯æºç å½“ä¸­æ˜¯æ²¡æœ‰tbodyæ ‡ç­¾çš„ã€‚ è§£å†³åŠžæ³•ï¼šå°†åˆ†æžçš„xpathè¯­å¥ä¸­æŠŠtbodyåŽ»æŽ‰å³å¯ Scrapydè¿è¡ŒåŽè¢«æ‹’ç»è®¿é—® é—®é¢˜æè¿°ï¼šæˆ‘åœ¨è…¾è®¯æœåŠ¡å™¨è¿è¡Œscrapydé¡¹ç›®éƒ¨ç½²ï¼Œå¯åŠ¨ä»¥åŽè®¿é—®6800ç«¯å£è¢«æ‹’ç»ï¼Œç¬¬ä¸€ååº”å°±æ˜¯è…¾è®¯äº‘çš„å®‰å…¨ç»„é…ç½®é—®é¢˜ï¼ŒåŽæ¥å‘çŽ°è‡ªå·±çš„å‡ºç«™ç«¯å£6800æ—©å·²æ‰“å¼€ã€‚ç¿»äº†ç¿»æ—¥å¿—ï¼Œçœ‹åˆ°ä¸‹é¢è¿™å¥ä»£ç  1[-] Scrapyd web console available at http://127.0.0.1:6800/ å“ˆå“ˆï¼Œå°´å°¬çš„127.0.0.1ï¼Œåˆ¤æ–­éœ€è¦ä¿®æ”¹scrapydçš„é…ç½®æ–‡ä»¶ è§£å†³é—®é¢˜ 1ã€æ‰¾åˆ°é…ç½®æ–‡ä»¶ï¼Œå…ˆæ‰¾Pythonçš„ç¬¬ä¸‰æ–¹åº“ scrapyd å®‰è£…ç›®å½• æˆ‘è¿™é‡Œæ‰¾äº†åŠå¤©æ²¡æ‰¾åˆ°ï¼Œå°±æ˜¯ç”¨ findå¤§æ³•äº† sudo find / -name scrapyd 2ã€æ‰¾åˆ°ç›®å½•ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯ cdåˆ°å®‰è£…ç›®å½•ä¸‹ 1cd /usr/....../scrapyd 3ã€æ‰¾åˆ° default_scrapyd.confï¼Œå¹¶æ‰“å¼€ä¿®æ”¹ 1bind_address = 127.0.0.1 ä¸º 1bind_address = 0.0.0.0 ç„¶åŽä¿å­˜é€€å‡ºï¼Œé‡è¯•ä¸€ä¸‹å°±okï¼]]></content>
      <categories>
        <category>Spider</category>
      </categories>
      <tags>
        <tag>spider_error</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Pythonçš„PEPæ–‡æ¡£]]></title>
    <url>%2F2018%2F07%2F09%2FPython%E7%9A%84PEP%E6%96%87%E6%A1%A3%2F</url>
    <content type="text"><![CDATA[What is PEP? Pythonçš„ PEPæ–‡æ¡£æ˜¯ä¸€ç»„ä¸æ–­å‘å±•çš„æ ‡å‡†æ–‡æ¡£, PEPæ˜¯ Python Enhancement Proposalé¦–å­—æ¯çš„ç¼©å†™,å°±åƒTCP/IPåè®®ä½¿ç”¨RFCä¸æ–­å‘å±•æˆä¸ºé€šä¿¡æ ‡å‡†ä¸€æ ·,PEPä¹Ÿæ˜¯ç±»ä¼¼çš„ç”¨äºŽå‘å±•Pythonçš„ä¸€ç»„æ–‡æ¡£. 12345PEP stands for Python Enhancement Proposal. A PEP is a design document providing information to the Python community, or describing a new feature for Python or its processes or environment. The PEP should provide a concise technical specification of the feature and a rationale for the feature.We intend PEPs to be the primary mechanisms for proposing major new features, for collecting community input on an issue, and for documenting the design decisions that have gone into Python. The PEP author is responsible for building consensus within the community and documenting dissenting opinions.Because the PEPs are maintained as text files in a versioned repository, their revision history is the historical record of the feature proposal [1]. æœ‰é“ç¿»è¯‘ä¸€æ³¢ PEPä»£è¡¨Pythonå¢žå¼ºå»ºè®®ã€‚PEPæ˜¯ä¸€ç§è®¾è®¡æ–‡æ¡£ï¼Œå®ƒå‘Pythonç¤¾åŒºæä¾›ä¿¡æ¯ï¼Œæˆ–è€…æè¿°Pythonæˆ–å…¶æµç¨‹æˆ–çŽ¯å¢ƒçš„æ–°ç‰¹æ€§ã€‚PEPåº”è¯¥æä¾›ç‰¹æ€§çš„ç®€æ˜ŽæŠ€æœ¯è§„èŒƒå’Œç‰¹æ€§çš„åŸºæœ¬åŽŸç†ã€‚ æˆ‘ä»¬æ‰“ç®—å°†PEPsä½œä¸ºæå‡ºä¸»è¦æ–°ç‰¹æ€§çš„ä¸»è¦æœºåˆ¶ï¼Œç”¨äºŽæ”¶é›†å…³äºŽæŸä¸ªé—®é¢˜çš„ç¤¾åŒºè¾“å…¥ï¼Œä»¥åŠè®°å½•Pythonä¸­çš„è®¾è®¡å†³ç­–ã€‚PEPä½œè€…è´Ÿè´£åœ¨ç¤¾åŒºå†…å»ºç«‹å…±è¯†å¹¶è®°å½•ä¸åŒæ„è§ã€‚ å› ä¸ºpepæ˜¯ä½œä¸ºæ–‡æœ¬æ–‡ä»¶åœ¨ç‰ˆæœ¬åŒ–çš„å­˜å‚¨åº“ä¸­ç»´æŠ¤çš„ï¼Œæ‰€ä»¥å®ƒä»¬çš„ä¿®è®¢åŽ†å²è®°å½•æ˜¯ç‰¹æ€§å»ºè®®[1]çš„åŽ†å²è®°å½•ã€‚ è¯´ç™½äº†å…¶å®žå°±æ˜¯è®°å½•æ–‡æ¡£~ PEP8ç¨‹åºå‘˜çœ‹çš„æ¯”è¾ƒå¤šçš„æ˜¯ PEP8æ–‡æ¡£,è¿™æ˜¯å®˜æ–¹å‡ºçš„ç¼–ç¨‹è§„èŒƒ. PEPæ–‡æ¡£å¾ˆå¤š,è¯´æ˜ŽPythonçš„ç¤¾åŒºéžå¸¸æ´»è·ƒ,Pythonä¹Ÿå°±è¶Šæµè¡Œ~]]></content>
      <categories>
        <category>Python-Basis</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[è®°å½•ä¹‹Gitä½¿ç”¨]]></title>
    <url>%2F2018%2F06%2F05%2F%E8%AE%B0%E5%BD%95%E4%B9%8BGit%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[Gitä»‹ç»Gitæ˜¯ç›®å‰ä¸–ç•Œä¸Šæœ€å…ˆè¿›çš„åˆ†å¸ƒå¼ç‰ˆæœ¬æŽ§åˆ¶ç³»ç»Ÿ æ–¹ä¾¿å¤šäººåä½œå¼€å‘ æ–¹ä¾¿ç‰ˆæœ¬æŽ§åˆ¶ GitåŸºæœ¬æµç¨‹å›¾ å·¥ä½œåŒº&amp;æš‚å­˜åŒº&amp;ä»“åº“åŒºä»‹ç»å·¥ä½œåŒº å¯¹äºŽæ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤æ–‡ä»¶çš„æ“ä½œï¼Œéƒ½å‘ç”Ÿåœ¨å·¥ä½œåŒºä¸­ æš‚å­˜åŒº æš‚å­˜åŒºæŒ‡å°†å·¥ä½œåŒºä¸­çš„æ“ä½œå®Œæˆå°é˜¶æ®µçš„å­˜å‚¨ï¼Œæ˜¯ç‰ˆæœ¬åº“çš„ä¸€éƒ¨åˆ† ä»“åº“åŒº ä»“åº“åŒºè¡¨ç¤ºä¸ªäººå¼€å‘çš„ä¸€ä¸ªå°é˜¶æ®µçš„å®Œæˆ ä»“åº“åŒºä¸­è®°å½•çš„å„ç‰ˆæœ¬æ˜¯å¯ä»¥æŸ¥çœ‹å¹¶å›žé€€çš„ ä½†æ˜¯æš‚å­˜åŒºçš„ç‰ˆæœ¬ä¸€æ—¦æäº¤å°±æ²¡æœ‰äº† æœ¬åœ°Gitå¸¸è§æ“ä½œåŸºæœ¬é…ç½® åˆå§‹åŒ–ä»“åº“ 12git init# ä¼šåœ¨åˆå§‹åŒ–çš„è·¯å¾„ä¸‹äº§ç”Ÿéšè—æ–‡ä»¶å¤¹.git é…ç½®ä¸ªäººä¿¡æ¯ 1234git config user.name 'qiang-zai'git config user.email 'china_qiangzai@163.com'# é…ç½®çš„ä¸ªäººä¿¡æ¯åœ¨.git/configæ–‡ä»¶ä¸‹å¯ä»¥æŸ¥çœ‹# é»˜è®¤ä¸é…ç½®çš„è¯ï¼Œä¼šä½¿ç”¨å…¨å±€é…ç½®é‡Œé¢çš„ç”¨æˆ·åå’Œé‚®ç®±ï¼›å…¨å±€gité…ç½®æ–‡ä»¶è·¯å¾„ï¼šï½ž/.gitconfig æŸ¥çœ‹æ–‡ä»¶çŠ¶æ€ 1git status åŸºæœ¬æ“ä½œ å°†å·¥ä½œåŒºæ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº git add . # æ·»åŠ é¡¹ç›®ä¸­çš„æ‰€æœ‰æ–‡ä»¶åˆ°æš‚å­˜åŒº git add xxx.py # æ·»åŠ å•ŠæŒ‡å®šæ–‡ä»¶åˆ°æš‚å­˜åŒº å°†æš‚å­˜åŒºæ–‡ä»¶æäº¤åˆ°ä»“åº“åŒº commitä¼šç”Ÿæˆä¸€æ¡ç‰ˆæœ¬è®°å½• -måŽé¢æ˜¯ç‰ˆæœ¬æè¿°ä¿¡æ¯ 1git commit -m 'ç‰ˆæœ¬æè¿°' å°†å·¥ä½œåŒºä¿®æ”¹çš„æ–‡ä»¶ç›´æŽ¥æäº¤åˆ°ä»“åº“åŒº 1git commit -am 'ç‰ˆæœ¬æè¿°' æŸ¥çœ‹åŽ†å²ç‰ˆæœ¬ 123git log git reflog# git reflogå¯ä»¥æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯çš„æ‰€æœ‰æ“ä½œè®°å½•ï¼ˆåŒ…å«commitå’Œresetçš„æ“ä½œï¼‰ï¼ŒåŒ…æ‹¬å·²ç»åˆ é™¤çš„commitè®°å½•ï¼Œgit log åˆ™ä¸èƒ½æŸ¥çœ‹å·²ç»åˆ é™¤çš„commitè®°å½• å›žé€€ç‰ˆæœ¬ï¼ˆæœ¬åœ°ä»“åº“&gt;å·¥ä½œåŒºï¼‰ æ–¹æ¡ˆä¸€:ç‰ˆæœ¬è¾ƒå°‘çš„æ—¶å€™æŽ¨èä½¿ç”¨ HEADè¡¨ç¤ºå½“å‰æœ€æ–°ç‰ˆæœ¬ HEAD^è¡¨ç¤ºå½“å‰æœ€æ–°ç‰ˆæœ¬çš„å‰ä¸€ä¸ªç‰ˆæœ¬ HEAD^^è¡¨ç¤ºå½“å‰æœ€æ–°ç‰ˆæœ¬çš„å‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚ã€‚ã€‚ HEAD~1è¡¨ç¤ºå½“å‰æœ€æ–°ç‰ˆæœ¬çš„å‰ä¸€ä¸ªç‰ˆæœ¬ HEAD~10è¡¨ç¤ºå½“å‰æœ€æ–°ç‰ˆæœ¬çš„å‰10ä¸ªç‰ˆæœ¬ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚ã€‚ã€‚ 1git reset --hard HEAD^ æ–¹æ¡ˆäºŒï¼šç‰ˆæœ¬è¾ƒå¤šçš„æ—¶é—´æŽ¨èä½¿ç”¨ é€šè¿‡æ¯ä¸ªç‰ˆæœ¬çš„ç‰ˆæœ¬å·å›žé€€åˆ°æŒ‡å®šç‰ˆæœ¬ git reflogæ¥æŸ¥çœ‹ç‰ˆæœ¬å· 1git reset --hard ç‰ˆæœ¬å· æ’¤é”€ä¿®æ”¹ åªèƒ½æ’¤é”€å·¥ä½œåŒºã€æš‚å­˜åŒºçš„ä»£ç ï¼Œä¸èƒ½æ’¤é”€æœ¬åœ°ä»“åº“çš„ä»£ç  æ’¤é”€æœ¬åœ°ä»“åº“çš„ä»£ç ç­‰äºŽç‰ˆæœ¬å›žé€€æ“ä½œ æ’¤é”€å·¥ä½œåŒºä»£ç  1git checkout æ–‡ä»¶å æ’¤é”€æš‚å­˜åŒºä»£ç  1234# ç¬¬ä¸€æ­¥ å°†æš‚å­˜åŒºä»£ç æ’¤é”€åˆ°å·¥ä½œåŒºgit reset HEAD æ–‡ä»¶å# ç¬¬äºŒæ­¥ æ’¤é”€å·¥ä½œåŒºä»£ç git checkout æ–‡ä»¶å å¯¹æ¯”ç‰ˆæœ¬åº“ å¯¹æ¯”ç‰ˆæœ¬åº“ï¼ˆæœ¬åœ°ä»“åº“ï¼‰ä¸Žå·¥ä½œåŒº 1git diff HEAD -- xxx.py å¯¹æ¯”ç‰ˆæœ¬åº“ 1git diff HEAD HEAD^ -- xxx.py åˆ é™¤æ–‡ä»¶ï¼šåˆ é™¤æ–‡ä»¶åˆ†ä¸ºç¡®å®šåˆ é™¤å’Œè¯¯åˆ  ç¡®å®šåˆ é™¤å¤„ç† 123456# åˆ é™¤æ–‡ä»¶(æ–‡ä»¶å·²ç»å­˜åœ¨æœ¬åœ°ä»“åº“ç‰ˆæœ¬åº“å½“ä¸­äº†)rm æ–‡ä»¶å# gitç¡®å®šåˆ é™¤æ–‡ä»¶git rm æ–‡ä»¶å# åˆ é™¤åŽè®°å½•åˆ é™¤æ“ä½œç‰ˆæœ¬git commit -m 'åˆ é™¤xxxæ–‡ä»¶' è¯¯åˆ æ–‡ä»¶ 1234# åˆ é™¤æ–‡ä»¶rm æ–‡ä»¶å# git æ’¤é”€ä¿®æ”¹git checkout -- æ–‡ä»¶å ååŒå¼€å‘å…‹éš†é¡¹ç›® å‰æéœ€è¦åœ¨GitHub/å…¶ä»–gitæœåŠ¡å™¨åˆ›å»ºå¥½é¡¹ç›®ä»“åº“ å…‹éš†è¿œç¨‹ä»“åº“å‘½ä»¤ 1git clone https://github.com/xxxx/xxxx.git é…ç½®é¡¹ç›®å¼€å‘äººå‘˜ä¿¡æ¯ 123cd å…‹éš†çš„æ–‡ä»¶å¤¹git config user.name 'xxx'git config user.email 'xxxx@163.com' ç¼–è¾‘ä»£ç  æŽ¨é€è¿œç«¯ 123456# å·¥ä½œåŒºæ·»åŠ åˆ°æš‚å­˜åŒºgit add .# æš‚å­˜åŒºæäº¤åˆ°ä»“åº“åŒºgit commit -m 'ç¼–è¾‘ä»£ç '# æŽ¨é€è¿œç¨‹ä»“åº“git push åœ¨pushçš„æ—¶å€™éœ€è¦è®¾ç½®è´¦å·å’Œå¯†ç ï¼Œè¯¥å¯†ç åˆ™æ˜¯githubçš„è´¦å·å’Œå¯†ç  å¦‚æžœæ¯æ¬¡pushéƒ½éœ€è¦è®¾ç½®è´¦å·ä¸Žå¯†ç ï¼Œé‚£ä¹ˆå¯ä»¥è®¾ç½®è®°ä½å¯†ç  123456# è®¾ç½®è®°ä½å¯†ç ï¼ˆé»˜è®¤15åˆ†é’Ÿï¼‰ï¼šgit config --global credential.helper cache# å¦‚æžœæƒ³è‡ªå·±è®¾ç½®æ—¶é—´ï¼Œå¯ä»¥è¿™æ ·åš(1å°æ—¶åŽå¤±æ•ˆ)ï¼šgit config credential.helper 'cache --timeout=3600'# é•¿æœŸå­˜å‚¨å¯†ç ï¼šgit config --global credential.helper store åŒæ­¥æœåŠ¡å™¨ä»£ç  1git pull ç¼–è¾‘ä»£ç ä¹‹å‰è¦å…ˆpullï¼Œç¼–ç ç»“æŸä»¥åŽå† commitï¼Œæœ€åŽå† push å†²çªè§£å†³ å®¹æ˜“å†²çªçš„æ“ä½œæ–¹å¼ å¤šä¸ªäººåŒæ—¶æ“ä½œäº†åŒä¸€ä¸ªæ–‡ä»¶ ä¸€ä¸ªäººä¸€ç›´å†™ä¸æäº¤ ä¿®æ”¹ä¹‹å‰ä¸æ›´æ–°æœ€æ–°ä»£ç  æäº¤ä¹‹å‰ä¸æ›´æ–°æœ€æ–°ä»£ç  æ“…è‡ªä¿®æ”¹åŒäº‹ä»£ç  å‡å°‘å†²çªçš„æ“ä½œæ–¹å¼ å…»æˆè‰¯å¥½çš„æ“ä½œä¹ æƒ¯,å…ˆpullåœ¨ä¿®æ”¹,ä¿®æ”¹å®Œç«‹å³commitå’Œpush ä¸€å®šè¦ç¡®ä¿è‡ªå·±æ­£åœ¨ä¿®æ”¹çš„æ–‡ä»¶æ˜¯æœ€æ–°ç‰ˆæœ¬çš„ å„è‡ªå¼€å‘å„è‡ªçš„æ¨¡å— å¦‚æžœè¦ä¿®æ”¹å…¬å…±æ–‡ä»¶,ä¸€å®šè¦å…ˆç¡®è®¤æœ‰æ²¡æœ‰äººæ­£åœ¨ä¿®æ”¹ ä¸‹ç­å‰ä¸€å®šè¦æäº¤ä»£ç ,ä¸Šç­ç¬¬ä¸€ä»¶äº‹æ‹‰å–æœ€æ–°ä»£ç  ä¸€å®šä¸è¦æ“…è‡ªä¿®æ”¹åŒäº‹çš„ä»£ç  æ ‡ç­¾ å½“æŸä¸ªå¤§ç‰ˆæœ¬å®ŒæˆåŽï¼Œå°±éœ€è¦æ‰“æ ‡ç­¾ è®°å½•å¤§ç‰ˆæœ¬ å¤‡ä»½å¤§ç‰ˆæœ¬ä»£ç  æœ¬åœ°æ‰“æ ‡ç­¾ 123git tag -a æ ‡ç­¾å -m 'æ ‡ç­¾æè¿°'# æ¡ˆä¾‹git tag -a v1.0 -m 'version 1.0' æŽ¨é€æ ‡ç­¾åˆ°è¿œç¨‹ä»“åº“ 123git push origin æ ‡ç­¾å# æ¡ˆä¾‹git push origin v1.0 åˆ é™¤æœ¬åœ°å’Œè¿œç¨‹æ ‡ç­¾ 1234# åˆ é™¤æœ¬åœ°æ ‡ç­¾git tag -d æ ‡ç­¾å# åˆ é™¤è¿œç¨‹ä»“åº“æ ‡ç­¾git push origin --delete tag æ ‡ç­¾å åˆ†æ”¯ åˆ†æ”¯çš„ä½œç”¨ åŒºåˆ†ç”Ÿäº§çŽ¯å¢ƒä»£ç ä»¥åŠå¼€å‘çŽ¯å¢ƒä»£ç  è§£å†³çº¿ä¸Šå‡ºçŽ°çš„bugé—®é¢˜ï¼Œæ–¹ä¾¿ä»£ç è°ƒè¯• ç‰¹ç‚¹ é¡¹ç›®å¼€å‘ä¸­å…¬ç”¨åˆ†æ”¯åŒ…æ‹¬ masterã€dev åˆ†æ”¯ masteræ˜¯é»˜è®¤åˆ†æ”¯ï¼Œç”¨äºŽå‘å¸ƒï¼Œå½“éœ€è¦å‘å¸ƒæ—¶å°† devåˆ†æ”¯åˆå¹¶åˆ° master åˆ†æ”¯ devæ˜¯ç”¨äºŽå¼€å‘çš„åˆ†æ”¯ï¼Œå¼€å‘å®Œé˜¶æ®µæ€§çš„ä»£ç åŽï¼Œéœ€è¦åˆå¹¶åˆ° master åˆ†æ”¯ æŸ¥çœ‹å½“å‰åˆ†æ”¯ 1git branch æ²¡æœ‰åˆ›å»ºå…¶ä»–åˆ†æ”¯æ—¶ï¼Œåªæœ‰ masteråˆ†æ”¯ åˆ‡æ¢åˆ†æ”¯ 1git checkout -b dev è®¾ç½®æœ¬åœ°åˆ†æ”¯è·Ÿè¸ªè¿œç¨‹æ‰§è¡Œåˆ†æ”¯ï¼ˆå°†åˆ†æ”¯æŽ¨é€åˆ°è¿œç¨‹ï¼‰ 1git push -u origin dev åœ¨åˆ‡æ¢åŽçš„devåˆ†æ”¯å¼€å‘ï¼Œä¿®æ”¹ä»£ç  devåˆ†æ”¯ä»£ç åˆå¹¶åˆ°masteråˆ†æ”¯å¹¶æäº¤ åªæœ‰å½“devåˆ†æ”¯åˆå¹¶åˆ°masteråˆ†æ”¯å¹¶pushåˆ°è¿œç¨‹ä»“åº“masteråˆ†æ”¯ä»¥åŽï¼Œå…¶ä»–çš„å¼€å‘äººå‘˜æ‰èƒ½èŽ·å–åˆ°æœ€æ–°çš„ä»£ç  åˆ‡æ¢masteråˆ†æ”¯ 1git checkout master åˆå¹¶ devåˆ†æ”¯ä»£ç åˆ° masterä¸»åˆ†æ”¯ 1git merge dev æŽ¨é€åˆå¹¶åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ 1git push å…¶ä»–å¼€å‘äººå‘˜åŒæ­¥åˆå¹¶åŽçš„ä»£ç  1git pull]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[çˆ¬è™«ä¹‹Scrapyæ¡†æž¶]]></title>
    <url>%2F2018%2F05%2F31%2F%E7%88%AC%E8%99%AB%E4%B9%8BScrapy%E6%A1%86%E6%9E%B6%2F</url>
    <content type="text"><![CDATA[Scrapyæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„çˆ¬è™«æ¡†æž¶ï¼Œä¸»è¦æ˜¯ä¸ºäº†æå–ç»“æž„åŒ–æ•°æ®è€Œç¼–å†™çš„åº”ç”¨æ¡†æž¶ï¼Œæˆ‘ä»¬åªéœ€è¦å®žçŽ°å°‘é‡ä»£ç å°±å¯ä»¥å®žçŽ°æ•°æ®çš„å¿«é€ŸèŽ·å–ï¼Œæ¡†æž¶åº•å±‚ä½¿ç”¨çš„Twistedå¼‚æ­¥ç½‘ç»œæ¡†æž¶,æ‰€ä»¥çˆ¬å–é€Ÿåº¦éžå¸¸çš„å¿«ã€‚ æ–‡ç« ç›®çš„ï¼šèƒ½å¤Ÿåˆ©ç”¨scrapyçˆ¬å–æ•°æ® å®‰è£…1pip install scrapy æŸ¥çœ‹å¸¸ç”¨æ“ä½œ(æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ) 1scrapy --help åŸºæœ¬ä½¿ç”¨æµç¨‹ ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºé¡¹ç›®ï¼ˆå›ºå®šæ­¥éª¤ï¼‰ 1scrapy startproject é¡¹ç›®åç§° ç¬¬äºŒæ­¥ï¼šåˆ›å»ºçˆ¬è™«ï¼ˆå›ºå®šæ­¥éª¤ï¼‰ 12cd é¡¹ç›®ç›®å½•scrapy genspider çˆ¬è™«åç§° ç›®æ ‡åŸŸå ç¬¬ä¸‰æ­¥ï¼šç¼–å†™çˆ¬è™«ç»„ä»¶å’Œç®¡é“ï¼ˆä¸»è¦ç¼–å†™çš„éƒ¨åˆ†ï¼‰ 1# åœ¨ç¬¬äºŒæ­¥åˆ›å»ºçš„çˆ¬è™«æ–‡ä»¶å½“ä¸­ç¼–å†™ ç¬¬å››æ­¥ï¼šå¯åŠ¨çˆ¬è™«ï¼ˆå›ºå®šæ­¥éª¤ï¼‰ 1scrapy crawl çˆ¬è™«åç§° scrapyç»„æˆ è¿è¡Œæµç¨‹å›¾ï¼ˆscrapyå®˜æ–¹å…¬å¸ƒï¼‰ å„éƒ¨ä»¶ä½œç”¨ äº”å¤§ç»„ä»¶ å¼•æ“Ž ä¸­å¤®åè°ƒ çˆ¬è™«ç»„ä»¶ æå–æ•°æ® or urlï¼Œç”Ÿæˆè¯·æ±‚å¯¹è±¡ è¯·æ±‚è°ƒåº¦å™¨ å­˜æ”¾è¯·æ±‚å¯¹è±¡ ä¸‹è½½å™¨ å‘é€è¯·æ±‚èŽ·å–å“åº” ç®¡é“ ä¿å­˜æ•°æ® ä¸‰å¤§å¯¹è±¡ Requestè¯·æ±‚å¯¹è±¡ Responseå“åº”å¯¹è±¡ Itemæ•°æ®å¯¹è±¡ ä¸¤å¤§ä¸­é—´ä»¶ ä¸‹è½½ä¸­é—´ä»¶ çˆ¬è™«ä¸­é—´ä»¶ é¡¹ç›®ç›®å½•ç»“æž„ä»‹ç» spider-projecté¡¹ç›®ç›®å½• __init__.py items.pyå®šä¹‰æ•°æ®æ¨¡åž‹ middlewares.pyè‡ªå®šä¹‰ä¸­é—´ä»¶ pipelines.pyè‡ªå®šä¹‰ç®¡é“ï¼Œä¿å­˜æ•°æ® settings.pyé¡¹ç›®é…ç½®æ–‡ä»¶ scrapy.cfgé¡¹ç›®éƒ¨ç½²æ–‡ä»¶ spidersçˆ¬è™«ç»„ä»¶ç›®å½• xxx.pyå…·ä½“å®žçŽ°çˆ¬è™«çš„æ–‡ä»¶ é€šè¿‡ scrapy genspider çˆ¬è™«åç§°â€“&gt;ç”Ÿæˆçš„çˆ¬è™«éƒ½åœ¨è¿™ä¸ªç›®å½•ä¸‹ äº”å¤§ç»„ä»¶ä¹‹çˆ¬è™«ç»„ä»¶ ä½œç”¨ï¼šæå–æ•°æ® | æå–urlè¿”å›žè¯·æ±‚å¯¹è±¡ å…·ä½“ç¼–å†™æ­¥éª¤1ã€ç»§æ‰¿çˆ¬è™«ç±» 123456# -*- coding: utf-8 -*-# å¯¼å…¥æ¨¡å—import scrapy# ç»§æ‰¿çˆ¬è™«ç±»class ExampleSpider(scrapy.Spider): ... 2ã€å®šä¹‰çˆ¬è™«åç§° 1name = 'example' 3ã€è®¾ç½®å…è®¸çˆ¬å–çš„èŒƒå›´ 1allowed_domains = ['example.com'] 4ã€è®¾ç½®å¼€å§‹çˆ¬å–çš„è¯·æ±‚åœ°å€ 1start_urls = ['https://wxample.com/xxxx'] 5ã€å®žçŽ°è§£æžå‡½æ•° â€‹ 1ã€æå–æ•°æ® â€‹ 2ã€æå–urlï¼Œè¿”å›žè¯·æ±‚å¯¹è±¡ 12def parse(self, response): pass å“åº”å¯¹è±¡responseåŸºæœ¬ä¿¡æ¯ response.status &gt;&gt; å“åº”çŠ¶æ€ç  response.headers &gt;&gt; å“åº”å¤´ response.text&gt;&gt; å“åº”å†…å®¹ response.request.cookies&gt;&gt;èŽ·å–cookies Selectorå¯¹è±¡åŸºæœ¬æ“ä½œ extract()æå–æ•°æ®ï¼Œæå–ä¸åˆ°ä¼šæŠ›å‡ºä¸‹æ ‡å¼‚å¸¸ extract_first()æå–ç¬¬ä¸€æ¡æ•°æ®ï¼Œæå–ä¸åˆ°è¿”å›žNone æå–&amp;æž„å»ºè¯·æ±‚å¯¹è±¡12345# æž„å»ºè¯·æ±‚å¯¹è±¡request = scrapy.Request(url='xxxx')# è¿”å›žè¯·æ±‚å¯¹è±¡&gt;&gt;å¼•æ“Ž&gt;&gt;è¯·æ±‚è°ƒåº¦ï¼ˆschedulerï¼‰å™¨&gt;&gt;è¯·æ±‚ä¸‹è½½å™¨yield request å‚æ•°callbackæŒ‡å®šè¯·æ±‚å¯¹è±¡çš„è§£æžå‡½æ•° å‚æ•° metaæŠŠæ•°æ®å¯ä»¥ä¼ é€’ç»™è§£æžå‡½æ•° 12345yield scrapy.Request(url=detail_url, callback=self.parse_detail, meta=&#123; 'item':item &#125;) äº”å¤§ç»„ä»¶ä¹‹ç®¡é“ ç³»ç»Ÿç®¡é“1ã€æå–å‡½æ•°ä¸­ä½¿ç”¨ yieldè¿”å›žå‡½æ•° 2ã€å‘½ä»¤è¡Œå¯¼å‡º 1scrapy crawl çˆ¬è™«åç§° -o å¯¼å‡ºæ–‡ä»¶åç§° è‡ªå®šä¹‰ç®¡é“1ã€åœ¨ pipelines.pyç¼–å†™ç®¡é“ â€‹ 1ã€åˆ›å»ºç®¡é“ç±» â€‹ 2ã€å®žçŽ°ç®¡é“å¤„ç†æ•°æ®æ–¹æ³• â€‹ 2.1 process_itemå¿…é¡»å®žçŽ° â€‹ 2.2 open_spider å¯é€‰å®žçŽ°ï¼Œå½“çˆ¬è™«å¯åŠ¨æ—¶è°ƒç”¨ä¸€æ¬¡ â€‹ 2.3 close_spider å¯é€‰å®žçŽ°ï¼Œå½“çˆ¬è™«ç»“æŸæ—¶è°ƒç”¨ä¸€æ¬¡ 12345678# pipelines.pyclass JsonDataPipeline(object): '''åˆ›å»ºç®¡é“ç±»''' def process_item(self, item, spider): '''å®žçŽ°ç®¡é“å¤„ç†æ•°æ®æ–¹æ³• --&gt;yield item--&gt;å¼•æ“Ž--&gt;è§¦å‘process_itemæ–¹æ³• ''' pass 2ã€åœ¨ settings.pyä¸­å¼€å¯ç®¡é“ 1234ITEM_PIPELINEs = &#123; # åœ¨é‡Œé¢é…ç½®è‡ªå·±å®šä¹‰çš„ç®¡é“ç±» 'xxx.pipelines.å®šä¹‰çš„ç®¡é“ç±»åç§°':score # score è¡¨ç¤ºæ•°å­—å’Œæƒé‡&#125; æ³¨æ„ç‚¹ 1ã€æ•°å­—è¶Šå°è¶Šä¼˜å…ˆæ‰§è¡Œ 2ã€å¤šç®¡é“ itemä¼ é€’å¿…é¡»åœ¨ process_itemå‡½æ•°ä¸­è¿”å›ž item è‡ªå®šä¹‰æ•°æ®æ¨¡åž‹ ä½œç”¨ï¼šè§„èŒƒæ•°æ®çš„æ ¼å¼ å®šä¹‰æ–‡ä»¶ä½ç½® items.py 123456import scrapyclass dataItem(scrapy.Item): # define the fields for your item here like: name = scrapy.Field() pass ä½¿ç”¨ 123456# å¯¼å…¥items.pyé‡Œé¢å®šä¹‰çš„æ¨¡åž‹ç±»from xxx.items import dataItem# åˆ›å»ºæ¨¡åž‹å¯¹è±¡data = dataItem()# ç»™å¯¹è±¡æ·»åŠ æ•°æ®å’Œå­—å…¸æ“ä½œä¸€æ ·data['name'] = 'xxxx' æ¨¡åž‹å¯¹è±¡è½¬å­—å…¸ 1dict(æ¨¡åž‹å¯¹è±¡) é¡¹ç›®é…ç½® settings.pyå¯ä»¥é…ç½®é¡¹ç›®ä¸­å¸¸ç”¨ä¿¡æ¯ æ³¨æ„ï¼šscrapy.settings.default_settings.pyæ‰æ˜¯æ‰€æœ‰çš„é…ç½®ä¿¡æ¯ï¼Œå¦‚æžœåœ¨settings.pyä¸­æ²¡æœ‰é…ç½®ï¼Œå°±æ˜¯ç”¨é»˜è®¤çš„é…ç½®æ–‡ä»¶ LOG_LEVEL= WARNING è¡¨ç¤ºæ˜¾ç¤ºçš„æ—¥å¿—çº§åˆ« LOG_FILE= è‡ªå®šä¹‰çš„æ—¥å¿—PATH è¡¨ç¤ºæ—¥å¿—çš„å­˜å‚¨ä½ç½® ä½¿ç”¨æ–¹å¼åœ¨ defalut_settings.pyä¸­å¯»æ‰¾é…ç½®ï¼Œç„¶åŽæŠŠé…ç½®é€‰é¡¹åœ¨ settings.pyä¸­é‡æ–°é…ç½®ï¼› scrapy shellä»‹ç» æ–¹ä¾¿å¼€å‘è¿‡ç¨‹ä¸­çš„è°ƒè¯• ä½¿ç”¨1scrapy shell è¯·æ±‚åœ°å€ å¸¸ç”¨æ–¹æ³• request response xpath css text fetchè¯·æ±‚æ–°çš„åœ°å€ CrawlSpider crawlSpideræ˜¯ä¸€ä¸ªå·²ç»å®žçŽ°äº†çˆ¬å–æµç¨‹çš„çˆ¬è™«ï¼› åˆ›å»º1scrapy genspider -t crawl çˆ¬è™«åç§° çˆ¬è™«åŸŸå å‚æ•° -tè¡¨ç¤ºé‡‡ç”¨çš„çˆ¬è™«æ¨¡ç‰ˆ çˆ¬å–æµç¨‹æå–ç¬¦åˆæ¡ä»¶çš„é“¾æŽ¥â€”&gt;è·Ÿè¿›ç¬¦åˆæ¡ä»¶çš„é“¾æŽ¥â€”&gt;æå–ç¬¦åˆæ¡ä»¶çš„é“¾æŽ¥â€”&gt;å¾ªçŽ¯ ä½¿ç”¨è¯´æ˜Ž rulesæ‰€æœ‰è§„åˆ™ã€å…ƒç»„ã€å­˜æ”¾äº†æå–é¡µé¢çš„è§„åˆ™åˆ—è¡¨ Ruleå¯¹è±¡ï¼Œæ¡ä»¶è§„åˆ™å¯¹è±¡ LinkExtactoré“¾æŽ¥æå–å™¨ callbackå½“æå–å®Œé¡µé¢åŽçš„å›žè°ƒå¤„ç†å‡½æ•° followæ˜¯å¦è·Ÿè¿›æå–,é»˜è®¤æ˜¯ True LinkExtractoré“¾æŽ¥æå–å™¨ allow&gt;&gt;å†…å®¹ç¬¦åˆæ¡ä»¶è§„åˆ™è¢«æå– deny&gt;&gt;å†…å®¹ç¬¦åˆæ¡ä»¶è§„åˆ™è¢«æŽ’é™¤ï¼ˆä¼˜å…ˆï¼‰ allow_domains&gt;&gt;ç¬¦åˆæ¡ä»¶çš„åŸŸåè¢«æå– deny_domians&gt;&gt;ç¬¦åˆæ¡ä»¶çš„åŸŸåè¢«æŽ’é™¤ restrict_xpaths&gt;&gt;æ ¹æ®xpathæå– tags&gt;&gt;é»˜è®¤(â€˜aâ€™,â€™areaâ€™)ç¬¦åˆé“¾æŽ¥æå–çš„æ ‡ç­¾å attrs&gt;&gt;é»˜è®¤(href)ï¼Œé“¾æŽ¥æå–æ ‡ç­¾çš„å±žæ€§å restrict_css&gt;&gt;æ ¹æ®cssæ ·å¼æå–å™¨æå– strip&gt;&gt;æå–åŽçš„å†…å®¹åŽ»é™¤ç©ºæ ¼ é“¾æŽ¥åŽ»é‡æŠŠé“¾æŽ¥åœ°å€æ”¾åˆ° seen--&gt;set() æ³¨æ„ï¼šå¦‚æžœurlçš„å‚æ•°ä½ç½®å‘ç”Ÿå˜åŒ–ä¼šå¯¼è‡´æ— æ³•åŽ»é‡ crawlspiderç¼–å†™ä»£ç æµç¨‹1.ç¼–å†™æå–è§„åˆ™â€”&gt;æå–é“¾æŽ¥è§„åˆ™ 2.ç¼–å†™æå–å…·ä½“é¡µé¢è§£æžä»£ç  scrapyä¸­é—´ä»¶ 1.çˆ¬è™«ä¸­é—´ä»¶ å¼•æ“Žå’Œçˆ¬è™«ç»„ä»¶äº¤äº’æ—¶è§¦å‘ä¸­é—´ä»¶ 2.ä¸‹è½½ä¸­é—´ä»¶ å¼•æ“Žå’Œä¸‹è½½å™¨äº¤äº’æ—¶è§¦å‘çš„ä¸­é—´ä»¶ ä¸­é—´ä»¶çš„ä½¿ç”¨æµç¨‹ åœ¨ middlewares.pyåˆ›å»ºä¸­é—´ä»¶ç±» å®žçŽ°æ‰€éœ€è¦çš„æ‹¦æˆªçš„å‡½æ•° åœ¨ settings.pyä¸­é…ç½®å¼€å¯ä¸­é—´ä»¶ å’Œç®¡é“ä¸€æ ·ï¼Œé…ç½®çš„æ•°å­—(score)è¶Šå°è¶Šä¼˜å…ˆæ‰§è¡Œ ä¸‹è½½ä¸­é—´ä»¶ from_crawler ç±»æ–¹æ³•,å½“åˆ›å»ºçˆ¬è™«æ—¶å›žè°ƒï¼Œä»…è°ƒç”¨ä¸€æ¬¡ spider_opened çˆ¬è™«æ‰“å¼€æ—¶å›žè°ƒï¼Œä»…è°ƒç”¨ä¸€æ¬¡ process_request 123456789å¼•æ“Ž -&gt; ä¸‹è½½ä¸­é—´ä»¶ -&gt; ä¸‹è½½å™¨:param request: è¯·æ±‚å¯¹è±¡:param spider: è¯·æ±‚æ¥è‡ªçš„çˆ¬è™«:return: return None ç»§ç»­å¤„ç†è¿™ä¸ªè¯·æ±‚return Response ç›´æŽ¥æŠŠå“åº”æäº¤ç»™å¼•æ“Ž -&gt; çˆ¬è™« return Request ç›´æŽ¥è¿”å›žå¼•æ“Žraise IgnoreRequest è§¦å‘ process_exception å›žè°ƒå‡½æ•° process_response 123456ä¸‹è½½å™¨ -&gt; ä¸‹è½½ä¸­é—´ä»¶ -&gt; å¼•æ“Ž :param request: :param response: :param spider: :return: raise IgnoreRequest æŠŠè¿™è¯·æ±‚å¿½ç•¥ process_exception 12345678910å½“ä¸‹è½½ä¸­é—´ä»¶å¼‚å¸¸å¼‚å¸¸æ—¶å›žè°ƒ :param request: :param exception: :param spider: :return: return None ç»§ç»­å¤„ç†å¼‚å¸¸ï¼Œå‘ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ä¼ é€’å¼‚å¸¸return a Response åœæ­¢å¼‚å¸¸é“¾ï¼ŒæŠŠå“åº”è¿”å›žç»™å¼•æ“Žreturn a Request åœæ­¢å¼‚å¸¸é“¾ï¼ŒæŠŠè¯·æ±‚è¿”å›žç»™å¼•æ“Ž çˆ¬è™«ä¸­é—´ä»¶ from_crawler ç±»æ–¹æ³•,å½“åˆ›å»ºçˆ¬è™«æ—¶å›žè°ƒï¼Œä»…è°ƒç”¨ä¸€æ¬¡ spider_opened çˆ¬è™«æ‰“å¼€æ—¶å›žè°ƒï¼Œä»…è°ƒç”¨ä¸€æ¬¡ process_spider_inputå¼•æ“Ž -&gt; çˆ¬è™«ä¸­é—´ä»¶ -&gt; çˆ¬è™« å‚æ•° response å“åº”å¯¹è±¡ spider çˆ¬è™«å¯¹è±¡ process_spider_output å½“çˆ¬è™«æäº¤æ•°æ®æˆ–è€…è¯·æ±‚ç»™å¼•æ“Žæ—¶è§¦å‘ process_spider_exception å½“ process_spider_input å¼‚å¸¸å¼‚å¸¸æ—¶è§¦å‘ process_start_requests å½“å¼•æ“Žå‘çˆ¬è™«æ‰€è¦ start_requests æ—¶è§¦å‘ scrapydéƒ¨ç½² ä¸“é—¨ç”¨äºŽéƒ¨ç½²scrapyé¡¹ç›®æ¡†æž¶ï¼Œscrapydå¸®åŠ©æˆ‘ä»¬è¿è¡Œscrapyä»£ç  æœåŠ¡ç«¯ å®‰è£… 1pip install scrapyd å¯åŠ¨æœåŠ¡ 1scrapyd è¿œç¨‹è®¿é—® å®¢æˆ·ç«¯è¿œç¨‹è®¿é—®6800ç«¯å£ å¼€å‘ç«¯ å®‰è£… 1pip install scrapyd-client é…ç½®éƒ¨ç½² scrapy.cfgæ–‡ä»¶ 123[deploy:éƒ¨ç½²åç§°]url = http://xxx.xxx.xxx.xxx:6800/ # æœåŠ¡å™¨çš„ipproject = é¡¹ç›®åç§° ä¸Šä¼ é¡¹ç›®åˆ°æœåŠ¡å™¨ 1scrapyd-deploy éƒ¨ç½²åç§° -p é¡¹ç›®åç§° å¯åŠ¨çˆ¬è™« 1curl http://server-iP:6800/schedule.json -d project=é¡¹ç›®åç§° -d spider=çˆ¬è™«åç§° åœæ­¢çˆ¬è™« 1curl http://server-ip:6800/cancel.json -d project=é¡¹ç›®åç§° -d job=jobid scrapy redis ä¸»è¦æ˜¯åˆ©ç”¨scrapy+rediså®žçŽ° æ–­ç‚¹ç»­çˆ¬åŠŸèƒ½ å®žçŽ°åˆ†å¸ƒå¼çˆ¬è™«åŠŸèƒ½ å®‰è£…1pip install scrapy-redis æ–­ç‚¹ç»­çˆ¬å®žçŽ° çŽ°å®žæƒ…å†µä¸­å¾ˆå¤šæ—¶å€™æˆ‘ä»¬çš„ä¸€æ—¦ä¸­æ–­çˆ¬è™«å°±éœ€è¦é‡æ–°å†è¯·æ±‚ä¹‹å‰çš„urlï¼Œscrapy-redisèƒ½å¤Ÿå®žçŽ°æ–­ç‚¹ç»­çˆ¬ 1ã€åœ¨ settings.pyé…ç½® 1234567891011121314# æŠŠåŽŸæ¥çš„è¯·æ±‚è°ƒåº¦å™¨çš„å®žçŽ°ç±»æ”¹é€ æˆredisçš„å®žçŽ°ç±»SCHEDULER = "scrapy_redis.scheduler.Scheduler"# è®¾ç½®åŽ»é‡ç®—æ³•DUPEFILTER_CLASS = "scrapy_redis.dupefilter.RFPDupeFilter"# å¼€å…³å¼€å¯æŒä¹…åŒ–SCHEDULER_PERSIST = True# é…ç½®redisæœåŠ¡å™¨REDIS_URL = "redis://127.0.0.1:6379"#æˆ–è€…ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼REDIS_HOST = "127.0.0.1"REDIS_PORT = 6379 åˆ†å¸ƒå¼çˆ¬è™«å®žçŽ°æµç¨‹1ã€åœ¨ settings.py 1234567891011121314151617181920# æŠŠåŽŸæ¥çš„è¯·æ±‚è°ƒåº¦å™¨çš„å®žçŽ°ç±»æ”¹é€ æˆredisçš„å®žçŽ°ç±»SCHEDULER = "scrapy_redis.scheduler.Scheduler"# è®¾ç½®åŽ»é‡ç®—æ³•DUPEFILTER_CLASS = "scrapy_redis.dupefilter.RFPDupeFilter"# å¼€å…³å¼€å¯æŒä¹…åŒ–SCHEDULER_PERSIST = True# é…ç½®redisæœåŠ¡å™¨## REDIS_URL = "redis://127.0.0.1:6379"#æˆ–è€…ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼# REDIS_HOST = "ç›®æ ‡redisæœåŠ¡å™¨" # ä¸èƒ½ç¼–å†™ 127.0.0.1# REDIS_PORT = 6379# ç®¡é“é…ç½®ITEM_PIPELINES = &#123; 'scrapy_redis.pipelines.RedisPipeline': 400,&#125; 2ã€ä¿®æ”¹çˆ¬è™«ä»£ç ï¼Œä¿®æ”¹é›†æˆç±» CrawlSpider==&gt;RedisCrawlSpider Spider==&gt;RedisSpider 3ã€æ·»åŠ ç›‘æŽ§çš„ redis_keyä½“çŽ°é¦–ä¸ªè¯·æ±‚åœ°å€]]></content>
      <categories>
        <category>Spider</category>
      </categories>
      <tags>
        <tag>scrapy</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Pythoné¢è¯•é¢˜ä¹‹å­—å…¸æ‰å¹³åŒ–]]></title>
    <url>%2F2018%2F05%2F24%2FPython%E9%9D%A2%E8%AF%95%E9%A2%98%E4%B9%8B%E5%AD%97%E5%85%B8%E6%89%81%E5%B9%B3%E5%8C%96%2F</url>
    <content type="text"><![CDATA[å®žé™…å¼€å‘ä¸­å­˜å‚¨çš„æ•°æ®ç»“æž„å¾ˆå¤šéƒ½æ˜¯æ ‘çŠ¶å½¢çŠ¶ï¼ŒçŽ°åœ¨éœ€è¦å†™ä¸€ä¸ªåŠŸèƒ½å®žçŽ°ä»Žæ ‘å½¢ç»“æž„åˆ°æ‰å¹³åŒ–ç»“æž„çš„è½¬æ¢ 123456789101112131415161718192021'''æœ‰è‹¥å¹²ç§ä¸åŒçš„æ ‘å½¢ç»“æž„ï¼Œéœ€è¦æ˜ å°„ä¸ºæ‰å¹³åŒ–çš„dictå­—å…¸ï¼Œéœ€è¦å†™ä¸€ä¸ªå‡½æ•°ï¼Œå®Œæˆä»Žæ ‘å½¢ç»“æž„åˆ°æ‰å¹³åŒ–ç»“æž„çš„è½¬æ¢å¦‚è¾“å…¥in_data = &#123; "jack": &#123; "Math": &#123;"tearcher": "zhang", "socre": "75"&#125;, "English": &#123;"tearcher": "Xu", "socre": "90"&#125;, "height": "172" &#125;&#125;# è¾“å‡º&#123; 'jack_English_socre': '90', 'jack_English_tearcher': 'Xu', 'jack_Math_socre': '75', 'jack_Math_tearcher': 'zhang', 'jack_height': '172' &#125;''' é¢˜ç›®è€ƒæŸ¥çš„å…¶å®žå°±æ˜¯é€’å½’çš„åº”ç”¨ï¼Œå­—å…¸åµŒå¥—å­—å…¸ï¼Œè¿™é‡Œè¿˜æœ‰ç”¨åˆ°Pythonçš„ isinstance() æ–¹æ³• 12345678Python ä¸­çš„isinstanceå‡½æ•°ï¼Œisinstanceæ˜¯Pythonä¸­çš„ä¸€ä¸ªå†…å»ºå‡½æ•°ã€‚æ˜¯ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡çš„å˜é‡ç±»åž‹å’Œtypeç±»ä¼¼ã€‚è¯­æ³•:isinstance(object, classinfo)&gt;&gt;&gt; isinstance(1, int)True&gt;&gt;&gt; isinstance(&#123;'age': 18&#125;, dict)True&gt;&gt;&gt; isinstance('1', int)False ç­”æ¡ˆ 1234567891011121314151617181920212223in_data = &#123; "jack": &#123; "Math": &#123;"tearcher": "zhang", "socre": "75"&#125;, "English": &#123;"tearcher": "Xu", "socre": "90"&#125;, "height": "172" &#125;&#125;target = &#123;&#125; # å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡ç”¨æ¥å­˜å‚¨è¿”å›žç»“æžœdef dict2flat(data, targetKey=''): for k, v in data.items(): if isinstance(v, dict): dict2flat(v, targetKey + k + '_') else: target[targetKey + k] = vif __name__ == '__main__': dict2flat(in_data) from pprint import pprint pprint(target)]]></content>
      <categories>
        <category>Interview-Questions</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Pythonç¼–ç¨‹ä¹‹forå¾ªçŽ¯çš„è¿è¡Œæµç¨‹]]></title>
    <url>%2F2018%2F05%2F13%2FPython%E7%BC%96%E7%A8%8B%E4%B9%8Bfor%E5%BE%AA%E7%8E%AF%E7%9A%84%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[forå¾ªçŽ¯æ˜¯ Pythonç¼–ç¨‹å½“ä¸­ä½¿ç”¨æœ€å¤šçš„è¯­å¥ï¼Œforå¾ªçŽ¯ç”¨äºŽ è¿­ä»£å®¹å™¨å¯¹è±¡ä¸­çš„å…ƒç´ ï¼ŒPythonå½“ä¸­çš„å®¹å™¨å¯¹è±¡å¸¸è§çš„æœ‰åˆ—è¡¨(list)ã€å­—ç¬¦ä¸²(str)ã€å­—å…¸(dict)ã€å…ƒç»„(tuple)ã€é›†åˆ(set)ã€ç­‰ æ¡ˆä¾‹ ä½œç”¨äºŽåˆ—è¡¨ 123456&gt;&gt;&gt; for elem in [1,2,3]:... print(elem)...123 ä½œç”¨äºŽå…ƒç»„ 123456&gt;&gt;&gt; for i in ("zhang", "san", 30):... print(i)...zhangsan30 ä½œç”¨äºŽå­—ç¬¦ä¸² 123456&gt;&gt;&gt; for c in "abc":... print(c)...abc ä½œç”¨äºŽå­—å…¸ 12345&gt;&gt;&gt; for k in &#123;"age":10, "name":"wang"&#125;:... print(k)...agename ä½œç”¨äºŽæ–‡ä»¶ 12345&gt;&gt;&gt; for line in open("requirement.txt"):... print(line, end="")...Fabric==1.12.0Markdown==2.6.7 å¯èƒ½æœ‰äººä¼šé—®ï¼Œé—®ä»€ä¹ˆè¿™ä¹ˆå¤šä¸åŒç±»åž‹å¯¹è±¡éƒ½æ”¯æŒforè¯­å¥ï¼Œè¿˜æœ‰é‚£äº›ç±»åž‹çš„å¯¹è±¡å¯ä»¥ä½œç”¨åœ¨forè¯­å¥ä¸­å‘¢ï¼Ÿå›žç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¦äº†è§£forå¾ªçŽ¯èƒŒåŽçš„æ‰§è¡ŒåŽŸç†ã€‚ forå¾ªçŽ¯æ˜¯å¯¹å®¹å™¨è¿›è¡Œè¿­ä»£çš„è¿‡ç¨‹ï¼Œä»€ä¹ˆæ˜¯è¿­ä»£ï¼Ÿè¿­ä»£å°±æ˜¯ä»ŽæŸä¸ªå®¹å™¨å¯¹è±¡ä¸­é€ä¸ªè¯»å–å…ƒç´ ï¼Œç›´åˆ°è¯»å–ä¸åˆ°å…ƒç´ ä¸ºæ­¢ã€‚é‚£ä¹ˆé‚£äº›å¯¹è±¡æ”¯æŒè¿­ä»£æ“ä½œï¼Ÿä»»ä½•å¯¹è±¡éƒ½å¯ä»¥å—ï¼Ÿå…ˆéšä¾¿è‡ªå®šä¹‰ä¸€ä¸ªç±»è¯•è¯•ï¼Œçœ‹è¡Œä¸è¡Œï¼š 12345678910&gt;&gt;&gt; class MyRange:... def __init__(self, num):... self.num = num...&gt;&gt;&gt; for i in MyRange(10):... print(i)...Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;TypeError: 'MyRange' object is not iterable é”™è¯¯æ—¥å¿—éžå¸¸æ¸…æ¥šåœ°å‘Šè¯‰æˆ‘ä»¬ï¼ŒMyRangeä¸æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œæ‰€ä»¥å®ƒä¸èƒ½ç”¨äºŽè¿­ä»£ï¼Œé‚£ä¹ˆåˆ°åº•ä»€ä¹ˆæ ·çš„å¯¹è±¡æ‰èƒ½ç§°å¾—ä¸Šæ˜¯å¯è¿­ä»£å¯¹è±¡(iterable)å‘¢ï¼Ÿ å¯è¿­ä»£å¯¹è±¡éœ€è¦å®žçŽ° __iter__æ–¹æ³•ï¼Œå¹¶è¿”å›žä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ï¼Œä»€ä¹ˆæ˜¯è¿­ä»£å™¨å¯¹è±¡ï¼Ÿè¿­ä»£å™¨å¯¹è±¡åªéœ€è¦å®žçŽ° __next__æ–¹æ³•ã€‚çŽ°åœ¨æˆ‘ä»¬å°±æ¥éªŒè¯ä¸€ä¸‹åˆ—è¡¨ä¸ºä»€ä¹ˆæ”¯æŒè¿­ä»£ï¼š 123456789101112131415&gt;&gt;&gt; x = [1,2,3]&gt;&gt;&gt; its = x.__iter__() # xæœ‰æ­¤æ–¹æ³•ï¼Œè¯´æ˜Žåˆ—è¡¨æ˜¯å¯è¿­ä»£å¯¹è±¡&gt;&gt;&gt; its&lt;list_iterator object at 0x100f32198&gt;&gt;&gt;&gt; its.__next__() # itsæœ‰æ­¤æ–¹æ³•ï¼Œè¯´æ˜Žitsæ˜¯è¿­ä»£å™¨1&gt;&gt;&gt; its.__next__()2&gt;&gt;&gt; its.__next__()3&gt;&gt;&gt; its.__next__()Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;StopIteration ä»Žè¯•éªŒç»“æžœæ¥çœ‹ï¼Œåˆ—è¡¨æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œå› ä¸ºå®ƒå®žçŽ°äº† __iter__æ–¹æ³•ï¼Œå¹¶ä¸”è¿”å›žä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡&gt;&gt; list_iterator,å› ä¸ºå®ƒå®žçŽ°äº† __next__æ–¹æ³•ã€‚æˆ‘ä»¬çœ‹åˆ°å®ƒä¸æ–­åœ°è°ƒç”¨ __next__æ–¹æ³•ï¼Œå…¶å®žå°±æ˜¯ä¸æ–­åœ°è¿­ä»£èŽ·å–å®¹å™¨ä¸­çš„å…ƒç´ ,ç›´åˆ°å®¹å™¨ä¸­æ²¡æœ‰å…ƒç´ ï¼ŒæŠ›å‡º StopIterationå¼‚å¸¸ä¸ºæ­¢ã€‚ é‚£ä¹ˆ forè¯­å¥åˆæ˜¯å¦‚ä½•å¾ªçŽ¯çš„å‘¢ï¼Ÿå®ƒçš„æ­¥éª¤æ˜¯ï¼š 1ã€å…ˆåˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºå¯è¿­ä»£å¯¹è±¡ï¼Œä¸æ˜¯çš„è¯ç›´æŽ¥æŠ¥é”™ï¼ŒæŠ›å‡º TypeErrorå¼‚å¸¸ï¼Œæ˜¯çš„è¯ï¼Œè°ƒç”¨ __iter__æ–¹æ³•ï¼Œè¿”å›žä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ï¼› 2ã€ä¸æ–­åœ°è°ƒç”¨è¿­ä»£å™¨å¯¹è±¡çš„ __next__æ–¹æ³•,æ¯æ¬¡æŒ‰åºè¿”å›žè¿­ä»£å™¨ä¸­çš„ä¸€ä¸ªå€¼ï¼› 3ã€è¿­ä»£åˆ°æœ€åŽï¼Œæ²¡æœ‰æ›´å¤šå…ƒç´ äº†ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ StopIterationï¼Œè¿™ä¸ªå¼‚å¸¸ pythonè‡ªå·±ä¼šå¤„ç†ã€‚ å¯¹äºŽå…ƒç»„ï¼Œå­—å…¸ï¼Œå­—ç¬¦ä¸²ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ï¼Œå¼„æ˜Žç™½äº† forçš„æ‰§è¡ŒåŽŸç†ä¹‹åŽï¼Œæˆ‘ä»¬å°±å¯ä»¥å®žçŽ°è‡ªå·±çš„è¿­ä»£å™¨ç”¨åœ¨forå¾ªçŽ¯ä¸­ã€‚å‰é¢çš„ MyRangeæŠ¥é”™æ˜¯å› ä¸ºå®ƒæ²¡æœ‰å®žçŽ°è¿­ä»£å™¨åè®®é‡Œé¢çš„è¿™ä¸¤ä¸ªæ–¹æ³•ï¼ŒçŽ°åœ¨ç»§ç»­æ”¹è¿› 12345678910111213141516class MyRange: def __init__(self, num): self.i = 0 self.num = num def __iter__(self): return self def __next__(self): if self.i &lt; self.num: i = self.i self.i += 1 return i else: # è¾¾åˆ°æŸä¸ªæ¡ä»¶æ—¶å¿…é¡»æŠ›å‡ºæ­¤å¼‚å¸¸ï¼Œå¦åˆ™ä¼šæ— æ­¢å¢ƒåœ°è¿­ä»£ä¸‹åŽ» raise StopIteration() å› ä¸ºå®ƒå®žçŽ°äº† __next__æ–¹æ³•ï¼Œæ‰€ä»¥ MyRangeæœ¬èº«å·²ç»æ˜¯ä¸€ä¸ªè¿­ä»£å™¨äº†ï¼Œæ‰€ä»¥ __iter__è¿”å›žçš„å°±æ˜¯ å¯¹è±¡æœ¬èº« self.çŽ°åœ¨ç”¨åœ¨forå¾ªçŽ¯ä¸­è¯•è¯•ï¼š 123456for i in MyRange(3): print(i)# è¾“å‡º 0 1 2 æœ‰æ²¡æœ‰å‘çŽ°ï¼Œè‡ªå®šä¹‰çš„ MyRange åŠŸèƒ½å’Œå†…å»ºå‡½æ•° rangeå¾ˆç›¸ä¼¼ã€‚for å¾ªçŽ¯æœ¬è´¨æ˜¯ä¸æ–­åœ°è°ƒç”¨è¿­ä»£å™¨çš„__next__æ–¹æ³•ï¼Œç›´åˆ°æœ‰ StopIteration å¼‚å¸¸ä¸ºæ­¢ï¼Œæ‰€ä»¥ä»»ä½•å¯è¿­ä»£å¯¹è±¡éƒ½å¯ä»¥ä½œç”¨åœ¨forå¾ªçŽ¯ä¸­ã€‚]]></content>
      <categories>
        <category>Python-Advanced</category>
      </categories>
      <tags>
        <tag>for</tag>
        <tag>iterable</tag>
        <tag>iterator</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[çˆ¬è™«ä¹‹selenium]]></title>
    <url>%2F2018%2F04%2F27%2F%E7%88%AC%E8%99%AB%E4%B9%8Bselenium%2F</url>
    <content type="text"><![CDATA[Seleniumä»‹ç» Seleniumæ˜¯ä¸€ä¸ªWebçš„è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ï¼Œæœ€åˆæ˜¯ä¸ºç½‘ç«™è‡ªåŠ¨åŒ–æµ‹è¯•è€Œå¼€å‘çš„ï¼ŒSelenium å¯ä»¥ç›´æŽ¥è¿è¡Œåœ¨æµè§ˆå™¨ä¸Šï¼Œå®ƒæ”¯æŒæ‰€æœ‰ä¸»æµçš„æµè§ˆå™¨ï¼ˆåŒ…æ‹¬PhantomJSè¿™äº›æ— ç•Œé¢çš„æµè§ˆå™¨ï¼‰ï¼Œå¯ä»¥æŽ¥æ”¶æŒ‡ä»¤ï¼Œè®©æµè§ˆå™¨è‡ªåŠ¨åŠ è½½é¡µé¢ï¼ŒèŽ·å–éœ€è¦çš„æ•°æ®ï¼Œç”šè‡³é¡µé¢æˆªå±ã€‚ç¨‹åºè„šæœ¬å¯ä»¥é€šè¿‡ Selenium API æŽ§åˆ¶æµè§ˆå™¨ã€‚ è¿è¡Œæµç¨‹ çŽ¯å¢ƒæ­å»º å®‰è£…selenium 1pip install selenium ä¸‹è½½å¯¹åº”çš„é©±åŠ¨ æ·˜å®é©±åŠ¨åœ°å€ï¼šhttp://npm.taobao.org/mirrors/chromedriver/ å¤‡æ³¨ï¼šä¸€å®šè¦ä¸‹è½½æœ¬åœ°æµè§ˆå™¨ç‰ˆæœ¬å¯¹åº”çš„é©±åŠ¨ åŸºæœ¬æ“ä½œ 12345678910111213141516171819# å¯¼å…¥æ¨¡å—from selenium import webdriverimport time# åŠ è½½æµè§ˆå™¨é©±åŠ¨ï¼Œåˆ›å»ºæµè§ˆå™¨å¯¹è±¡browse = webdriver.Chrome('./chromedriver')# è®¿é—®ç™¾åº¦browse.get('https://www.baidu.com')# å®šä½ç™¾åº¦æœç´¢è¾“å…¥æ¡†ï¼Œè¾“å…¥å…³é”®å­—â€œç”µå½±â€browse.find_element_by_name('wd').send_keys('ç”µå½±')# ç‚¹å‡»â€˜ç™¾åº¦ä¸€ä¸‹â€™browse.find_element_by_id('su').click()time.sleep(2) # é€€å‡ºçª—å£browse.quit() seleniumé©±åŠ¨å¯»æ‰¾æ–¹å¼ 1ã€é€šè¿‡æŒ‡å®šæµè§ˆå™¨é©±åŠ¨è·¯å¾„ 1browser = webdriver.Chrome('æµè§ˆå™¨é©±åŠ¨ä½ç½®') 2ã€é€šè¿‡ $PATHçŽ¯å¢ƒå˜é‡æŒ‡å®šæµè§ˆå™¨é©±åŠ¨ 12# é€šè¿‡ $PATH å¯»æ‰¾é©±åŠ¨ï¼Œå¦‚æžœå¯»æ‰¾ä¸åˆ°å°±æŠ¥é”™ browser = webdriver.Chrome() æ·»åŠ ç½‘å€ï¼šhttps://www.jianshu.com/p/e50a49f86070 å…¶å®žå°±æ˜¯æ‰¾åˆ°Pythonè§£é‡Šå™¨çš„ binç›®å½•ï¼ŒæŠŠé©±åŠ¨æ”¾è¿›åŽ»å³å¯ seleniumæŽ§åˆ¶æµè§ˆå™¨æ“ä½œè®¿é—®URL1browser.get('https://www.baidu.com/') å®šä½å…ƒç´  find_element_by_xxxè¿”å›žç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶ WebElement find_elements_by_xxxè¿”å›žç¬¦åˆæ¡ä»¶çš„ WebElementåˆ—è¡¨ xxxè¯´æ˜Ž find_elements_by_class_nameé€šè¿‡æ ‡ç­¾çš„classå±žæ€§å®šä½å…ƒç´  find_element_by_idé€šè¿‡æ ‡ç­¾çš„IDå±žæ€§å®šä½å…ƒç´  find_element_by_nameé€šè¿‡æ ‡ç­¾çš„nameå±žæ€§å®šä½ find_element_by_css_selectorcssæ ·å¼é€‰æ‹© find_element_by_link_texté€šè¿‡é“¾æŽ¥å†…å®¹æŸ¥æ‰¾ find_element_by_partial_link_text é€šè¿‡é“¾æŽ¥å†…å®¹åŒ…å«çš„å†…å®¹æŸ¥æ‰¾ï¼Œæ¨¡ç³ŠæŸ¥è¯¢ find_element_by_xpath é€šè¿‡xpathæŸ¥æ‰¾æ•°æ® xpathåªèƒ½èŽ·å–webelementå¯¹è±¡ï¼Œä¸èƒ½ç›´æŽ¥èŽ·å–å±žæ€§å’Œæ–‡æœ¬å†…å®¹ èŽ·å–å…ƒç´ å±žæ€§å’Œæ–‡æœ¬å†…å®¹1234# èŽ·å–å±žæ€§WebElement.get_attribute('å±žæ€§å')# èŽ·å–æ–‡æœ¬å†…å®¹WebElement.text è¾“å…¥æ¡†Inputè¾“å…¥å†…å®¹1Input_element.send_keys('xxx') ç‚¹å‡»1element.click() ä½¿ç”¨æ— ç•Œé¢æµè§ˆå™¨ ä½¿ç”¨æ— ç•Œé¢çš„é©±åŠ¨ ä¸‹è½½åœ°å€ï¼šhttp://phantomjs.org/download.html ä½¿ç”¨æ–¹å¼ browser = webdriver.PhantomJS(&#39;é©±åŠ¨è·¯å¾„â€˜) è®¾ç½®chromeå¯åŠ¨å‚æ•° 123456789101112131415from selenium import webdriver# åˆ›å»ºæµè§ˆå™¨å¯åŠ¨å‚æ•°options = webdriver.ChromeOptions()options.add_argument('--headless') # æ— ç•Œé¢options.add_argument('--disable-gpu') # ç¦ç”¨gpu# åˆ›å»ºæµè§ˆå™¨å¯¹è±¡browser = webdriver.Chrome(chrome_options=options)# è®¿é—®ç½‘å€browser.get('https://www.baidu.com')# æˆªå›¾è¯æ˜Žbrowser.save_screenshot('ç™¾åº¦æˆªå›¾.png')# é€€å‡ºbrowser.quit() è®¾ç½®User-Agentå’ŒProxyä»£ç†123456options = webdriver.ChromeOptions()# åˆ‡æ¢User-Agentoptions.add_argument('--user-agent=Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1')# è®¾ç½®ä»£ç†options.add_argument('--proxy-server=ä»£ç†æœåŠ¡å™¨åœ°å€') # è®¾ç½®ä»£ç†browser = webdriver.Chrome('chrome_options=options) èŽ·å–ç½‘é¡µæºç 1browser.page_source æ³¨æ„ï¼šèŽ·å–çš„ç½‘é¡µæºç æ˜¯ç»è¿‡JSé¡µé¢æ‰§è¡ŒåŽçš„ç»“æžœæºç  cookies æ“ä½œï¼ˆéžå¸¸é‡è¦ï¼‰ èŽ·å–æ‰€æœ‰Cookies 1browser.get_cookies() é€šè¿‡åå­—èŽ·å–Cookie 1browser.get_cookie() æ·»åŠ Cookie 1browser.add_cookie() é€šè¿‡åå­—åˆ é™¤Cookie 1browser.delete_cookie() åˆ é™¤æ‰€æœ‰Cookie 1browser.delete_all_cookies() æ‰§è¡ŒJSä»£ç 1browser.execute_script("js-code") ç­‰å¾…åŠ è½½ æ–¹å¼ä¸€ï¼šå¼ºåˆ¶ç­‰å¾…ï¼Œæµªè´¹æ—¶é—´ 1time.sleep(ç§’æ•°) æ–¹å¼äºŒï¼šéšæ€§ç­‰å¾… 1browser.implicitly_wait(ç­‰å¾…æ—¶é—´) æ–¹å¼ä¸‰ï¼šæ˜¾æ€§ç­‰å¾…ï¼Œæ¯ä¸ªå…ƒç´ éƒ½å¯ä»¥è‡ªå·±å®šä¹‰æ£€æŸ¥æ¡ä»¶ æ‰‹åŠ¨ç¼–å†™æ–¹å¼ 123456789101112131415# æ˜¾æ€§ç­‰å¾…-æ‰‹åŠ¨ç¼–å†™t = time.time()# å®šä¹‰è¶…æ—¶æ—¶é—´timeout = 60while True: try: # è¶…æ—¶æ—¶é—´é—´éš” time.sleep(0.1) url_element = browser.find_element_by_class_name("favurl") break except: # è¶…æ—¶å¤„ç† if time.time() - t &gt; timeout: break pass ç³»ç»Ÿæä¾›æ˜¾æ€§ç­‰å¾…API 1234567891011121314151617# å¯¼å…¥æ˜¾æ€§ç­‰å¾…çš„APIéœ€è¦çš„æ¨¡å—# 1&gt; ç­‰å¾…å¯¹è±¡æ¨¡å—from selenium.webdriver.support.wait import WebDriverWait# 2&gt; å¯¼å…¥ç­‰å¾…æ¡ä»¶æ¨¡å—from selenium.webdriver.support import expected_conditions as EC# 3&gt; å¯¼å…¥æŸ¥è¯¢å…ƒç´ æ¨¡å—from selenium.webdriver.common.by import By# ä½¿ç”¨selenium api å®žçŽ°æ˜¾æ€§ç­‰å¾…# 1&gt; åˆ›å»ºç­‰å¾…å¯¹è±¡# å‚æ•°ä¸€ æµè§ˆå™¨å¯¹è±¡# å‚æ•°äºŒ è¶…æ—¶æ—¶é—´# å‚æ•°ä¸‰ æ£€æŸ¥å…ƒç´ æ—¶é—´é—´éš”wait = WebDriverWait(browser,60,0.1)# presence_of_element_located æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå…ƒç¥–ï¼Œå…ƒç¥–å†…éƒ¨æè¿°ç­‰å¾…å…ƒç´ æŸ¥è¯¢æ–¹æ¡ˆ# visibility_of_element_located æ£€æŸ¥å…ƒç´ æ˜¯å¦å¯è§url_element= wait.until(EC.presence_of_element_located((By.CLASS_NAME,"favurl"))) çª—å£åˆ‡æ¢ èŽ·å–æ‰€æœ‰çš„çª—å£ï¼ˆåˆ—è¡¨ï¼‰ 1browser.window_handles åˆ‡æ¢çª—å£ 1browser.switch_to_window(all_windowsp['index']) å¤‡æ³¨ï¼šbrowser.titleå¯ä»¥é€šè¿‡æ‰“å°å½“å‰çª—å£titleè°ƒè¯• iframeåˆ‡æ¢ 1ã€èŽ·å–iframeæ ‡ç­¾å¯¹è±¡ 1iframe_element = browser.find_element_by_xxx('') 2ã€åˆ‡æ¢åˆ°iframeçª—å£ 1browser.switch_to.frame(iframe_element) 3ã€åˆ‡æ¢åˆ°ä¸»çª—å£ 1browser.switch_to.default_content()]]></content>
      <categories>
        <category>Spider</category>
      </categories>
      <tags>
        <tag>selenium</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[csvå’Œjsonä¹‹é—´çš„è½¬æ¢]]></title>
    <url>%2F2018%2F04%2F26%2Fcsv%E5%92%8Cjson%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2%2F</url>
    <content type="text"><![CDATA[CSVï¼ˆé€—å·åˆ†éš”å€¼æ–‡ä»¶æ ¼å¼ï¼‰ï¼Œæ˜¯ä¸€ç§é€šç”¨çš„ï¼Œç›¸å¯¹ç®€å•çš„æ–‡ä»¶æ ¼å¼ï¼Œè¢«ç”¨æˆ·ã€å•†ä¸šã€ç§‘å­¦å¹¿æ³›ä½¿ç”¨ï¼Œæœ€å¹¿æ³›çš„åº”ç”¨æ˜¯åœ¨ç¨‹åºä¹‹é—´è½¬ç§»è¡¨æ ¼æ•°æ®ã€‚ æ–‡ç« ç›®æ ‡ï¼šäº†è§£CSVçš„åŸºæœ¬æ“ä½œä»¥åŠjsonæ ¼å¼æ•°æ®å¦‚ä½•å†™å…¥CSVæ–‡ä»¶å¹¶è½¬æ¢Excel ä½¿ç”¨åœºæ™¯çˆ¬è™«æ‹¿åˆ°çš„å¤§éƒ¨åˆ†éƒ½æ˜¯jsonæ ¼å¼æ•°æ®ï¼Œä½†æ˜¯å®¢æˆ·æˆ–è€…æ•°æ®åˆ†æžå‘˜ä¸€èˆ¬æ›´éœ€è¦Excelè¿™ç§æ ¼å¼çš„æ•°æ® åŸºæœ¬æ“ä½œ 1ã€å¯¼å…¥æ¨¡å— 12# python3.Xå†…ç½®æ¨¡å—ä¸éœ€è¦ä¸‹è½½import csv 2ã€åˆ›å»ºcsvå†™å…¥å¯¹è±¡ 12345# åˆ›å»ºæ–‡ä»¶å¯¹è±¡f = open('03-test.csv', 'w', encoding='utf-8')# åˆ›å»ºcsvå†™å…¥å¯¹è±¡csv_writer = csv.writer(f) 3ã€å†™å…¥æ•°æ® 123csv_writer.writerow(['å§“å', 'å¹´é¾„', 'æ€§åˆ«'])csv_writer.writerow(['å¼ºä»”', '18', 'ç”·'])csv_writer.writerow(['å½¤å½¤', '17', 'å¥³']) 4ã€å…³é—­æ–‡ä»¶ 1f.close() json2csv 1ã€å…ˆè½¬æ¢jsonæ ¼å¼ä¸ºpythonæ•°æ®ç±»åž‹ 12345import csvimport json# data.json ä¸ºäº‹å…ˆå‡†å¤‡å¥½çš„jsonæ•°æ®with open('data.json', 'r') as f: data_list = json.load(f) # è½¬æ¢æˆpytonæ•°æ®ç±»åž‹ 2ã€åˆ›å»ºcsvå¯¹è±¡ 12f = open('data.csv', 'w', encoding='utf-8')csv_writer = csv.writer(f) 3ã€å†™å…¥æ•°æ® 1234567# 3.1 å†™å…¥æ ‡é¢˜ä¹Ÿå°±æ˜¯å­—å…¸çš„å…³é”®å­—keycsv_writer.writerow(data_list[0].keys())# 3.2 éåŽ†å†™å…¥å­—å…¸å…ƒç´ valuesfor data in data_list: csv_writer.writerow(data.values())# 3.3 å…³é—­æ–‡ä»¶å¥æŸ„f.close() csvè½¬Execlè§é“¾æŽ¥ï¼šhttps://jingyan.baidu.com/article/3c343ff7faa59b0d3779633e.html]]></content>
      <categories>
        <category>Python-Standard-Library</category>
      </categories>
      <tags>
        <tag>csv</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Pythoné¢è¯•é¢˜ï¼šæ±‚åˆ—è¡¨å½“ä¸­æœ€å¤§çš„ä¸‰ä¸ªå…ƒç´ ]]></title>
    <url>%2F2018%2F04%2F15%2FPython%E9%9D%A2%E8%AF%95%E9%A2%98-%E4%BA%8C-%EF%BC%9A%E6%B1%82%E5%88%97%E8%A1%A8%E5%BD%93%E4%B8%AD%E6%9C%80%E5%A4%A7%E7%9A%84%E4%B8%89%E4%B8%AA%E5%85%83%E7%B4%A0%2F</url>
    <content type="text"><![CDATA[åœ¨ç‰›å®¢ç½‘https://www.nowcoder.com/ä¸Šåˆ·é¢˜é‡åˆ°å¦‚ä½•ä»Žlistä¸­å–å¾—æœ€å¤§çš„ä¸‰ä¸ªå€¼ï¼šè‡ªå·±å†™çš„æ–¹æ³•å¤æ‚åº¦å¤ªé«˜ï¼Œæ”¾ä¸Šå¤§ç‰›çš„æ–¹æ³•ï¼Œå¤æ‚åº¦å¾ˆä½Žã€‚çœ‹äº†å¥½å‡ éæ‰ä½“ä¼šåˆ°å¤§æ¦‚çš„ç²¾é«“ã€‚ 12345678910111213141516171819202122232425262728'''ä»Žlistä¸­å–å‡ºæœ€å¤§çš„ä¸‰ä¸ªå€¼__author__:æ— å'''def FindList3MaxNum(foo): max1, max2, max3 = None, None, None for num in foo: if max1 is None or max1 &lt; num: max1, num = num, max1 if num is None: continue if max2 is None or num &gt; max2: max2, num = num, max2 if num is None: continue if max3 is None or num &gt; max3: max3 = num return max1, max2, max3if __name__ == '__main__': foo = [78, 23, 10, 56, 4, 103, 89, 14] max1, max2, max3 = FindList3MaxNum(foo) print(max1, max2, max3)]]></content>
      <categories>
        <category>Interview-Questions</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Pythonç¼–ç¨‹ä¹‹listå¸¸è§ç”¨æ³•]]></title>
    <url>%2F2018%2F04%2F11%2Fpython%E7%BC%96%E7%A8%8B%E4%B9%8Blist%E5%B8%B8%E8%A7%81%E7%94%A8%E6%B3%95%2F</url>
    <content type="text"><![CDATA[åˆ—è¡¨æ˜¯Pythonæœ€å¸¸ç”¨çš„æ•°æ®ç±»åž‹ä¹‹ä¸€ï¼Œæœ¬æ–‡æ•´ç†ä¸€ä¸‹åˆ—è¡¨æœ€å¸¸ç”¨çš„10ç§æ“ä½œï¼Œå¦‚æžœå¼€å‘è¿‡ç¨‹å½“ä¸­é‡åˆ°äº†ï¼Œå¯ä»¥å°è¯•ä»Žè¿™äº›æ‰¾ç­”æ¡ˆ 1ã€è¿­ä»£åˆ—è¡¨æ—¶å¦‚ä½•è®¿é—®åˆ—è¡¨ä¸‹æ ‡ç´¢å¼•æ™®é€šç‰ˆï¼š12345678items = [8, 23, 45]for index in range(len(items)): print(index, "--&gt;", items[index])&gt;&gt;&gt;0 --&gt; 81 --&gt; 232 --&gt; 45 Level Upç‰ˆï¼š1234567for index, item in enumerate(items): print(index, "--&gt;", item)&gt;&gt;&gt;0 --&gt; 81 --&gt; 232 --&gt; 45 enumerateè¿˜å¯ä»¥æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä»Žç¬¬å‡ ä¸ªç´¢å¼•å¼€å§‹ï¼Œé»˜è®¤æ˜¯0ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šä»Ž1å¼€å§‹ï¼š 1234567for index, item in enumerate(items, start=1): print(index, "--&gt;", item)&gt;&gt;&gt;1 --&gt; 82 --&gt; 233 --&gt; 45 2ã€appendä¸Žextendæ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«appendè¡¨ç¤ºæŠŠæŸä¸ªæ•°æ®å½“åšæ–°å…ƒç´ è¿½åŠ åˆ°åˆ—è¡¨çš„æœ€åŽé¢ï¼Œå®ƒçš„å‚æ•°å¯ä»¥æ˜¯ä»»æ„å¯¹è±¡ 1234567x = [1, 2, 3]y = [4, 5]x.append(y)print(x)&gt;&gt;&gt;[1, 2, 3, [4, 5]] extend çš„å‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œè¡¨ç¤ºæŠŠè¯¥å¯¹è±¡é‡Œé¢çš„æ‰€æœ‰å…ƒç´ é€ä¸ªåœ°è¿½åŠ åˆ°åˆ—è¡¨çš„åŽé¢ 1234567891011x = [1, 2, 3]y = [4, 5]x.extend(y)print(x)&gt;&gt;&gt;[1, 2, 3, 4, 5]# ç­‰ä»·äºŽï¼šfor i in y: x.append(i) 3ã€æ£€æŸ¥åˆ—è¡¨æ˜¯å¦ä¸ºç©ºæ™®é€šç‰ˆï¼š1234567if len(items) == 0: print("ç©ºåˆ—è¡¨")æˆ–è€…if items == []: print("ç©ºåˆ—è¡¨") Level Upç‰ˆï¼š12if not items: print("ç©ºåˆ—è¡¨") 4ã€å¦‚ä½•ç†è§£åˆ‡ç‰‡ åˆ‡ç‰‡ç”¨äºŽèŽ·å–åˆ—è¡¨ä¸­æŒ‡å®šèŒƒçš„å­é›†ï¼Œè¯­æ³•éžå¸¸ç®€å• 1items[start:end:step] ä»Ž start åˆ° end-1 ä½ç½®ä¹‹é—´çš„å…ƒç´ ã€‚step è¡¨ç¤ºæ­¥é•¿ï¼Œé»˜è®¤ä¸º1ï¼Œè¡¨ç¤ºè¿žç»­èŽ·å–ï¼Œå¦‚æžœ step ä¸º 2 å°±è¡¨ç¤ºæ¯éš”ä¸€ä¸ªå…ƒç´ èŽ·å–ã€‚ 12345678910111213141516a = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]&gt;&gt;&gt; a[3:8] # ç¬¬3åˆ°ç¬¬8ä½ç½®ä¹‹é—´çš„å…ƒç´ [4, 5, 6, 7, 8]&gt;&gt;&gt; a[3:8:2] # ç¬¬3åˆ°ç¬¬8ä½ç½®ä¹‹é—´çš„å…ƒç´ ï¼Œæ¯éš”ä¸€ä¸ªå…ƒç´ èŽ·å–[4, 6, 8]&gt;&gt;&gt; a[:5] # çœç•¥startè¡¨ç¤ºä»Žç¬¬0ä¸ªå…ƒç´ å¼€å§‹[1, 2, 3, 4, 5]&gt;&gt;&gt; a[3:] # çœç•¥endè¡¨ç¤ºåˆ°æœ€åŽä¸€ä¸ªå…ƒç´ [4, 5, 6, 7, 8, 9, 10]&gt;&gt;&gt; a[::] # éƒ½çœç•¥ç›¸å½“äºŽæ‹·è´ä¸€ä¸ªåˆ—è¡¨ï¼Œè¿™ç§æ‹·è´å±žäºŽæµ…æ‹·è´[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] 5ã€å¦‚ä½•æ‹·è´ä¸€ä¸ªåˆ—è¡¨å¯¹è±¡ç¬¬ä¸€ç§æ–¹æ³•ï¼š1new_list = old_list[:] ç¬¬äºŒç§æ–¹æ³•ï¼š1new_list = list(old_list) ç¬¬ä¸‰ç§æ–¹æ³•ï¼š12345import copy# æµ…æ‹·è´new_list = copy.copy(old_list)# æ·±æ‹·è´new_list = copy.deepcopy(old_list) æ‰©å±•ï¼Œäº†è§£å³å¯ 6ã€å¦‚ä½•èŽ·å–åˆ—è¡¨ä¸­çš„æœ€åŽä¸€ä¸ªå…ƒç´  ç´¢å¼•åˆ—è¡¨ä¸­çš„å…ƒç´ ä¸ä»…æ”¯æŒæ­£æ•°è¿˜æ”¯æŒè´Ÿæ•°ï¼Œæ­£æ•°è¡¨ç¤ºä»Žåˆ—è¡¨çš„å·¦è¾¹å¼€å§‹ç´¢å¼•ï¼Œè´Ÿæ•°è¡¨ç¤ºä»Žåˆ—è¡¨çš„å³è¾¹å¼€å§‹ç´¢å¼•ï¼ŒèŽ·å–æœ€åŽä¸€ä¸ªå…ƒç´ æœ‰ä¸¤ç§æ–¹æ³•ã€‚ 12345&gt;&gt;&gt; a = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]&gt;&gt;&gt; a[len(a)-1]10&gt;&gt;&gt; a[-1]10 7ã€å¦‚ä½•å¯¹åˆ—è¡¨è¿›è¡ŒæŽ’åº åˆ—è¡¨æŽ’åºæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯åˆ—è¡¨è‡ªå¸¦çš„æ–¹å¼ sortï¼Œä¸€ç§æ˜¯å†…å»ºå‡½æ•° sortedã€‚å¤æ‚çš„æ•°æ®ç±»åž‹å¯é€šè¿‡æŒ‡å®š keyå‚æ•°è¿›è¡ŒæŽ’åºã€‚ç”±å­—å…¸æž„æˆçš„åˆ—è¡¨ï¼Œæ ¹æ®å­—å…¸å…ƒç´ ä¸­çš„ageå­—æ®µè¿›è¡ŒæŽ’åºï¼š 12345678910items = [&#123;'name': 'Homer', 'age': 39&#125;, &#123;'name': 'Bart', 'age': 10&#125;, &#123;"name": 'cater', 'age': 20&#125;]items.sort(key=lambda item: item.get("age"))print(items)&gt;&gt;&gt;[&#123;'age': 10, 'name': 'Bart'&#125;, &#123;'age': 20, 'name': 'cater'&#125;, &#123;'age': 39, 'name': 'Homer'&#125;] åˆ—è¡¨æœ‰ sortæ–¹æ³•ï¼Œç”¨äºŽå¯¹åŽŸåˆ—è¡¨è¿›è¡Œé‡æ–°æŽ’åºï¼ŒæŒ‡å®š key å‚æ•°ï¼Œkey æ˜¯åŒ¿åå‡½æ•°ï¼Œitem æ˜¯åˆ—è¡¨ä¸­çš„å­—å…¸å…ƒç´ ï¼Œæˆ‘ä»¬æ ¹æ®å­—å…¸ä¸­çš„ageè¿›è¡ŒæŽ’åºï¼Œé»˜è®¤æ˜¯æŒ‰å‡åºæŽ’åˆ—ï¼ŒæŒ‡å®š reverse=True æŒ‰é™åºæŽ’åˆ— 1234items.sort(key=lambda item: item.get("age"), reverse=True)&gt;&gt;&gt;[&#123;'name': 'Homer', 'age': 39&#125;, &#123;'name': 'cater', 'age': 20&#125;, &#123;'name': 'Bart', 'age': 10&#125;] å¦‚æžœä¸å¸Œæœ›æ”¹å˜åŽŸåˆ—è¡¨ï¼Œè€Œæ˜¯ç”Ÿæˆä¸€ä¸ªæ–°çš„æœ‰åºåˆ—è¡¨å¯¹è±¡ï¼Œé‚£ä¹ˆå¯ä»¥å†…ç½®å‡½æ•° sorted ï¼Œè¯¥å‡½æ•°è¿”å›žæ–°åˆ—è¡¨ 12345678910111213items = [&#123;'name': 'Homer', 'age': 39&#125;, &#123;'name': 'Bart', 'age': 10&#125;, &#123;"name": 'cater', 'age': 20&#125;]new_items = sorted(items, key=lambda item: item.get("age"))print(items)&gt;&gt;&gt;[&#123;'name': 'Homer', 'age': 39&#125;, &#123;'name': 'Bart', 'age': 10&#125;, &#123;'name': 'cater', 'age': 20&#125;]print(new_items)&gt;&gt;&gt;[&#123;'name': 'Bart', 'age': 10&#125;, &#123;'name': 'cater', 'age': 20&#125;, &#123;'name': 'Homer', 'age': 39&#125;] 8ã€å¦‚ä½•ç§»é™¤åˆ—è¡¨ä¸­çš„å…ƒç´ åˆ é™¤åˆ—è¡¨ä¸­çš„å…ƒç´ æœ‰ä¸‰ç§æ–¹å¼ remove ç§»é™¤æŸä¸ªå…ƒç´ ï¼Œè€Œä¸”åªèƒ½ç§»é™¤ç¬¬ä¸€æ¬¡å‡ºçŽ°çš„å…ƒç´  12345678910&gt;&gt;&gt; a = [0, 2, 2, 3]&gt;&gt;&gt; a.remove(2)&gt;&gt;&gt; a[0, 2, 3]# å¦‚æžœè¦ç§»é™¤çš„å…ƒç´ ä¸åœ¨åˆ—è¡¨ä¸­ï¼Œåˆ™æŠ›å‡º ValueError å¼‚å¸¸&gt;&gt;&gt; a.remove(7)Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;ValueError: list.remove(x): x not in listÂ· delæ ¹æ®æŒ‡å®šçš„ç´¢å¼•ç§»é™¤å…ƒç´  12345678910&gt;&gt;&gt; a = [3, 2, 2, 1]# ç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´ &gt;&gt;&gt; del a[1][3, 2, 1]# å½“è¶…å‡ºåˆ—è¡¨çš„ä¸‹è¡¨ç´¢å¼•æ—¶ï¼ŒæŠ›å‡ºIndexErrorçš„å¼‚å¸¸&gt;&gt;&gt; del a[7]Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;IndexError: list assignment index out of range popä¸Ždelç±»ä¼¼ï¼Œä½†æ˜¯popæ–¹æ³•å¯ä»¥è¿”å›žç§»é™¤çš„å…ƒç´  1234567891011&gt;&gt;&gt; a = [4, 3, 5]&gt;&gt;&gt; a.pop(1)3&gt;&gt;&gt; a[4, 5]# åŒæ ·ï¼Œå½“è¶…å‡ºåˆ—è¡¨çš„ä¸‹è¡¨ç´¢å¼•æ—¶ï¼ŒæŠ›å‡ºIndexErrorçš„å¼‚å¸¸&gt;&gt;&gt; a.pop(7)Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;IndexError: pop index out of range 9ã€å¦‚ä½•è¿žæŽ¥ä¸¤ä¸ªåˆ—è¡¨12345678listone = [1, 2, 3]listtwo = [4, 5, 6]mergedlist = listone + listtwoprint(mergelist)&gt;&gt;&gt;[1, 2, 3, 4, 5, 6] åˆ—è¡¨å®žçŽ°äº† + çš„è¿ç®—ç¬¦é‡è½½ï¼Œä½¿å¾— + ä¸ä»…æ”¯æŒæ•°å€¼ç›¸åŠ ï¼Œè¿˜æ”¯æŒä¸¤ä¸ªåˆ—è¡¨ç›¸åŠ ï¼Œåªè¦ä½ å®žçŽ°äº† å¯¹è±¡çš„ __add__æ“ä½œï¼Œä»»ä½•å¯¹è±¡éƒ½å¯ä»¥å®žçŽ° + æ“ä½œï¼Œä¾‹å¦‚ï¼š 123456789101112131415161718192021class User(object): def __init__(self, age): self.age = age def __repr__(self): return 'User(%d)' % self.age def __add__(self, other): age = self.age + other.age return User(age)user_a = User(10)user_b = User(20)c = user_a + user_bprint(c)&gt;&gt;&gt;User(30) 10ã€å¦‚ä½•éšæœºèŽ·å–åˆ—è¡¨ä¸­çš„æŸä¸ªå…ƒç´ 123456789import randomitems = [8, 23, 45, 12, 78]&gt;&gt;&gt; random.choice(items)78&gt;&gt;&gt; random.choice(items)45&gt;&gt;&gt; random.choice(items)12]]></content>
      <categories>
        <category>Python-Basis</category>
      </categories>
      <tags>
        <tag>list</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å·¥å…·ä¹‹Charlesä½¿ç”¨é—®é¢˜è®°å½•]]></title>
    <url>%2F2018%2F04%2F07%2F%E5%B7%A5%E5%85%B7%E4%B9%8BCharles%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘ç ”ç©¶çˆ¬è™«éœ€è¦è¿›è¡ŒHTTPæŠ“åŒ…ï¼Œç”±äºŽ Fiddleræ²¡æœ‰Macç‰ˆæœ¬ï¼Œé€‰æ‹©ä½¿ç”¨Charlesï¼ˆé’èŠ±ç“·ï¼‰æ¥æŠ“åŒ…ï¼Œæ–‡ç«  è®°å½•ä¸€ä¸‹ Charlesçš„ä½¿ç”¨å’Œä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ ç›®æ ‡ï¼šCharlesæŠ“åŒ…&amp;é—®é¢˜è®°å½• å®‰è£… å®‰è£…åŒ…ç™¾åº¦äº‘é“¾æŽ¥ï¼šé“¾æŽ¥:https://pan.baidu.com/s/1QYaEVwgKSH8znwORotBOvg å¯†ç :s7jz å®‰è£…æ­¥éª¤1ã€ç‚¹å‡»dmgå®‰è£…â€”&gt;åº”ç”¨ç¨‹åº 2ã€æ‰“å¼€charlesåº”ç”¨ç¨‹åºâ€”&gt;æ˜¾ç¤ºåŒ…ä¿¡æ¯â€”&gt;æ›¿æ¢å…¶ä¸­çš„ charles.jaråŒ… åŸºæœ¬ä½¿ç”¨ è¿™ä¸ªæˆ‘å°±ä¸è¿‡å¤šä»‹ç»ç½‘ä¸Šæ•™ç¨‹ä¸€å¤§å †ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å¦‚æžœè¦æŠ“ httpséœ€è¦å®‰è£…è¯ä¹¦ï¼Œå¹¶ä½¿è¯ä¹¦å¯ä¿¡ä»» é—®é¢˜è®°å½• å®‰è£…è¯ä¹¦ä»¥åŽè¿˜æ˜¯æ— æ³•æŠ“HTTPSçš„åŒ…ï¼Œæ˜¾ç¤ºunknown?è§£å†³æ­¥éª¤ 1ã€ç‚¹å‡»Proxyâ€”&gt;SSL Proxying settingsâ€”&gt;SSL Proxyingâ€”&gt;Addâ€”&gt; HOSTå’ŒPORTéƒ½å¡«å†™ *å³å¯ 2ã€é‡å¯ charles å®‰è£…Charles æŠ“åŒ…ä¿¡æ¯å½“ä¸­ä»¥åŽä¸æ˜¾ç¤º requestå’Œresponseè§£å†³æ­¥éª¤ 1ã€ç‚¹å‡»Preferencesâ€”&gt;Viewersâ€”&gt;æŠŠ Combine request and response å–æ¶ˆå‹¾é€‰â€”&gt;ç‚¹å‡»OKå³å¯ 2ã€é‡å¯charles æŠ“åŒ…æ‰‹æœºé…ç½®é“¾æŽ¥ï¼šhttps://blog.csdn.net/pansanday/article/details/80347632]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Charles</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[çˆ¬è™«ä¹‹æ•°æ®æå–]]></title>
    <url>%2F2018%2F03%2F23%2F%E7%88%AC%E8%99%AB%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%8F%90%E5%8F%96%2F</url>
    <content type="text"><![CDATA[ä»Šå¤©ä¸»è¦è®°å½•ä¸€ä¸‹æ•°æ®æå–çš„å‡ ç§æ–¹æ³•ï¼Œåœ¨çˆ¬è™«èŽ·å–åˆ°å“åº”æ•°æ®ä»¥åŽæˆ‘ä»¬æ”¹æ€Žä¹ˆå¤„ç†å“åº”çš„æ•°æ®å‘¢ï¼Ÿä»Žç½‘ä¸Šæ‹¿åˆ°çš„å“åº”æ•°æ®å„ç§ç±»åž‹éƒ½æœ‰ï¼šJSONç±»åž‹çš„ï¼ŒXMLæ ¼å¼çš„,htmlæ ¼å¼çš„ç­‰ç­‰ã€‚ å¸¸ç”¨çš„æ•°æ®æå–æ–¹å¼ jsonpath re xpath beautifulsoup ä¸€ã€jsonpathåŸºæœ¬ä½¿ç”¨ jsonæ˜¯ä»€ä¹ˆJSON(JavaScript Object Notation) æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼ï¼Œå®ƒä½¿å¾—äººä»¬å¾ˆå®¹æ˜“çš„è¿›è¡Œé˜…è¯»å’Œç¼–å†™ã€‚åŒæ—¶ä¹Ÿæ–¹ä¾¿äº†æœºå™¨è¿›è¡Œè§£æžå’Œç”Ÿæˆã€‚é€‚ç”¨äºŽè¿›è¡Œæ•°æ®äº¤äº’çš„åœºæ™¯ï¼Œæ¯”å¦‚ç½‘ç«™å‰å°ä¸ŽåŽå°ä¹‹é—´çš„æ•°æ®äº¤äº’ã€‚ jsonæ¨¡å—å¸¸ç”¨æ“ä½œ json.loads(json_str) JSONå­—ç¬¦ä¸²â€”&gt;è½¬æ¢æˆPythonæ•°æ®ç±»åž‹ json.dumps(dict_data) Pythonæ•°æ®ç±»åž‹â€”&gt;JSONå­—ç¬¦ä¸² json.load(f) jsonæ–‡ä»¶â€”&gt;èŽ·å–Pythonæ•°æ®ç±»åž‹ json.dump(dict_data, f) Pythonæ•°æ®ç±»åž‹â€”&gt;å†™å…¥jsonæ–‡ä»¶ ensure_ascii=False æ˜¾ç¤ºä¸­æ–‡ indent=æ•°å­—è¡¨ç¤ºç©ºæ ¼ Jsonpathæ˜¯ä»€ä¹ˆï¼Ÿ jsonpathæ˜¯ä¸€ç§è¯­æ³•è§„åˆ™å¿«é€Ÿä»ŽJSONæ•°æ®å½“ä¸­æå–æ•°æ® åœ¨çº¿è°ƒè¯•ç½‘å€ï¼šhttps://jsonpath.com/ åœ¨çº¿è§£æžå·¥å…·ï¼šhttps://www.json.cn/# è¯­æ³•è§„åˆ™ è¯­æ³• æè¿° æ¡ˆä¾‹ $ æ ¹èŠ‚ç‚¹ @ çŽ°è¡ŒèŠ‚ç‚¹ . å–å­èŠ‚ç‚¹ $.store.book .. å–å­å­™èŠ‚ç‚¹ $..book [] è®¾ç½®ç­›é€‰æ¡ä»¶ $..book[0] [,] æ”¯æŒå¤šé€‰é€‰æ‹©å†…å®¹ $..book[1,3] () æ”¯æŒè¡¨è¾¾å¼è®¡ç®— $..book[(@.length - 1)] ?() æ”¯æŒè¿‡æ»¤æ“ä½œ $..book[?(@.price&lt;10)] Pythonä¸­æ€Žä¹ˆä½¿ç”¨123import jsonpathdata = jsonpath('å­—å…¸ç±»åž‹æ•°æ®', 'jsonpathæå–è¯­æ³•')# dataæ˜¯listç±»åž‹ å¦‚æžœæå–ä¸å‡ºæ¥è¿”å›žFalse äºŒã€reåŸºæœ¬ä½¿ç”¨ ç”¨äº‹å…ˆå®šä¹‰å¥½çš„ä¸€äº›ç‰¹å®šå­—ç¬¦ï¼ŒåŠè¿™äº›ç‰¹å®šå­—ç¬¦çš„ç»„åˆï¼Œç»„æˆä¸€ä¸ªè§„åˆ™å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªè§„åˆ™å­—ç¬¦ä¸²ç”¨æ¥è¡¨è¾¾å¯¹å­—ç¬¦ä¸²çš„ä¸€ç§è¿‡æ»¤é€»è¾‘ åŸºæœ¬è¯­æ³• é¢„å®šä¹‰å­—ç¬¦é›† \dè¡¨ç¤ºæ•°å­—ï¼š[0-9] \Dè¡¨ç¤ºéžæ•°å­—ï¼š[^\d] \sè¡¨ç¤ºç©ºç™½å­—ç¬¦ \Séžç©ºç™½å­—ç¬¦ \wå•è¯å­—ç¬¦ï¼š[A-Z,a-z,0-9] \Wéžå•è¯å­—ç¬¦ï¼š[^\w] .åŒ¹é…ä»»æ„é™¤æ¢è¡Œç¬¦\nå¤–çš„å­—ç¬¦ï¼Œå¤‡æ³¨ï¼šåœ¨DoTALLæ¨¡å¼ä¸­ä¹Ÿèƒ½åŒ¹é…æ¢è¡Œç¬¦ \è½¬ä¹‰å­—ç¬¦ï¼Œä½¿åŽä¸€ä¸ªå­—ç¬¦è¡¨ç¤ºå­—ç¬¦æœ¬èº« []è¡¨ç¤ºå­—ç¬¦çš„é€‰å–èŒƒå›´ æ•°é‡è¯ *è¡¨ç¤ºä»»æ„ä¸ª +è¡¨ç¤ºè‡³å°‘ä¸€ä¸ª ?è¡¨ç¤ºè‡³å¤šä¸€ä¸ªï¼ˆ1ä¸ªæˆ–è€…æ²¡æœ‰ï¼‰ {}è¡¨ç¤ºèŒƒå›´åŒºé—´ {1} è¡¨ç¤ºåŒ¹é…ä¸€ä¸ªå­—ç¬¦ {1,6}è¡¨ç¤ºåŒ¹é…1åˆ°6ä¸ªå­—ç¬¦ {,6}è¡¨ç¤ºæœ€å¤šåŒ¹é…6ä¸ªå­—ç¬¦ è´ªå©ªæ¨¡å¼å’Œéžè´ªå©ªæ¨¡å¼ è´ªå©ªæ¨¡å¼(.*)å°½å¯èƒ½å¤šçš„åŒ¹é… éžè´ªå©ªæ¨¡å¼(.*?)ä¸€æ—¦åŒ¹é…åˆ°å°±ç»“æŸ DOTALLæ¨¡å¼ è®©.åŒ¹é…\n 1re.RegexFlag.DOTALLã€re.RegexFlag.Sã€re.Sã€re.DOTALL å¿½ç•¥å¤§å°å†™ 1re.RegexFlag.I re.RegexFlag.IGNORECASE re.I re.IGNORECASE æ”¯æŒDOTALL å’Œå¿½ç•¥å¤§å°å†™ ç”¨| åŽŸå§‹å­—ç¬¦ä¸²ä½¿ç”¨rä¸ç”¨\ æ­£åˆ™å‰é¢ä½¿ç”¨ræ­£åˆ™è¯­æ³• å››ç§åŒ¹é…æ£€ç´¢æ–¹æ³• match match ä»Žå¤´å¼€å§‹åŒ¹é…ï¼Œä»…åŒ¹é…ä¸€æ¬¡ search search å…¨å±€åŒ¹é…ï¼Œä»…åŒ¹é…ä¸€æ¬¡ findall findall èŽ·å–ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰æ•°æ®ï¼Œè¿”å›žåˆ—è¡¨ finditer finditer èŽ·å–ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰æ•°æ®ï¼Œè¿”å›žè¿­ä»£å™¨å¯¹è±¡ æ•°æ®é‡å¤§çš„æ—¶å€™æŽ¨èä½¿ç”¨ï¼Œæé«˜å†…å­˜ä½¿ç”¨æ•ˆçŽ‡ åˆ†ç»„&amp;æ›¿æ¢ sub split é€šç”¨åˆ†ç»„æ ¼å¼ï¼š[åˆ†éš”ç¬¦]+ 1234567import redata = 's,fqw;fwe, fds;fsda,afds;'pattern = re.compile(r'[, ;]+')ret = pattern.split(data)print(ret) è¾“å‡º 1['s', 'fqw', 'fwe', 'fds', 'fsda', 'afds', ''] sub 12345678import redata = 's,fqw;fwe,fds;fsda,afds;'# æŠŠ, ; éƒ½æ›¿æ¢æˆ #pattern = re.compile(r'[,;]+')ret = pattern.sub('#', data)print(ret) è¾“å‡º 1s#fqw#fwe#fds#fsda#afds# ä¸‰ã€XpathåŸºæœ¬ä½¿ç”¨ xpathæ˜¯ä¸€é—¨åœ¨HTML/XMLæ–‡æœ¬ä¸­æŸ¥æ‰¾ä¿¡æ¯çš„è¯­è¨€ï¼Œå¯ä»¥ç”¨åœ¨HTML/XMLæ–‡æ¡£ä¸­å¯¹å…ƒç´ å’Œå±žæ€§è¿›è¡ŒéåŽ†ï¼Œç®€å•æ¥è¯´å°±ç±»ä¼¼äºŽæ­£åˆ™é€šè¿‡ä¸€å®šçš„è¯­æ³•è§„åˆ™ä»Žæ–‡æœ¬ä¸­æå–æ•°æ® åŸºæœ¬è¯­æ³• èŠ‚ç‚¹é€‰æ‹© /è¡¨ç¤ºä»Žæ ¹èŠ‚ç‚¹é€‰å– //ä»ŽåŒ¹é…é€‰æ‹©çš„å½“å‰èŠ‚ç‚¹é€‰æ‹©æ–‡æ¡£ä¸­çš„èŠ‚ç‚¹ .è¡¨ç¤ºé€‰å–å½“å‰èŠ‚ç‚¹ ..é€‰å–å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ é€‰å–å±žæ€§ @ //èŠ‚ç‚¹/@å±žæ€§åç§° æ–‡æœ¬é€‰æ‹© text()é€‰å–æ–‡æœ¬ /text() é«˜çº§è¯­æ³•-ç­›é€‰æ¡ä»¶ //node[ç­›é€‰æ¡ä»¶] é€šè¿‡ä¸‹æ ‡ï¼ˆæ•°å­—ï¼‰ç­›é€‰ï¼ˆä¸‹æ ‡ä»Ž1å¼€å§‹ï¼‰ /node[1] é€šè¿‡å±žæ€§ç­›é€‰ /node[@å±žæ€§] /node[@å±žæ€§=å€¼] é€šè¿‡æ–‡æœ¬å†…å®¹ç­›é€‰ //node[text()=&#39;ç­›é€‰çš„å€¼&#39;] é€šè¿‡å†…ç½®å‡½æ•° last() position() containesåŒ…å«å†…å®¹ contains(text(), &#39;æ–‡æœ¬&#39;) contains(@å±žæ€§ï¼Œ â€˜å±žæ€§å€¼â€™) starts-with ä»Žå¤´åŒ¹é…å†…å®¹ è¯­æ³•å’Œcontainesä¸€æ · é€šè¿‡å­èŠ‚ç‚¹æ¥ç­›é€‰ /node[node_å­èŠ‚ç‚¹&gt;å­èŠ‚ç‚¹çš„å€¼] é€šé…ç¬¦ *åŒ¹é…ä»»ä½•å…ƒç´ èŠ‚ç‚¹ //*[text()=&#39;æŸå€¼&#39;] //*[@category=â€™æŸvalueâ€™] @*åŒ¹é…nodeä»»æ„å±žæ€§çš„value //node[@*=&#39;æŸvalue&#39;] å¤šä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³ ä½¿ç”¨ | lxmlæ¨¡å— Python lxmlæ¨¡å—åŽ»ä½¿ç”¨xpathè¯­æ³• å®‰è£…1pip install lxml lxmlåŸºæœ¬ä½¿ç”¨1ã€å¯¼å…¥æ¨¡å— 1from lxml import etree 2ã€æž„å»ºæ ¹å…ƒç´ å¯¹è±¡ 1eroot = etree.HTML(html_data) # eroot æ˜¯ä¸€ä¸ªelementå¯¹è±¡ 3ã€æ“ä½œæ ¹å…ƒç´ å¯¹è±¡æå–æ•°æ® 1eroot.xpath('xpathè¯­æ³•è§„åˆ™') 4ã€æ‰“å°è°ƒè¯•æŸ¥çœ‹elementå¯¹è±¡å†…å®¹ 1etree.tostring(eroot).decode('utf-8') å››ã€beautifulsoupåŸºæœ¬ä½¿ç”¨ ä»‹ç» Beautifulsoupä¹Ÿæ˜¯ä¸€ä¸ªHTML/XMlçš„è§£æžå™¨ï¼Œè·Ÿä¸Šé¢çš„ lxmlä¸€æ · ä¼˜ç‚¹ ç”¨æ¥è§£æžHTMLæ¯”è¾ƒç®€å•ï¼ŒAPIéžå¸¸äººæ€§åŒ–ï¼Œæ”¯æŒCSSé€‰æ‹©å™¨ ç¼ºç‚¹ lxmlåªä¼šéåŽ†å±€éƒ¨ï¼Œè€ŒBeautifusoupæ˜¯åŸºäºŽHTML DOMçš„ï¼Œä¼šè½½å…¥æ•´ä¸ªæ–‡æ¡£ï¼Œè§£æžæ•´ä¸ªDOMæ ‘ï¼Œå› æ­¤æ—¶é—´å’Œå†…å­˜å¼€é”€éƒ½ä¼šå¤§å¾ˆå¤šï¼Œæ‰€ä»¥æ€§èƒ½è¦ä½ŽäºŽlxml å®‰è£…1pip install beautifulsoup4 å®˜æ–¹æ–‡æ¡£ï¼šhttp://beautifulsoup.readthedocs.io/zh_CN/v4.4.0 åŸºæœ¬ä½¿ç”¨1ã€å¯¼å…¥æ¨¡å— 1from bs4 import BeautifulSoup 2ã€åˆ›å»ºbeautifulsoupå¯¹è±¡ 12soup = BeautifulSoup(html,'lxml')soup = BeautifulSoup(open('æ–‡ä»¶')) 3ã€æ“ä½œnode èŽ·å–å…ƒç´ æ ‡ç­¾å†…å®¹ 1soup.æ ‡ç­¾åç§° èŽ·å–å­å…ƒç´  1234# è¿”å›žåˆ—è¡¨soup.node_name.contents# è¿”å›žè¿­ä»£å™¨soup.node_name.children èŽ·å–å…ƒç´ å†…å®¹ 1soup.node_name.get_text() èŽ·å–å…ƒç´ å±žæ€§å€¼ 1soup.a.get('href') æ³¨æ„å¦‚æžœèŽ·å–å…ƒç´ çš„å±žæ€§æ˜¯ classè¿”å›žçš„æ˜¯åˆ—è¡¨ find å’Œfind_allä»‹ç» findè¿”å›žç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´  find_allè¿”å›žç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰å…ƒç´ åˆ—è¡¨ å¤‡æ³¨ï¼šfindå’Œfind_allæä¾›å‚æ•°éƒ½ä¸€æ ·ï¼Œä¸‹é¢ä»¥find_all()æ¥å±•ç¤º 1ã€é€šè¿‡æ ‡ç­¾å’Œæ ‡ç­¾åˆ—è¡¨æŸ¥æ‰¾å…ƒç´  12soup.find_all('a') # æŸ¥è¯¢æ‰€æœ‰çš„aæ ‡ç­¾soup.find_all(['a', 'b']) # æŸ¥è¯¢æ‰€æœ‰çš„aæ ‡ç­¾å’Œbæ ‡ç­¾ 2ã€é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾å…ƒç´  12# ä»¥bå¼€å¤´çš„æ ‡ç­¾æŸ¥æ‰¾soup.find_all(re.compile('^b')) 3ã€é€šè¿‡å±žæ€§æ¥æŸ¥æ‰¾ 12345soup.find_all(&#123; attrs=&#123; 'å±žæ€§å'ï¼š'å€¼' &#125;&#125;) 4ã€é€šè¿‡æ–‡æœ¬å†…å®¹æŸ¥æ‰¾å…ƒç´  1soup.find_all(text='æŸ¥è¯¢çš„æ–‡æœ¬å†…å®¹') 6ã€æ··åˆä½¿ç”¨ 1234567soup.find_all( 'æ ‡ç­¾å', attrs=&#123; 'å±žæ€§å'ï¼š'å€¼' &#125;ï¼Œ text='å†…å®¹') CSSæ ·å¼é€‰æ‹©å™¨ è¿”å›žå€¼æ˜¯ä¸€ä¸ªlist ç±»é€‰æ‹©å™¨ ä½¿ç”¨ .å¼€å¤´ 1soup.select('.class_name') IDé€‰æ‹©å™¨ï¼Œä½¿ç”¨#å¼€å¤´ 1soup.select('#id_name') æ ‡ç­¾é€‰æ‹©å™¨ï¼Œä½¿ç”¨æ ‡ç­¾ åç§° 1soup.select('p_name') å±žæ€§é€‰æ‹©å™¨ 1soup.select('p[å±žæ€§=å€¼]') å±‚çº§é€‰æ‹©å™¨ div p é€‰æ‹© &lt;div&gt; å…ƒç´ å†…éƒ¨çš„æ‰€æœ‰ &lt;p&gt; å…ƒç´ ã€‚ div , p é€‰æ‹©æ‰€æœ‰ &lt;div&gt; å…ƒç´ å’Œæ‰€æœ‰ &lt;p&gt; å…ƒç´ ã€‚ div &gt; p é€‰æ‹©çˆ¶å…ƒç´ ä¸º &lt;div&gt; å…ƒç´ çš„æ‰€æœ‰ &lt;p&gt; å…ƒç´ ã€‚ .cls1.cls2 é€‰æ‹©ç±»åæ˜¯cls1 å¹¶ä¸” ç±»åæ˜¯cls2]]></content>
      <categories>
        <category>Spider</category>
      </categories>
      <tags>
        <tag>re</tag>
        <tag>jsonpath</tag>
        <tag>bs4</tag>
        <tag>xpath</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[çˆ¬è™«ä¹‹jsé€†å‘ç™¾åº¦ç¿»è¯‘]]></title>
    <url>%2F2018%2F03%2F22%2F%E7%88%AC%E8%99%AB%E4%B9%8Bjs%E9%80%86%E8%A1%8C%E7%99%BE%E5%BA%A6%E7%BF%BB%E8%AF%91%2F</url>
    <content type="text"><![CDATA[çˆ¬è™«å°è¯•èº«æ‰‹ä¹‹jsé€†å‘ç™¾åº¦ç¿»è¯‘ï¼Œç›®å‰ç™¾åº¦ç¿»è¯‘åœ¨PCå’Œç§»åŠ¨ç«¯éƒ½åšäº†åæ‰’æŽªæ–½ï¼Œä»Šå¤©æˆ‘ä»¬ä¸€çœ‹ç©¶ç«Ÿï½ž ä»€ä¹ˆæ˜¯jsé€†å‘ï¼Ÿæ‰€è°“çš„jsé€†å‘å…¶å®žå°±æ˜¯ç ´è§£å¯¹æ–¹åæ‰’çš„ä¸€ç§æ–¹å¼ï¼Œç›®å‰å¾ˆå¤šç½‘ç«™åæ‰’éƒ½ä½¿ç”¨jsæ¥åšï¼Œç™¾åº¦ç¿»è¯‘çš„åæ‰’ä¸»è¦æ˜¯åˆ©ç”¨äº†è¯·æ±‚å‚æ•°ä¸­çš„ signè¿™ä¸ªç­¾åæ¥åšçš„ï¼Œä¸‹é¢å°±æ¥è¯¦ç»†çš„è®²è§£ signæ€Žä¹ˆå˜åŠ¨äº†ï¼Ÿå½“ä½ æ›´æ¢è¾“å…¥æ¡†è¾“å…¥çš„ç¿»è¯‘ç›®æ ‡æ—¶ï¼Œå¯¹æ¯”è¯·æ±‚æºå¸¦çš„å‚æ•°å‘çŽ°signè¿™ä¸ªå‚æ•°éšç€è¾“å…¥çš„å•è¯æ‰€å˜åŠ¨ï¼Œåˆ¤æ–­åº”è¯¥æ˜¯jsä»£ç åœ¨è¯·æ±‚å‰ç”Ÿæˆäº†è¿™ä¸ªsignï¼Œéœ€è¦åŽ»å®šä½å…·ä½“å“ªä¸ªJSæ–‡ä»¶çš„ç”Ÿæˆäº†è¿™ä¸ªsign æ ¹æ®ä¸Šå›¾æˆ‘ä»¬å¯ä»¥çœ‹å‡ºsignå‚æ•°æ˜¯ç”±jsä»£ç  m(a)æ¥ç”Ÿæˆçš„ï¼Œaå‚æ•°æ˜¯asä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦ç¿»è¯‘çš„ç›®æ ‡ï¼Œè¿™ä¸ªæ˜¯æˆ‘ä»¬å¯ä»¥æ‹¿åˆ°çš„ï¼ŒçŽ°åœ¨è¦åšçš„å°±æ˜¯å¦‚ä½•æ‰§è¡Œm()è¿™æ®µjsä»£ç ï¼ŒPythonè¢«ç§°ä¸ºèƒ¶æ°´è¯­è¨€ï¼Œåœ¨Pythonå½“ä¸­è°ƒç”¨JSä»£ç è‡ªç„¶ä¹Ÿæ˜¯å¯ä»¥å®žçŽ°çš„ï¼ŒPythonè°ƒç”¨jsä»£ç ç›®å‰ä¸»æµçš„ä¸¤ä¸ªæ¨¡å— pyexecjs ã€js2pyï¼Œä»Šå¤©æˆ‘ä»¬è®²çš„ä¸»è¦æ˜¯é€šè¿‡ js2pyæ¥å®žçŽ°ã€‚ ä¸‹è½½æ¨¡å—1pip install js2py åŸºæœ¬ä½¿ç”¨ åœ¨pythonå½“ä¸­æ‰§è¡Œjs 12345678# 1.å¯¼å…¥æ¨¡å—import js2py# 2.æž„å»ºä¸Šä¸‹æ–‡å¯¹è±¡content = js2py.EvalJs()# 3.åœ¨Pythonå½“ä¸­æ‰§è¡Œjsä»£ç content.execute("console.log('abc')") è¾“å‡º1'abc' åœ¨JSä»£ç ä¸­è°ƒç”¨Pythonç¨‹åº 123456789101112131415161718# 1.å¯¼å…¥æ¨¡å—import js2py# 2.æž„å»ºä¸Šä¸‹æ–‡å¯¹è±¡content = js2py.EvalJs()# 3.åœ¨jså½“ä¸­è°ƒç”¨Pythonç¨‹åºcontent.a = 1content.b = 'abc'content.c = [1, 3, 4]content.d = &#123; "name": 'qwe'&#125;content.execute('console.log(a)')content.execute('console.log(b)')content.execute('console.log(c)')content.execute('console.log(d)') è¾“å‡º1234'1''abc'[1, 3, 4]&#123;'name': 'qwe'&#125; å®žæˆ˜æ—¢ç„¶Pythoncodeä¸­å¯ä»¥è°ƒç”¨jsæˆ‘ä»¬åªè¦æ‰¾åˆ°è¿™æ®µjsåœ¨ä»£ç ä¸­æ‰§è¡Œå°±è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œä¸Šä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041# Pythonä»£ç # 1.å¯¼å…¥æ¨¡å—import requestsimport js2py# 2.å‘é€è¯·æ±‚ï¼ŒèŽ·å–å“åº”å†…å®¹# è¯·æ±‚åœ°å€ è¯·æ±‚å¤´ è¯·æ±‚æ–¹å¼ è¯·æ±‚å‚æ•°url = 'https://fanyi.baidu.com/v2transapi'headers = &#123; 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.75 Safari/537.36', 'Referer': 'https://fanyi.baidu.com/?aldtype=16047', 'Cookie': 'BAIDUID=DAD75821AD7D4663D00D9C0E7F9C8011:FG=1; BIDUPSID=DAD75821AD7D4663D00D9C0E7F9C8011; PSTM=1553134744; BDORZ=B490B5EBF6F3CD402E515D22BCDA1598; delPer=0; H_PS_PSSID=1439_21121_18559_28723_28557_28697_28585_28518_28627_22157; PSINO=2; locale=zh; to_lang_often=%5B%7B%22value%22%3A%22en%22%2C%22text%22%3A%22%u82F1%u8BED%22%7D%2C%7B%22value%22%3A%22zh%22%2C%22text%22%3A%22%u4E2D%u6587%22%7D%5D; REALTIME_TRANS_SWITCH=1; FANYI_WORD_SWITCH=1; HISTORY_SWITCH=1; SOUND_SPD_SWITCH=1; SOUND_PREFER_SWITCH=1; from_lang_often=%5B%7B%22value%22%3A%22zh%22%2C%22text%22%3A%22%u4E2D%u6587%22%7D%2C%7B%22value%22%3A%22en%22%2C%22text%22%3A%22%u82F1%u8BED%22%7D%5D; Hm_lvt_64ecd82404c51e03dc91cb9e8c025574=1553218276,1553218292; Hm_lpvt_64ecd82404c51e03dc91cb9e8c025574=1553218292'&#125;# éœ€è¦ç¿»è¯‘çš„å†…å®¹kw = 'thank'# æž„å»ºä¸Šä¸‹æ–‡å¯¹è±¡content = js2py.EvalJs()with open('test.js', 'r') as f: content.execute(f.read()) sign = content.e(kw)data = &#123; "from": "en", "to": "zh", "query": kw, "transtype": "translang", "simple_means_flag": "3", "sign": sign, "token": "88d322490309c4abee0496f0dbab1a4b",&#125;response = requests.post( url=url, headers=headers, data=data)print(response.json()) 123456789101112131415161718192021222324252627282930313233343536373839404142434445// test.js æ–‡ä»¶var i = '320305.131321201';function n(r, o) &#123; for (var t = 0; t &lt; o.length - 2; t += 3) &#123; var a = o.charAt(t + 2); a = a &gt;= "a" ? a.charCodeAt(0) - 87 : Number(a), a = "+" === o.charAt(t + 1) ? r &gt;&gt;&gt; a : r &lt;&lt; a, r = "+" === o.charAt(t) ? r + a &amp; 4294967295 : r ^ a &#125; return r &#125;function e(r) &#123; var o = r.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g); if (null === o) &#123; var t = r.length; t &gt; 30 &amp;&amp; (r = "" + r.substr(0, 10) + r.substr(Math.floor(t / 2) - 5, 10) + r.substr(-10, 10)) &#125; else &#123; for (var e = r.split(/[\uD800-\uDBFF][\uDC00-\uDFFF]/), C = 0, h = e.length, f = []; h &gt; C; C++) "" !== e[C] &amp;&amp; f.push.apply(f, a(e[C].split(""))), C !== h - 1 &amp;&amp; f.push(o[C]); var g = f.length; g &gt; 30 &amp;&amp; (r = f.slice(0, 10).join("") + f.slice(Math.floor(g / 2) - 5, Math.floor(g / 2) + 5).join("") + f.slice(-10).join("")) &#125; var u = void 0 , l = "" + String.fromCharCode(103) + String.fromCharCode(116) + String.fromCharCode(107); u = null !== i ? i : (i = window[l] || "") || ""; for (var d = u.split("."), m = Number(d[0]) || 0, s = Number(d[1]) || 0, S = [], c = 0, v = 0; v &lt; r.length; v++) &#123; var A = r.charCodeAt(v); 128 &gt; A ? S[c++] = A : (2048 &gt; A ? S[c++] = A &gt;&gt; 6 | 192 : (55296 === (64512 &amp; A) &amp;&amp; v + 1 &lt; r.length &amp;&amp; 56320 === (64512 &amp; r.charCodeAt(v + 1)) ? (A = 65536 + ((1023 &amp; A) &lt;&lt; 10) + (1023 &amp; r.charCodeAt(++v)), S[c++] = A &gt;&gt; 18 | 240, S[c++] = A &gt;&gt; 12 &amp; 63 | 128) : S[c++] = A &gt;&gt; 12 | 224, S[c++] = A &gt;&gt; 6 &amp; 63 | 128), S[c++] = 63 &amp; A | 128) &#125; for (var p = m, F = "" + String.fromCharCode(43) + String.fromCharCode(45) + String.fromCharCode(97) + ("" + String.fromCharCode(94) + String.fromCharCode(43) + String.fromCharCode(54)), D = "" + String.fromCharCode(43) + String.fromCharCode(45) + String.fromCharCode(51) + ("" + String.fromCharCode(94) + String.fromCharCode(43) + String.fromCharCode(98)) + ("" + String.fromCharCode(43) + String.fromCharCode(45) + String.fromCharCode(102)), b = 0; b &lt; S.length; b++) p += S[b], p = n(p, F); return p = n(p, D), p ^= s, 0 &gt; p &amp;&amp; (p = (2147483647 &amp; p) + 2147483648), p %= 1e6, p.toString() + "." + (p ^ m) &#125;]]></content>
      <categories>
        <category>Spider</category>
      </categories>
      <tags>
        <tag>js2py</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[çˆ¬è™«ä¹‹Httpåè®®]]></title>
    <url>%2F2018%2F03%2F21%2F%E7%88%AC%E8%99%AB%E4%B9%8BHttp%E5%8D%8F%E8%AE%AE%2F</url>
    <content type="text"><![CDATA[ä»€ä¹ˆæ˜¯HTTPåè®®ï¼ŸHttpåè®®ä¸“ä¸šç§°ä¹‹ä¸ºï¼šè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œå±žäºŽç½‘ç»œåè®®ä¸­åº”ç”¨å±‚çš„åè®®ï¼Œé»˜è®¤ç«¯å£æ˜¯80 HTTPè¯·æ±‚æ ¼å¼ æ¡ˆä¾‹ HTTPè¯·æ±‚æ–¹å¼HTTPè¯·æ±‚å¯ä»¥ä½¿ç”¨å¤šç§è¯·æ±‚æ–¹æ³• HTTP1.0å®šä¹‰äº†ä¸‰ç§è¯·æ±‚æ–¹æ³•ï¼šGET, POST, HEAD HTTP1.1ï¼ˆä¸»æµï¼‰æ–°å¢žäº†äº”ç§è¯·æ±‚æ–¹æ³•ï¼šOPTIONSï¼ŒPUTï¼ŒDELETEï¼ŒTRACEï¼ŒCONNECT è¯·æ±‚æ–¹å¼ æè¿° GET è¯·æ±‚æŒ‡å®šçš„é¡µé¢ä¿¡æ¯ï¼Œå¹¶è¿”å›žå®žä½“ä¸»ä½“ã€‚ HEAD ç±»ä¼¼äºŽgetè¯·æ±‚ï¼Œåªä¸è¿‡è¿”å›žçš„å“åº”ä¸­æ²¡æœ‰å…·ä½“çš„å†…å®¹ï¼Œç”¨äºŽèŽ·å–æŠ¥å¤´ POST å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚POSTè¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´æ–°çš„èµ„æºçš„å»ºç«‹å’Œ/æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹ã€‚ PUT ä»Žå®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€çš„æ•°æ®å–ä»£æŒ‡å®šçš„æ–‡æ¡£çš„å†…å®¹ã€‚ DELETE è¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šçš„é¡µé¢ã€‚ CONNECT HTTP/1.1åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿žæŽ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚ OPTIONS å…è®¸å®¢æˆ·ç«¯æŸ¥çœ‹æœåŠ¡å™¨çš„æ€§èƒ½ã€‚ TRACE å›žæ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºŽæµ‹è¯•æˆ–è¯Šæ–­ã€‚ å¸¸è§è¯·æ±‚å¤´ Cookie User-Agent æµè§ˆå™¨ä»£ç† Referer é˜²ç›—é“¾ï¼Œè¯·æ±‚æ¥è‡ªå“ªé‡Œ Host è¯·æ±‚ä¸»æœº Connection Accept HTTPå“åº”Httpå“åº”ç”±å››éƒ¨åˆ†ç»„æˆ çŠ¶æ€è¡Œï¼š HTTP/1.1 200 OK æ¶ˆæ¯æŠ¥æ–‡ï¼š Content-Type: text/htmlâ€¦.. ç©ºè¡Œå°±æ˜¯ï¼š æ¶ˆæ¯æŠ¥æ–‡å’Œæ­£æ–‡ä¸­é—´çš„ç©ºè¡Œ å“åº”æ­£æ–‡ï¼šå¤§å®¶åœ¨æµè§ˆå™¨çœ‹åˆ°çš„æ¸²æŸ“åŽçš„å†…å®¹ HTTPçŠ¶æ€ç å½“æµè§ˆè€…è®¿é—®ä¸€ä¸ªç½‘é¡µæ—¶ï¼Œæµè§ˆè€…çš„æµè§ˆå™¨ä¼šå‘ç½‘é¡µæ‰€åœ¨æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ã€‚å½“æµè§ˆå™¨æŽ¥æ”¶å¹¶æ˜¾ç¤ºç½‘é¡µå‰ï¼Œæ­¤ç½‘é¡µæ‰€åœ¨çš„æœåŠ¡å™¨ä¼šè¿”å›žä¸€ä¸ªåŒ…å«HTTPçŠ¶æ€ç çš„ä¿¡æ¯å¤´ï¼ˆserver headerï¼‰ç”¨ä»¥å“åº”æµè§ˆå™¨çš„è¯·æ±‚ã€‚ åˆ†ç±» åˆ†ç±»æè¿° 1** ä¿¡æ¯ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œéœ€è¦è¯·æ±‚è€…ç»§ç»­æ‰§è¡Œæ“ä½œ 2** æˆåŠŸï¼Œæ“ä½œè¢«æˆåŠŸæŽ¥æ”¶å¹¶å¤„ç† 3** é‡å®šå‘ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ“ä½œä»¥å®Œæˆè¯·æ±‚ 4** å®¢æˆ·ç«¯é”™è¯¯ï¼Œè¯·æ±‚åŒ…å«è¯­æ³•é”™è¯¯æˆ–æ— æ³•å®Œæˆè¯·æ±‚ 5** æœåŠ¡å™¨é”™è¯¯ï¼ŒæœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ å¸¸è§çš„HTTPçŠ¶æ€ç ï¼š 200 - è¯·æ±‚æˆåŠŸ 301 - èµ„æºï¼ˆç½‘é¡µç­‰ï¼‰è¢«æ°¸ä¹…è½¬ç§»åˆ°å…¶å®ƒURL 404 - è¯·æ±‚çš„èµ„æºï¼ˆç½‘é¡µç­‰ï¼‰ä¸å­˜åœ¨ 500 - å†…éƒ¨æœåŠ¡å™¨é”™è¯¯]]></content>
      <categories>
        <category>HTTP</category>
      </categories>
      <tags>
        <tag>Http</tag>
        <tag>Https</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[çˆ¬è™«å¼€ç¯‡]]></title>
    <url>%2F2018%2F03%2F20%2F%E7%88%AC%E8%99%AB%E5%BC%80%E7%AF%87%2F</url>
    <content type="text"><![CDATA[å½“ä»Šæ˜¯ä¸€ä¸ªå¤§æ•°æ®çš„æ—¶ä»£ï¼Œæ•°æ®ä¹Ÿå˜å¾—è¶Šæ¥è¶Šå€¼é’±ï¼Œæœ‰å¸‚åœºå°±æœ‰éœ€è¦ï¼Œâ€œçˆ¬è™«å·¥ç¨‹å¸ˆâ€å°±æ­¤è¯žç”Ÿï½žä»Žæ­¤å¼€å§‹å­¦ä¹  Spiderï¼Œå¼€è´´è®°å½•ä¸€ä¸‹è‡ªå·±çš„å­¦ä¹ ç»åŽ†, Fighting ä»€ä¹ˆæ˜¯çˆ¬è™«ï¼Ÿæ‰€è°“çš„çˆ¬è™«å…¶å®žå°±æ˜¯æ¨¡æ‹Ÿæµè§ˆå™¨å‘é€ç½‘ç»œè¯·æ±‚ï¼ŒæŽ¥æ”¶è¯·æ±‚å“åº”ï¼ŒæŒ‰ç…§ä¸€å®šçš„è§„åˆ™è‡ªåŠ¨çš„åŽ»èŽ·å–ç½‘ç»œä¸Šçš„ä¿¡æ¯ çˆ¬è™«åˆ†ä¸ºå“ªäº›ä»Žç½‘ä¸Šç®€å•çš„äº†è§£ï¼Œçˆ¬è™«ä¸»è¦åˆ†ä¸ºé€šç”¨çˆ¬è™«ï¼ˆæœç´¢å¼•æ“Žçˆ¬è™«ï¼Œå…¸åž‹çš„å°±æ˜¯ç™¾åº¦&amp;Googleï¼‰å’Œèšç„¦çˆ¬è™«ï¼ˆçˆ¬ä¸€äº›æŒ‡å®šçš„ç½‘ç«™ï¼‰ ç®€å•çš„çˆ¬è™«æµç¨‹ 1ã€æŠ“åˆ°èµ·å§‹çš„urlï¼ŒèŽ·å–å“åº” 2ã€å¯¹å“åº”å†æ¬¡å‘é€è¯·æ±‚ 3ã€å¦‚æžœèƒ½ä»Žå“åº”ä¸­æå–URLï¼Œåˆ™ç»§ç»­å‘é€è¯·æ±‚èŽ·å–å“åº” 4ã€å¦‚æžœæå–æ•°æ®ï¼Œåˆ™å°†æ•°æ®è¿›è¡Œä¿å­˜]]></content>
      <categories>
        <category>Spider</category>
      </categories>
      <tags>
        <tag>Spider</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Pythoné¢è¯•é¢˜ï¼šPythonæ“ä½œExcel]]></title>
    <url>%2F2018%2F03%2F19%2FPython%E9%9D%A2%E8%AF%95%E9%A2%98%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9APython%E6%93%8D%E4%BD%9CExcel%2F</url>
    <content type="text"><![CDATA[å‰å‡ å¤©å¸®æœ‹å‹åšäº†ä¸€é“é¢è¯•é¢˜ï¼Œæ„Ÿè§‰ç”¨Pythonåšèµ·æ¥ä¼šæ–¹ä¾¿å¾ˆå¤šï¼Œè¯ä¸å¤šè¯´ä¸Šå›¾ ä¸€ã€æ¨¡å—ä»‹ç»Pythonç¤¾åŒºçš„å¼ºå¤§å’Œæ´»è·ƒï¼Œä¹Ÿä¸ºPythonæˆä¸ºä¸»æµè¯­è¨€å¥ å®šäº†åŸºç¡€ï¼Œä¸°å¯Œçš„ç¬¬ä¸‰æ–¹åº“ä½¿ä¸€åˆ‡å˜æˆäº†å¯èƒ½ï¼Œä¸»è¦ä½¿ç”¨Pythonçš„ä¸¤ä¸ªæ¨¡å— xlrdå’Œxlwt æ¨¡å—ï¼Œé¡¾åæ€ä¹‰xlrdæ˜¯è¯»excelï¼Œxlwtæ˜¯ç”¨æ¥å†™excelçš„åº“ï¼Œå¦å¤–è¿™ä¸¤ä¸ªåº“ä¸æ˜¯Pythonå†…ç½®çš„æ¨¡å—éœ€è¦è‡ªè¡Œå®‰è£…ã€‚å»ºè®®ä½¿ç”¨ pip æ¥è¿›è¡Œå®‰è£… 12# -i å¯ä»¥æŒ‡å®šä¸‹è½½çš„æºåœ°å€ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨çš„å›½å¤–çš„æºæ¯”è¾ƒæ…¢pip install xlrd -i https://pypi.douban.com/simple/ äºŒã€è§£å†³é¢˜ç›®çš„æ€è·¯ 1ã€è¦èŽ·å–excelè¡¨æ ¼é‡Œé¢çš„æ•°æ® 2ã€èŽ·å–åˆ°æ¯ä¸€è¡Œçš„æ•°æ®ï¼Œç„¶åŽæ‹¼æŽ¥æˆå­—å…¸ 3ã€æŠŠæ¯ä¸€è¡Œæ‹¼æŽ¥çš„å­—å…¸æ”¾åˆ°åˆ—è¡¨å½“ä¸­ çœ‹ç€æ˜¯ä¸æ˜¯å¾ˆå®¹æ˜“ï¼Œä½†æ˜¯å¦‚æžœä¸ç†Ÿæ‚‰xlrdçš„è¯­æ³•æ“ä½œèµ·æ¥ä¹Ÿæ˜¯å¾ˆå›°éš¾çš„ï¼Œä¸‹é¢å°±ç½—åˆ—ä¸€ä¸‹åŸºæœ¬ä½¿ç”¨ èŽ·å–Excelæ–‡ä»¶å¯¹è±¡1data = xlrd.open_workbook(filename)#æ–‡ä»¶åä»¥åŠè·¯å¾„ï¼Œå¦‚æžœè·¯å¾„æˆ–è€…æ–‡ä»¶åæœ‰ä¸­æ–‡ç»™å‰é¢åŠ ä¸€ä¸ªråŽŸç”Ÿå­—ç¬¦ã€‚ å¸¸ç”¨çš„æ“ä½œ 1ã€èŽ·å–dataä¸­æŸä¸€ä¸ªå·¥ä½œè¡¨ï¼ˆsheetï¼‰ 12345table = data.sheets()[0] # é€šè¿‡ç´¢å¼•é¡ºåºèŽ·å–table = data.sheet_by_index(sheet_indx)) #é€šè¿‡ç´¢å¼•é¡ºåºèŽ·å–table = data.sheet_by_name(sheet_name)#é€šè¿‡åç§°èŽ·å– 2ã€è¡Œçš„æ“ä½œ 1234567891011nrows = table.nrows # èŽ·å–è¯¥sheetä¸­çš„æœ‰æ•ˆè¡Œæ•°table.row(rowx) #è¿”å›žç”±è¯¥è¡Œä¸­æ‰€æœ‰çš„å•å…ƒæ ¼å¯¹è±¡ç»„æˆçš„åˆ—è¡¨table.row_slice(rowx) #è¿”å›žç”±è¯¥åˆ—ä¸­æ‰€æœ‰çš„å•å…ƒæ ¼å¯¹è±¡ç»„æˆçš„åˆ—è¡¨table.row_types(rowx, start_colx=0, end_colx=None) #è¿”å›žç”±è¯¥è¡Œä¸­æ‰€æœ‰å•å…ƒæ ¼çš„æ•°æ®ç±»åž‹ç»„æˆçš„åˆ—è¡¨table.row_values(rowx, start_colx=0, end_colx=None) #è¿”å›žç”±è¯¥è¡Œä¸­æ‰€æœ‰å•å…ƒæ ¼çš„æ•°æ®ç»„æˆçš„åˆ—è¡¨table.row_len(rowx) #è¿”å›žè¯¥åˆ—çš„æœ‰æ•ˆå•å…ƒæ ¼é•¿åº¦ 3ã€åˆ—çš„æ“ä½œ 123456789ncols = table.ncols #èŽ·å–åˆ—è¡¨çš„æœ‰æ•ˆåˆ—æ•°table.col(colx, start_rowx=0, end_rowx=None) #è¿”å›žç”±è¯¥åˆ—ä¸­æ‰€æœ‰çš„å•å…ƒæ ¼å¯¹è±¡ç»„æˆçš„åˆ—è¡¨table.col_slice(colx, start_rowx=0, end_rowx=None) #è¿”å›žç”±è¯¥åˆ—ä¸­æ‰€æœ‰çš„å•å…ƒæ ¼å¯¹è±¡ç»„æˆçš„åˆ—è¡¨table.col_types(colx, start_rowx=0, end_rowx=None) #è¿”å›žç”±è¯¥åˆ—ä¸­æ‰€æœ‰å•å…ƒæ ¼çš„æ•°æ®ç±»åž‹ç»„æˆçš„åˆ—è¡¨table.col_values(colx, start_rowx=0, end_rowx=None) #è¿”å›žç”±è¯¥åˆ—ä¸­æ‰€æœ‰å•å…ƒæ ¼çš„æ•°æ®ç»„æˆçš„åˆ—è¡¨ 4ã€å•å…ƒæ ¼çš„æ“ä½œ 1234567table.cell(rowx,colx) #è¿”å›žå•å…ƒæ ¼å¯¹è±¡table.cell_type(rowx,colx) #è¿”å›žå•å…ƒæ ¼ä¸­çš„æ•°æ®ç±»åž‹table.cell_value(rowx,colx) #è¿”å›žå•å…ƒæ ¼ä¸­çš„æ•°æ®table.cell_xf_index(rowx, colx) # æš‚æ—¶è¿˜æ²¡æœ‰æžæ‡‚ ä¸‰ã€ä»£ç å¥‰ä¸Š â€”â€”&gt;So simple1234567891011121314151617181920212223242526272829# å¯¼å…¥æ¨¡å—import xlrd def Execl2List(): # 1.èŽ·å–è¡¨æ ¼ excel = xlrd.open_workbook(r"./lianxi.xlsx") # 2.èŽ·å–Sheet1è¡¨æ ¼é¡µ sheet = excel.sheet_by_name("Sheet1") # 3.èŽ·å–å½“å‰é¡µçš„è¡Œæ•° row = sheet.nrows lists = [] for i in range(1, row): dic = &#123;&#125; list = sheet.row_values(i) # èŽ·å–è¡¨æ ¼å¯¹åº”è¡Œçš„æ•°æ® dic["å§“å"] = list[0] dic["å¹´é¾„"] = list[1] dic["æ€§åˆ«"] = list[2] lists.append(dic) return listsif __name__ == '__main__': data = Execl2List() print(data)]]></content>
      <categories>
        <category>Interview-Questions</category>
      </categories>
      <tags>
        <tag>Excel</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Pythonç¼–ç¨‹ä¹‹çº¿ç¨‹æ± ]]></title>
    <url>%2F2018%2F01%2F27%2FPython%E7%BC%96%E7%A8%8B%E4%B9%8B%E7%BA%BF%E7%A8%8B%E6%B1%A0%2F</url>
    <content type="text"><![CDATA[ä½œç”¨ è®¡ç®—æœºæ¯æ¬¡åˆ›å»ºçº¿ç¨‹å’Œé”€æ¯çº¿ç¨‹éœ€è¦é¢å¤–å ç”¨èµ„æºï¼Œé¢‘ç¹åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹ä¼šå¯¼è‡´è®¡ç®—æœºæ€§èƒ½ä¸‹é™ å¤„ç†è¿‡ç¨‹ ä¼˜ç‚¹ é‡å¤åˆ©ç”¨çº¿ç¨‹ï¼Œå‡å°‘å› ä¸ºåˆ›å»ºçº¿ç¨‹å’Œé”€æ¯çº¿ç¨‹å¸¦æ¥ä¸å¿…è¦çš„æ€§èƒ½é”€æ¯ è®©ç¨‹åºæ›´åŠ çš„ç¨³å®šï¼Œä¸ä¼šå› ä¸ºåŒä¸€æ—¶é—´åˆ›å»ºçº¿ç¨‹è¿‡å¤šè€Œå¯¼è‡´å†…å­˜ä¸å¤Ÿä½¿ç¨‹åºå¼•å‘ç³»ç»Ÿä¸€ç³»åˆ—çš„é—®é¢˜ ä»£ç å®žçŽ°æµç¨‹ 1ã€å¯¼å…¥çº¿ç¨‹æ± æ¨¡å— 1from multiprocessing.dummy import Pool 2ã€åˆ›å»ºçº¿ç¨‹æ±  1pools = Pool(5) 3ã€å®šä¹‰çº¿ç¨‹æ± è¦æ‰§è¡Œçš„ä»»åŠ¡ 12def exec_task(): print('---è¦æ‰§è¡Œçš„ä»»åŠ¡---') 4ã€ä»»åŠ¡å®Œæˆçš„å›žè°ƒå‡½æ•° 12def exec_task_finish(self, result): print('æ‰§è¡Œä»»åŠ¡å®Œæˆå›žè°ƒå‡½æ•°') æ³¨æ„å›žè°ƒå‡½æ•°å¿…é¡»è¦æœ‰resultå‚æ•°ï¼Œresultå‚æ•°è¡¨ç¤ºæ‰§è¡Œä»»åŠ¡ä»£ç çš„è¿”å›žå€¼ 5ã€çº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡ 1pools.apply_async(self.exec_task,callback=self.exec_task_finish) æ‰©å±•è¿›ç¨‹æ±  12# å¯¼å…¥è¿›ç¨‹æ± åº“from multiprocessing import Pool åç¨‹æ±  12345# æ‰“è¡¥ä¸import gevent.monkeygevent.monkey.patch_all()# å¯¼å…¥åç¨‹æ± åº“from gevent.pool import Pool å¤‡æ³¨ï¼Œé»˜è®¤çº¿ç¨‹æ± é‡Œé¢çš„çº¿ç¨‹æ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Œè¿›ç¨‹æ± &amp;åç¨‹æ± åŒç†]]></content>
      <categories>
        <category>Python-Concurrent</category>
      </categories>
      <tags>
        <tag>çº¿ç¨‹æ± </tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Pythonç¼–ç¨‹ä¹‹å­—å…¸å¸¸ç”¨æ–¹æ³•]]></title>
    <url>%2F2017%2F12%2F24%2FPython%E7%BC%96%E7%A8%8B%E4%B9%8B%E5%AD%97%E5%85%B8%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[å­—å…¸æ˜¯Pythonå†…ç½®çš„æ•°æ®ç±»åž‹ï¼Œä¹Ÿæ˜¯æœ€å¸¸è§çš„æ•°æ®ç»“æž„ã€‚æœ¬æ–‡è®°å½•ä¸€ä¸‹å­—å…¸ä½¿ç”¨çš„æ—¶å€™ç»å¸¸ä¼šé‡åˆ°çš„APIè¯­æ³•ã€‚ å­—å…¸å–å€¼1ã€é€šè¿‡keyå–value12345678data = &#123;'age': 18, 'name': 'qiangzai'&#125;# é€šè¿‡keyå–valuev1 = data['age']print(v1) # 18# å¦‚æžœkeyä¸å­˜åœ¨æŠ¥é”™KeyErrordata['gender'] # KeyError: 'gender' 2ã€é€šè¿‡getæ–¹å¼12345678910data = &#123;'age': 18, 'name': 'qiangzai'&#125;v1 = data.get('age')print(v1) # 18v2 = data.get('gender')print(v2) # Nonev3 = data.get('gender', 'ç”·')print(v3) # ç”· æ€»ç»“ï¼šé€šè¿‡getå–å€¼ä¸ä¼šæŠ¥é”™ï¼Œå¦‚æžœä¸å­˜åœ¨å¯ä»¥æŒ‡å®šé»˜è®¤å€¼ï¼Œä¸æŒ‡å®šé»˜è®¤å€¼ä¸º None 3ã€é€šè¿‡setdefaultæ–¹å¼123456789101112data = &#123;'age': 18, 'name': 'qiangzai'&#125;v1 = data.setdefault('age')print(v1) # 18v2 = data.setdefault('gender')print(v2) # Noneprint(data) # &#123;'age': 18, 'name': 'qiangzai', 'gender': None&#125;v3 = data.setdefault('score', 100)print(v3) # 100print(data) # &#123;'age': 18, 'name': 'qiangzai', 'gender': None, 'score': 100&#125; æ€»ç»“ï¼šé€šè¿‡sedefaultå–å€¼ä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œå¦‚æžœä¸å­˜åœ¨ä¼šè¿”å›žé»˜è®¤å€¼å¹¶ç»™å­—å…¸æ·»åŠ é”®å€¼å¯¹ åˆ é™¤å­—å…¸å…ƒç´ 1ã€del123456789data = &#123;'age': 18, 'name': 'qiangzai', 'gender': None, 'score': 100&#125;# é€šè¿‡keyåˆ é™¤å¯¹åº”çš„é”®å€¼å¯¹del data['gender']print(data) # &#123;'age': 18, 'name': 'qiangzai', 'score': 100&#125;# åˆ é™¤æ•´ä¸ªå­—å…¸del dataprint(data) # NameError: name 'data' is not defined æ€»ç»“ï¼šdel å¯ä»¥åˆ é™¤æŒ‡å®šçš„é”®å€¼å¯¹,å¦‚æžœkeyä¸å­˜åœ¨ä¼šæŠ¥é”™ KeyErrorï¼Œå¯ä»¥åˆ é™¤æ•´ä¸ªå­—å…¸ 2ã€clear1234data = &#123;'age': 18, 'name': 'qiangzai', 'gender': None, 'score': 100&#125;data.clear()print(data) # &#123;&#125; æ€»ç»“ï¼šclearæ¸…ç©ºæ•´ä¸ªå­—å…¸ 3ã€pop123data = &#123;'age': 18, 'name': 'qiangzai', 'gender': None, 'score': 100&#125;score = data.pop('score')print(score) # 100 æ€»ç»“ï¼špopé€šè¿‡keyåˆ é™¤valueå¹¶è¿”å›žåˆ é™¤çš„valueå€¼ï¼Œå¯ä»¥ç”¨å˜é‡æŽ¥æ”¶ ä¿®æ”¹å­—å…¸1ã€é€šè¿‡keyä¿®æ”¹1234data = &#123;'age': 18, 'name': 'qiangzai', 'gender': None, 'score': 100&#125;data['age'] = 20print(data) # &#123;'age': 20, 'name': 'qiangzai', 'gender': None, 'score': 100&#125; 2ã€update1234data = &#123;'age': 18, 'name': 'qiangzai', 'gender': None, 'score': 100&#125;data.update(&#123;'name': 'LQ', 'class': 'Python'&#125;)print(data) # &#123;'age': 20, 'name': 'LQ', 'gender': None, 'score': 100, 'class': 'Python'&#125; æ€»ç»“ï¼šupdateä¼šåˆå¹¶å­—å…¸åˆ°dataï¼Œå¦‚æžœdataä¸­çš„keyå­˜åœ¨å°±ä¿®æ”¹keyå¯¹åº”çš„value å­—å…¸çš„ä¸€äº›å†…ç½®æ–¹æ³•12345678# è¿”å›žä¸€ä¸ªå­—å…¸çš„æµ…å¤åˆ¶data.copy() # åˆ›å»ºä¸€ä¸ªæ–°å­—å…¸ï¼Œä»¥åºåˆ—seqä¸­å…ƒç´ åšå­—å…¸çš„é”®ï¼Œvalä¸ºå­—å…¸æ‰€æœ‰é”®å¯¹åº”çš„åˆå§‹å€¼data.fromkeys(['age', 'name', 'gender'])# ä»¥åˆ—è¡¨è¿”å›žå¯éåŽ†çš„(é”®, å€¼) å…ƒç»„æ•°ç»„data.items()# ä»¥åˆ—è¡¨è¿”å›žä¸€ä¸ªå­—å…¸æ‰€æœ‰çš„é”®data.keys()]]></content>
      <categories>
        <category>Python-Basis</category>
      </categories>
      <tags>
        <tag>dict</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Pythonç¼–ç¨‹ä¹‹é˜Ÿåˆ—Queue]]></title>
    <url>%2F2017%2F11%2F27%2FPython%E7%BC%96%E7%A8%8B%E4%B9%8B%E9%98%9F%E5%88%97Queue%2F</url>
    <content type="text"><![CDATA[Queue Queueæ˜¯Pythonæ ‡å‡†åº“ä¸­çš„çº¿ç¨‹å®‰å…¨çš„é˜Ÿåˆ—(FIFO)å®žçŽ°ï¼Œæä¾›äº†ä¸€ä¸ªé€‚ç”¨äºŽå¤šçº¿ç¨‹ç¼–ç¨‹çš„å…ˆè¿›å…ˆå‡ºçš„æ•°æ®ç»“æž„ï¼Œå³é˜Ÿåˆ—ï¼Œç”¨æ¥åœ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´çš„ä¿¡æ¯ä¼ é€’ã€‚ äºŒç§é˜Ÿåˆ—å½¢å¼ FIFOé˜Ÿåˆ—FIFOå³First in First Outï¼Œå…ˆè¿›å…ˆå‡ºã€‚Queueæä¾›äº†ä¸€ä¸ªåŸºæœ¬çš„FIFOå®¹å™¨ï¼Œä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ã€‚ å‚æ•°ï¼šmaxsizeæ˜¯ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡æ˜Žäº†é˜Ÿåˆ—ä¸­èƒ½å­˜æ”¾çš„æ•°æ®ä¸ªæ•°çš„ä¸Šé™ã€‚ä¸€æ—¦è¾¾åˆ°ä¸Šé™ï¼Œæ’å…¥ä¼šå¯¼è‡´å µå¡žï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­çš„æ•°æ®è¢«æ¶ˆè´¹æŽ‰ã€‚ æ¡ˆä¾‹ åˆ›å»ºé˜Ÿåˆ— 12from queue import Queueq = Queue(maxsize=3) å­˜å–æ•°æ® 1234# å­˜æ”¾æ•°æ®q.put('aaa')# èŽ·å–æ•°æ®q.get() LIFOé˜Ÿåˆ—LIFOå³Last in First Out,åŽè¿›å…ˆå‡ºã€‚ä¸Žæ ˆçš„ç±»ä¼¼ï¼Œä½¿ç”¨ä¹Ÿå¾ˆç®€å•,maxsizeç”¨æ³•åŒä¸Š åˆ›å»ºé˜Ÿåˆ— 12from queue import LifoQueueq = LifoQueue() å­˜æ”¾æ•°æ®APIè¯­æ³•åŒä¸Š å¸¸ç”¨æ–¹æ³• task_done() å‘Šè¯‰é˜Ÿåˆ—è¯¥ä»»åŠ¡å·²ç»å¤„ç†å®Œæ¯•ï¼Œé˜Ÿåˆ—çš„unfinished_tasksçš„å±žæ€§-1 join() å µå¡žè°ƒç”¨çº¿ç¨‹ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ä»»åŠ¡è¢«å¤„ç†å®Œæ¯•ï¼Œä¸€æ—¦æœ‰æ•°æ®è¢«åŠ å…¥é˜Ÿåˆ—ï¼Œæœªå®Œæˆçš„ä»»åŠ¡æ•°å°±ä¼šå¢žåŠ ã€‚å½“æ¶ˆè´¹è€…çº¿ç¨‹è°ƒç”¨task_done()ï¼ˆæ„å‘³ç€æœ‰æ¶ˆè´¹è€…å–å¾—ä»»åŠ¡å¹¶å®Œæˆä»»åŠ¡ï¼‰ï¼Œæœªå®Œæˆçš„ä»»åŠ¡æ•°å°±ä¼šå‡å°‘ã€‚å½“æœªå®Œæˆçš„ä»»åŠ¡æ•°é™åˆ°0ï¼ˆå†…éƒ¨å°±æ˜¯å½“é˜Ÿåˆ—çš„unfinished_taskså±žæ€§ä¸º0æ—¶ï¼‰ï¼Œjoin()è§£é™¤é˜»å¡žã€‚ put(item[, block[, timeout]]) å°†itemæ”¾å…¥é˜Ÿåˆ—ä¸­ã€‚ å¦‚æžœå¯é€‰çš„å‚æ•°blockä¸ºTrueä¸”timeoutä¸ºç©ºå¯¹è±¡ï¼ˆé»˜è®¤çš„æƒ…å†µï¼Œé˜»å¡žè°ƒç”¨ï¼Œæ— è¶…æ—¶ï¼‰ã€‚ å¦‚æžœtimeoutæ˜¯ä¸ªæ­£æ•´æ•°ï¼Œé˜»å¡žè°ƒç”¨è¿›ç¨‹æœ€å¤štimeoutç§’ï¼Œå¦‚æžœä¸€ç›´æ— ç©ºç©ºé—´å¯ç”¨ï¼ŒæŠ›å‡ºFullå¼‚å¸¸ï¼ˆå¸¦è¶…æ—¶çš„é˜»å¡žè°ƒç”¨ï¼‰ã€‚ å¦‚æžœblockä¸ºFalseï¼Œå¦‚æžœæœ‰ç©ºé—²ç©ºé—´å¯ç”¨å°†æ•°æ®æ”¾å…¥é˜Ÿåˆ—ï¼Œå¦åˆ™ç«‹å³æŠ›å‡ºFullå¼‚å¸¸ get() ä»Žé˜Ÿåˆ—ä¸­ç§»é™¤å¹¶è¿”å›žä¸€ä¸ªæ•°æ®ã€‚blockè·Ÿtimeoutå‚æ•°åŒputæ–¹æ³• å…¶éžé˜»å¡žæ–¹æ³•ä¸ºï½€get_nowait()ï½€ç›¸å½“ä¸Žget(False) empty() å¦‚æžœé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å›žTrueï¼Œåä¹‹è¿”å›žFalse]]></content>
      <categories>
        <category>Python-Standard-Library</category>
      </categories>
      <tags>
        <tag>Queue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Pythonç¼–ç¨‹ä¹‹çº¿ç¨‹å®ˆæŠ¤å’Œçº¿ç¨‹åŒæ­¥é—®é¢˜]]></title>
    <url>%2F2017%2F11%2F26%2FPython%E7%BC%96%E7%A8%8B%E4%B9%8B%E7%BA%BF%E7%A8%8B%E5%AE%88%E6%8A%A4%E5%92%8C%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5%E9%97%AE%E9%A2%98%2F</url>
    <content type="text"><![CDATA[ä»€ä¹ˆæ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Ÿä»€ä¹ˆæ˜¯éžå®ˆæŠ¤çº¿ç¨‹ï¼Ÿä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥ï¼Ÿ ç›®æ ‡ï¼šæžæ‡‚Pythonä¸­çš„ä¸Šé¢ä¸‰ä¸ªé—®é¢˜ éžå®ˆæŠ¤çº¿ç¨‹ çº¿ç¨‹æ¦‚å¿µå½“ä¸€ä¸ªè¿›ç¨‹å¯åŠ¨ä»¥åŽï¼Œé»˜è®¤ä¼šäº§ç”Ÿä¸€ä¸ªä¸»çº¿ç¨‹ï¼Œå› ä¸ºçº¿ç¨‹æ˜¯ç¨‹åºæ‰§è¡Œçš„æœ€å°å•ä½ï¼Œåœ¨Pythonå½“ä¸­çº¿ç¨‹é»˜è®¤æƒ…å†µä¸‹å°±æ˜¯setDaemon(False)ï¼ˆéžå®ˆæŠ¤çº¿ç¨‹ï¼‰,ä¹Ÿå°±æ˜¯ä¸»çº¿ç¨‹æ‰§è¡Œå®Œè‡ªå·±çš„ä»»åŠ¡é€€å‡ºä»¥åŽï¼Œå­çº¿ç¨‹ä¼šç»§ç»­æ‰§è¡Œè‡ªå·±çš„ä»»åŠ¡ï¼Œä¸ä¼šéšä¸»çº¿ç¨‹é€€å‡ºå—å½±å“ æ¡ˆä¾‹1234567891011121314151617import threadingimport timedef run(): time.sleep(2) # å»¶æ—¶ç­‰å¾…2s print('---å­çº¿ç¨‹ç»“æŸæ‰§è¡Œ---')def main(): t1 = threading.Thread(target=run) t1.start() print('---ä¸»çº¿ç¨‹ç»“æŸæ‰§è¡Œ---')if __name__ == '__main__': main() è¾“å‡º 12---ä¸»çº¿ç¨‹ç»“æŸæ‰§è¡Œ------å­çº¿ç¨‹ç»“æŸæ‰§è¡Œ--- æ€»ç»“:éžå®ˆæŠ¤çº¿ç¨‹ï¼Œå­çº¿ç¨‹ä¸éšä¸»çº¿ç¨‹ç»“æŸè€Œç«‹é©¬ç»“æŸï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œ å®ˆæŠ¤çº¿ç¨‹ å½“å®ˆæŠ¤çº¿ç¨‹æ—¶ï¼Œå­çº¿ç¨‹ä¼šå®ˆæŠ¤ä¸»çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹ä¸€æ—¦é€€å‡ºï¼Œå…¨éƒ¨å­çº¿ç¨‹éƒ½ä¼šè¢«å¼ºåˆ¶ç»ˆæ­¢ æ¡ˆä¾‹123456789101112131415161718import threadingimport timedef run(): time.sleep(2) print('---å­çº¿ç¨‹ç»“æŸ---')def main(): t1 = threading.Thread(target=run) t1.setDaemon(True) # è®¾ç½®å­çº¿ç¨‹å®ˆæŠ¤ä¸»çº¿ç¨‹ t1.start() print('---ä¸»çº¿ç¨‹ç»“æŸ---')if __name__ == '__main__': main() è¾“å‡º 1---ä¸»çº¿ç¨‹ç»“æŸ--- çº¿ç¨‹åŒæ­¥ çº¿ç¨‹åŒæ­¥å°±æ˜¯è®©çº¿ç¨‹å¤„äºŽå µå¡žçŠ¶æ€ï¼Œç­‰å¾…å­çº¿ç¨‹æ‰§è¡Œä»¥åŽä¸»çº¿ç¨‹å†æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥è®¾ç½®å µå¡žæ—¶é—´ æ¡ˆä¾‹ï¼ˆä¸»çº¿ç¨‹å µå¡žï¼Œç­‰å¾…å­çº¿ç¨‹ç»“æŸä»¥åŽå†æ‰§è¡Œï¼‰123456789101112131415161718import threadingimport timedef run(): time.sleep(2) print('---å­çº¿ç¨‹ç»“æŸ---')def main(): t1 = threading.Thread(target=run) t1.start() t1.join() # ä¸»çº¿ç¨‹å µå¡ž print('---ä¸»çº¿ç¨‹ç»“æŸ---')if __name__ == '__main__': main() è¾“å‡º 12---å­çº¿ç¨‹ç»“æŸ------ä¸»çº¿ç¨‹ç»“æŸ--- æ¡ˆä¾‹ï¼ˆä¸»çº¿ç¨‹å µå¡ž1sï¼Œä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œï¼‰123456789101112131415161718import threadingimport timedef run(): time.sleep(2) print('---å­çº¿ç¨‹ç»“æŸ---')def main(): t1 = threading.Thread(target=run) t1.start() t1.join(timeout=1) # ä¸»çº¿ç¨‹å µå¡ž1s print('---ä¸»çº¿ç¨‹ç»“æŸ---')if __name__ == '__main__': main() è¾“å‡º 12---ä¸»çº¿ç¨‹ç»“æŸ------å­çº¿ç¨‹ç»“æŸ--- æ¡ˆä¾‹ï¼ˆä¸»çº¿ç¨‹å µå¡ž1sï¼Œç„¶åŽå®ˆæŠ¤ä¸»çº¿ç¨‹ï¼‰12345678910111213141516171819import threadingimport timedef run(): time.sleep(2) print('---å­çº¿ç¨‹ç»“æŸ---')def main(): t1 = threading.Thread(target=run) t1.setDaemon(True) # å®ˆæŠ¤ä¸»çº¿ç¨‹ t1.start() t1.join(timeout=1) # ä¸»çº¿ç¨‹å µå¡ž1s print('---ä¸»çº¿ç¨‹ç»“æŸ---')if __name__ == '__main__': main() è¾“å‡º 1---ä¸»çº¿ç¨‹ç»“æŸ--- ä¸»çº¿ç¨‹ç­‰å¾…1såŽä¸»çº¿ç¨‹ç»“æŸï¼Œå­çº¿ç¨‹éšç€ä¸»çº¿ç¨‹ç»“æŸè€Œç»“æŸ æ€»ç»“ 1ã€ä¸ºäº†ä¿è¯ç¨‹åºèƒ½å¤Ÿæ­£å¸¸çš„è¿è¡Œï¼Œä¸»çº¿ç¨‹/ä¸»è¿›ç¨‹éƒ½ä¼šç­‰æ‰€æœ‰çš„å­è¿›ç¨‹/å­çº¿ç¨‹æ‰§è¡Œå®Œæˆä»¥åŽå†é”€æ¯ã€‚ 2ã€å½“ä¸»è¿›ç¨‹å†…éƒ¨éžå®ˆæŠ¤è¿›ç¨‹å’Œå®ˆæŠ¤è¿›ç¨‹åŒæ—¶å­˜åœ¨æ—¶ ä¸»è¿›ç¨‹æ‰§è¡Œç»“æŸä»¥åŽä¼šå…ˆå¼ºåˆ¶é€€å‡ºå®ˆæŠ¤è¿›ç¨‹ï¼Œå†ç­‰éžå®ˆæŠ¤è¿›ç¨‹ç»“æŸä»¥åŽå†é”€æ¯ 3ã€å½“ä¸»çº¿ç¨‹å†…éƒ¨éžå®ˆæŠ¤çº¿ç¨‹å’Œå®ˆæŠ¤çº¿ç¨‹åŒæ—¶å­˜åœ¨æ—¶ ä¸»çº¿ç¨‹æ‰§è¡Œç»“æŸä»¥åŽä¼šå…ˆç­‰å¾…æ‰€æœ‰çš„éžå®ˆæŠ¤çº¿ç¨‹ç»“æŸï¼Œå†å¼ºåˆ¶é€€å‡ºå®ˆæŠ¤çº¿ç¨‹ï¼Œæœ€åŽé”€æ¯]]></content>
      <categories>
        <category>Python-Concurrent</category>
      </categories>
      <tags>
        <tag>çº¿ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®°å½•ä¹‹ubuntu16.04å®‰è£…æœç‹—è¾“å…¥æ³•]]></title>
    <url>%2F2017%2F11%2F26%2F%E8%AE%B0%E5%BD%95%E4%B9%8Bubuntu16-04%E5%AE%89%E8%A3%85%E6%90%9C%E7%8B%97%E8%BE%93%E5%85%A5%E6%B3%95%2F</url>
    <content type="text"><![CDATA[è‡ªå·±æœ¬åœ°æŠ˜è…¾äº†ä¸€ä¸ª ubuntuçš„desktopç‰ˆçš„è™šæ‹Ÿæœºï¼Œè£…å®Œè£¸æœºä¸€ä¸ªï¼Œå•¥ä¹Ÿæ²¡æœ‰ã€‚æœ¬æ–‡ä»‹ç»ä¸€ä¸‹è‡ªå·±è¾“å…¥æ³•ï¼ˆæœç‹—ï¼‰çš„å®‰è£…æ­¥éª¤ï¼Œç½‘ä¸Šæ•™ç¨‹ä¸€å †ä½†æ˜¯å¾ˆå¤šéƒ½æœ‰é—®é¢˜ 1ã€æ›´æ–°è½¯ä»¶æº1.1ã€æ‰“å¼€æ–‡ä»¶1sudo gedit /etc/apt/sources.list 1.2ã€åœ¨æ–‡ä»¶å¼€å¤´æ·»åŠ ä¸‹é¢çš„é˜¿é‡Œäº‘çš„è½¯ä»¶æº12345678910deb http://mirrors.aliyun.com/ubuntu/ quantal main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ quantal-security main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ quantal-updates main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ quantal-proposed main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ quantal-backports main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ quantal main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ quantal-security main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ quantal-updates main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ quantal-proposed main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ quantal-backports main restricted universe multiverse 1.3ã€æ›´æ–°è½¯ä»¶æº1sudo apt-get update 2ã€å®‰è£…è¾“å…¥æ³•2.1ã€ä¸‹è½½æœç‹—è¾“å…¥æ³•å®‰è£…åŒ…æœç‹—è¾“å…¥æ³•Linuxç‰ˆä¸‹è½½åœ°å€ 2.2ã€å®‰è£…12sudo apt-get install -fsudo dpkg -i sogoupinyin_2.0.0.0072_amd64.deb # debæ–‡ä»¶è¦å’Œè‡ªå·±ä¸‹è½½çš„ç‰ˆæœ¬ä¸€è‡´ 2.3è®¾ç½®è¯­è¨€é€‰é¡¹åˆ°ç³»ç»Ÿè®¾ç½®-&gt;è¯­è¨€æ”¯æŒï¼ˆSystem-&gt;Language Supportï¼‰ï¼Œå°†é”®ç›˜è¾“å…¥æ³•ç³»ç»Ÿç”±é»˜è®¤çš„iBusè®¾ç½®ä¸ºfcitxã€‚å¦‚ä¸‹å›¾ï¼š 2.4 é‡å¯æˆ‘çš„é‡å¯ä»¥åŽç›´æŽ¥ç‚¹å³ä¸Šè§’è¾“å…¥æ³•å›¾æ ‡å°±å¯ä»¥çœ‹åˆ°äº†ï¼Œç½‘ä¸Šæœ‰çš„æ•™ç¨‹è¿˜éœ€è¦åŽ»è¾“å…¥æ³•è®¾ç½®é‡Œé¢æ·»åŠ sougou 3ã€å®‰è£… fcitxé”®ç›˜è¾“å…¥æ³•ç³»ç»Ÿsogouæ˜¯åŸºäºŽfcitxçš„ï¼Œè€Œç³»ç»Ÿé»˜è®¤çš„é”®ç›˜è¾“å…¥æ³•ç³»ç»Ÿæ˜¯iBusã€‚Ubuntu 16.04é»˜è®¤æ˜¯å¸¦æœ‰fcitxçš„ï¼Œæ­£å¸¸å®‰è£…ï¼Œå¦‚æžœæœ‰çš„è¯ï¼ŒæŒ‰ä¸Šé¢æ­¥éª¤å³å¯å®Œæˆï¼›ä½†æœ‰äº›ç‰ˆæœ¬çš„Ubuntuï¼Œéœ€è¦è‡ªå·±å®‰è£… fcitxï¼Œæ‰èƒ½å®‰è£…ä½¿ç”¨sogouã€‚ 1ã€æ·»åŠ ä»¥ä¸‹æº sudo add-apt-repository ppa:fcitx-team/nightly 2ã€æ›´æ–°ç³»ç»Ÿï¼šsudo apt-get update 3ã€å®‰è£…fcitxï¼šsudo apt-get install fcitx 4ã€å®‰è£…fcitxçš„é…ç½®å·¥å…·ï¼šsudo apt-get install fcitx-config-gtk 5ã€å®‰è£…fcitxçš„table-allè½¯ä»¶åŒ…:sudo apt-get install fcitx-table-all 6ã€å®‰è£…im-switchåˆ‡æ¢å·¥å…·ï¼šsudo apt-get install im-switch è‡³æ­¤ï¼Œfcitxé”®ç›˜è¾“å…¥æ³•ç³»ç»Ÿå°±å®‰è£…å¥½äº†ã€‚ç¬¬5ï¼Œ6æ­¥éœ€è¦æŒ‰é”®â€œYâ€ç¡®è®¤å®‰è£…ã€‚ç®€å•æµ‹è¯•çš„æ–¹æ³•å°±æ˜¯åœ¨ç»ˆç«¯é”®å…¥â€œfcitxâ€ï¼Œæœ‰å„ç§æç¤ºå°±å¯¹äº†ã€‚å®‰è£…å®ŒfcitxåŽï¼Œå†å®‰è£…sogouå³å¯ã€‚]]></content>
      <categories>
        <category>Operating-System</category>
      </categories>
      <tags>
        <tag>ubuntu16.04</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexoå¸¸ç”¨æ“ä½œ]]></title>
    <url>%2F2017%2F10%2F30%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
      <categories>
        <category>Tools</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Pythonç¼–ç¨‹ä¹‹assert&raise]]></title>
    <url>%2F2017%2F04%2F03%2FPython%E7%BC%96%E7%A8%8B%E4%B9%8Bassert-raise%2F</url>
    <content type="text"><![CDATA[çœ‹PythonæŸäº›åº“çš„æºç ç»å¸¸ä¼šçœ‹åˆ° assertor raiseè¿™ä¸¤ä¸ªå†…ç½®å‡½æ•°ï¼Œä½†æ˜¯è‡ªå·±å¹³å¸¸å†™ä»£ç å¥½åƒæ²¡æ€Žä¹ˆç”¨è¿‡ï¼Œä½¿ç”¨ try exceptä¼šå¤šä¸€ç‚¹ï¼Œå¯èƒ½æ˜¯è‡ªå·±å¤ªlow ã€‚ã€‚ã€‚ã€‚ è¯­æ³•ä»‹ç» assert assertä¸»è¦çš„ä½œç”¨å°±æ˜¯ç»™ç¨‹åºæ–­è¨€ï¼Œå£°æ˜Žæ¡ä»¶å¿…é¡»ä¸ºçœŸçš„åˆ¤æ–­ï¼Œå¦‚æžœæ¡ä»¶ä¸ºå‡åˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œå¹¶å¯ä»¥ç¼–å†™å¼‚å¸¸æè¿°ã€‚ è¯­æ³•æ ¼å¼12assert è¡¨è¾¾å¼ 'é”™è¯¯æè¿°# å¦‚æžœè¡¨è¾¾å¼ä¸ºçœŸåˆ™ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œå¦‚æžœä¸ºå‡åˆ™æŠ›å‡ºæ–­è¨€å¼‚å¸¸&gt;&gt;AssertionError æ¡ˆä¾‹123foo = [1, 2, 3, 4]# æ–­è¨€fooåˆ—è¡¨çš„é•¿åº¦å¤§äºŽ5assert len(foo) &gt; 5, 'åˆ—è¡¨é•¿åº¦ä¸å¤§äºŽ5' è¾“å‡º 1234Traceback (most recent call last): File "/Users/qiangzai/Desktop/practiceCode/ElementaryClassCode/day01/01-list-questions-answers.py", line 3, in &lt;module&gt; assert len(foo) &gt; 5, 'åˆ—è¡¨é•¿åº¦ä¸å¤§äºŽ5'AssertionError: åˆ—è¡¨é•¿åº¦ä¸å¤§äºŽ5 raise raiseä¹Ÿæ˜¯ç”¨æ¥æŠ›å‡ºå¼‚å¸¸çš„ï¼Œä¸€èˆ¬ç”¨åœ¨è‡ªå·±è§‰å¾—ä¼šæŠ¥é”™çš„ä»£ç å½“ä¸­ä½¿ç”¨ è¯­æ³•æ ¼å¼123raise TypeError('é”™è¯¯æè¿°')# æ³¨æ„è¿™é‡Œçš„TypeErrorä¸æ˜¯å›ºå®šçš„ï¼Œå¯ä»¥æ˜¯ä»»æ„è‡ªå®šä¹‰çš„å†…ç½®é”™è¯¯ç±»åž‹ ValueError,NameError,PermissionErrorç­‰ä¸€å † æ¡ˆä¾‹123456num = 1try: num += '1'except Exception as e: raise TypeError('å­—ç¬¦ä¸²ç±»åž‹ä¸èƒ½å’Œæ•´åž‹ç›¸åŠ ') è¾“å‡º 1TypeError: å­—ç¬¦ä¸²ç±»åž‹ä¸èƒ½å’Œæ•´åž‹ç›¸åŠ ]]></content>
      <categories>
        <category>Python-Advanced</category>
      </categories>
      <tags>
        <tag>assert</tag>
        <tag>raise</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¡ç®—æœºä¹‹UEFIå’ŒLegacy]]></title>
    <url>%2F2017%2F03%2F23%2F%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B9%8BUEFI%E5%92%8CLegacy%2F</url>
    <content type="text"><![CDATA[ä»Šå¤©ä¸»è¦è®²ä¸€ä¸‹UEFI å’ŒLegacyè¿™ä¸¤ç§å¼•å¯¼å¯åŠ¨æ–¹å¼çš„åŒºåˆ« ç”±äºŽç»å¸¸å¸®åŒå­¦è£…ç”µè„‘ç³»ç»Ÿï¼Œçœ‹åˆ°bootæ¨¡å¼è£…UEFI BIOSæ„Ÿè§‰å¾—å¿ƒåº”æ‰‹ï¼Œä½†æ˜¯æœ‰çš„ç”µè„‘ï¼ˆå°¤å…¶æ˜¯w7ç³»ç»Ÿï¼‰è€æ˜¯å‡ºçŽ°ï¼šæ— æ³•å°†Windowså®‰è£…åˆ°ç£ç›˜0çš„åˆ†åŒºè¿™ç§é—®é¢˜ï¼ŒåŽæ¥æ‰æ˜Žç™½æ˜¯ UEFI+GPT å’ŒLegacy+MBRè¿™ä¸¤ç§æ¨¡å¼åŒºåˆ«é€ æˆçš„ è§£å†³åŠžæ³•ï¼šhttps://wenku.baidu.com/view/6b6dfb5ef7ec4afe04a1dfb9.html ä¸¤ç§æ¨¡å¼è¿è¡Œæ–¹å¼ å¯¹æ¯”é‡‡ç”¨ä¼ ç»Ÿçš„BIOSå¼•å¯¼å¯åŠ¨æ–¹å¼ï¼ŒUEFI BIOSå‡å°‘äº†BIOSè‡ªæ£€çš„æ­¥éª¤ï¼ŒèŠ‚çœäº†å¤§é‡çš„æ—¶é—´ã€‚UEFI BIOSæ¯”ä¼ ç»Ÿçš„BIOSå…ˆè¿›å¾—å¾ˆå¤šï¼Œå®ƒçš„æ ‡å‡†å·²ç»åˆ¶å®šäº†å¾ˆå¤šå¹´ï¼Œç›®å‰æ–°å‡ºåŽ‚çš„ç”µè„‘åŸºæœ¬æ¸…ä¸€è‰² UEFI BIOSï¼Œä½†æ˜¯ç”µè„‘ç£ç›˜çš„æ ¼å¼å¿…é¡»æ˜¯GPTæ ¼å¼ï¼Œè¿™å®Œå…¨ä¸åŒäºŽä¼ ç»Ÿçš„MBRæ ¼å¼ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨UEFI BIOSæ ¼å¼ç»™ç”µè„‘ç£ç›˜æ ¼å¼ä¸ºMBRçš„è£…ç³»ç»Ÿæ—¶å€™å°±ä¼šå‡ºçŽ°ä¸Šé¢çš„é—®é¢˜ï¼Œéœ€è¦æŠŠç”µè„‘ç£ç›˜æ ¼å¼ä»ŽMBRâ€”&gt;GPT]]></content>
      <categories>
        <category>Operating-System</category>
      </categories>
      <tags>
        <tag>UEFI</tag>
        <tag>Legacy</tag>
      </tags>
  </entry>
</search>
